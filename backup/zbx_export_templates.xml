<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2022-01-14T04:58:08Z</date>
    <groups>
        <group>
            <name>(Магазины) Весы самообслуживания</name>
        </group>
        <group>
            <name>(Магазины) Кассы</name>
        </group>
        <group>
            <name>(Магазины) Прайсчекеры</name>
        </group>
        <group>
            <name>Templates</name>
        </group>
        <group>
            <name>Templates/Cisco</name>
        </group>
        <group>
            <name>Templates/Mikrotik</name>
        </group>
        <group>
            <name>Templates/Modules</name>
        </group>
        <group>
            <name>Templates/Operating systems</name>
        </group>
        <group>
            <name>Templates/PfSense</name>
        </group>
        <group>
            <name>Templates/SNR Switches</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Cashbox</template>
            <name>Template Cashbox</name>
            <groups>
                <group>
                    <name>(Магазины) Кассы</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Cashbox</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Количество дней, в течении которых документы не отправляются</name>
                    <type>TRAP</type>
                    <key>days_after_last_send_doc</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <description>General information about the number days during which aren't sent documents to OFD</description>
                    <applications>
                        <application>
                            <name>Cashbox</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;=30</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;30</recovery_expression>
                            <name>Чеки на {HOST.IP} не уходят более {ITEM.VALUE1} дней</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Количество дней с момента отправки последнего документа</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Количество дней до конца работы ФН</name>
                    <type>TRAP</type>
                    <key>fn_end_date_count</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <description>Total number of days until the end of the work FN</description>
                    <applications>
                        <application>
                            <name>Cashbox</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;=3</expression>
                            <name>До окончания срока регистрации ФН на {HOST.IP} менее 3 дней</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <description>Количество дней до даты окончания работы ФН</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>До окончания срока регистрации ФН на {HOST.IP} остался 1 день</name>
                                    <expression>{Template Cashbox:fn_end_date_count.last()}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;10</expression>
                            <name>До окончания срока регистрации ФН на {HOST.IP} менее 10 дней</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Количество дней до даты окончания работы ФН</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>До окончания срока регистрации ФН на {HOST.IP} менее 3 дней</name>
                                    <expression>{Template Cashbox:fn_end_date_count.last()}&lt;=3</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;15</expression>
                            <name>До окончания срока регистрации ФН на {HOST.IP} менее 15 дней</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <description>Количество дней до даты окончания работы ФН</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>До окончания срока регистрации ФН на {HOST.IP} менее 10 дней</name>
                                    <expression>{Template Cashbox:fn_end_date_count.last()}&lt;10</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}=1</expression>
                            <name>До окончания срока регистрации ФН на {HOST.IP} остался 1 день</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <description>Количество дней до даты окончания работы ФН</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Закончился срок регистрации ФН на {HOST.IP}</name>
                                    <expression>{Template Cashbox:fn_end_date_count.last()}&lt;0</expression>
                                    <recovery_expression>{Template Cashbox:fn_end_date_count.sum(#4)}&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{sum(#4)}&gt;0</recovery_expression>
                            <name>Закончился срок регистрации ФН на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <description>Количество дней прошедшее после даты окончания работы ФН</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Информация о ККТ</name>
                    <type>TRAP</type>
                    <key>kkt_info</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>General information about of inactive or incorrect KKT</description>
                    <applications>
                        <application>
                            <name>Cashbox</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(Неактивные ККТ!\n)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Неактивные ККТ!\n)}=0 &#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT aren't active on {HOST.HOST}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                                    <recovery_expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{Template Cashbox:kkt_info.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                                    <recovery_expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{Template Cashbox:kkt_info.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                                    <recovery_expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{Template Cashbox:kkt_info.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=1 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=1 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=0 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=0 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                                    <recovery_expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{Template Cashbox:kkt_info.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                                    <recovery_expression>{Template Cashbox:kkt_info.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template Cashbox:kkt_info.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template Cashbox:kkt_info.regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{Template Cashbox:kkt_info.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4][0-9]\d\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Количество ФД</name>
                    <type>TRAP</type>
                    <key>last_fn_doc</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <description>Total documents passed through by the fiscal storage.</description>
                    <applications>
                        <application>
                            <name>Cashbox</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;=215000</expression>
                            <name>Количество ФД более 215000 на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Количество ФД</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество ФД более 220000 на {HOST.IP}</name>
                                    <expression>{Template Cashbox:last_fn_doc.last()}&gt;=220000</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;=220000</expression>
                            <name>Количество ФД более 220000 на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <description>Количество ФД</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество ФД более 230000 на {HOST.IP}</name>
                                    <expression>{Template Cashbox:last_fn_doc.last()}&gt;=230000</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;=230000</expression>
                            <name>Количество ФД более 230000 на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Количество ФД</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество ФД более 240000 на {HOST.IP}</name>
                                    <expression>{Template Cashbox:last_fn_doc.last()}&gt;=240000</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;=240000</expression>
                            <name>Количество ФД более 240000 на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <description>Количество ФД</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество ФД более 250000 на {HOST.IP}</name>
                                    <expression>{Template Cashbox:last_fn_doc.last()}&gt;=250000</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;=250000</expression>
                            <name>Количество ФД более 250000 на {HOST.IP}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <description>Количество ФД</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Cashbox</tag>
                                </tag>
                                <tag>
                                    <tag>Fiscal storage</tag>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Количество дней до окончания работы ОФД</name>
                    <type>TRAP</type>
                    <key>number_of_days_to_contract_end</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>Total days until end of work OFD</description>
                    <applications>
                        <application>
                            <name>Cashbox</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
        <template>
            <template>Template Gateway HAP</template>
            <name>Template Gateway HAP</name>
            <description>Template for Mikrotik HAP (gateway in stores, borovskaya)</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template SNMP Mikrotik HAP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template Gateway HEX</template>
            <name>Template Gateway HEX</name>
            <description>Template for Mikrotik HEX (gateway in stores)</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template SNMP Mikrotik HEX</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template Linux Container</template>
            <name>Template Linux Container</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Filesystems</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network interfaces</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>Performance</name>
                </application>
                <application>
                    <name>Processes</name>
                </application>
                <application>
                    <name>Security</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Processor load (1 min average per core)</name>
                    <key>ct.cpu.load[percpu,avg1]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;20</expression>
                            <name>Processor load is too high on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor load (5 min average per core)</name>
                    <key>ct.cpu.load[percpu,avg5]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Processor load (15 min average per core)</name>
                    <key>ct.cpu.load[percpu,avg15]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Number of CPUs</name>
                    <key>ct.cpu.num</key>
                    <history>7d</history>
                    <description>Number of CPU on CT</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Available memory</name>
                    <key>ct.memory.size[available]</key>
                    <history>1w</history>
                    <units>B</units>
                    <description>Available memory is defined as free+cached+buffers memory.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;20M</expression>
                            <name>Lack of available memory on server {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Buffered memory</name>
                    <key>ct.memory.size[buffers]</key>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Cached memory</name>
                    <key>ct.memory.size[cached]</key>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memory utilization</name>
                    <key>ct.memory.size[pavailable]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Memory used percentage is calculated as (100-(pavailable*100/total))</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total memory</name>
                    <key>ct.memory.size[total]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used memory</name>
                    <key>ct.memory.size[used]</key>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free swap space</name>
                    <key>ct.swap.size[free]</key>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used swap space in %</name>
                    <key>ct.swap.size[pused]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&gt;50</expression>
                            <name>Lack of free swap space on {HOST.NAME}</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>It probably means that the systems requires more physical memory.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total swap space</name>
                    <key>ct.swap.size[total]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used swap space</name>
                    <key>ct.swap.size[used]</key>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System uptime (Guest)</name>
                    <key>ct.uptime</key>
                    <delay>10m</delay>
                    <history>1w</history>
                    <units>uptime</units>
                    <description>Container uptime</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Maximum number of opened files</name>
                    <key>kernel.maxfiles</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;1024</expression>
                            <name>Configured max number of opened files is too low on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Maximum number of processes</name>
                    <key>kernel.maxproc</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;256</expression>
                            <name>Configured max number of processes is too low on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of running processes</name>
                    <key>proc.num[,,run]</key>
                    <history>1w</history>
                    <description>Number of processes in running state.</description>
                    <applications>
                        <application>
                            <name>Processes</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;100</expression>
                            <name>Too many processes running on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of processes</name>
                    <key>proc.num[]</key>
                    <history>1w</history>
                    <description>Total number of processes in any state.</description>
                    <applications>
                        <application>
                            <name>Processes</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;1000</expression>
                            <name>Too many processes on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host boot time</name>
                    <key>system.boottime</key>
                    <delay>10m</delay>
                    <history>1w</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Interrupts per second</name>
                    <key>system.cpu.intr</key>
                    <history>1w</history>
                    <units>ips</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Context switches per second</name>
                    <key>system.cpu.switches</key>
                    <history>1w</history>
                    <units>sps</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,idle]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent doing nothing.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,interrupt]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of time the CPU has been servicing hardware interrupts.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,iowait]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Amount of time the CPU has been waiting for I/O to complete.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;75</expression>
                            <name>Disk I/O is overloaded on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <description>OS spends significant time waiting for I/O (input/output) operations. It could be indicator of performance issues with storage system.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,nice]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that have been niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,softirq]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of time the CPU has been servicing software interrupts.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,steal]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of CPU 'stolen' from this virtual machine by the hypervisor for other tasks (such as running another virtual machine).</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,system]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running the kernel and its processes.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <key>system.cpu.util[,user]</key>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that are not niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Host name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>System host name.</description>
                    <inventory_link>NAME</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Hostname was changed on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host local time</name>
                    <key>system.localtime</key>
                    <history>1w</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System information</name>
                    <key>system.uname</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>The information as normally returned by 'uname -a'.</description>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Host information was changed on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System uptime (Host)</name>
                    <key>system.uptime</key>
                    <delay>10m</delay>
                    <history>1w</history>
                    <units>uptime</units>
                    <description>Host system uptime</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{change(0)}&lt;0</expression>
                            <name>{HOST.NAME} has just been restarted</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of logged in users</name>
                    <key>system.users.num</key>
                    <history>1w</history>
                    <description>Number of users who are currently logged in.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                        <application>
                            <name>Security</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Checksum of $1</name>
                    <key>vfs.file.cksum[/etc/passwd]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>Security</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>/etc/passwd has been changed on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interface discovery</name>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>@Network</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of network interfaces as defined in global regular expression &quot;Network interfaces for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Incoming network traffic on $1</name>
                            <key>net.if.in[{#IFNAME}]</key>
                            <history>1w</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing network traffic on $1</name>
                            <key>net.if.out[{#IFNAME}]</key>
                            <history>1w</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Network traffic on {#IFNAME}</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>00AA00</color>
                                    <item>
                                        <host>Template Linux Container</host>
                                        <key>net.if.in[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>3333FF</color>
                                    <item>
                                        <host>Template Linux Container</host>
                                        <key>net.if.out[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Mounted filesystem discovery</name>
                    <key>vfs.fs.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>@File system</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of file systems of different types as defined in global regular expression &quot;File systems for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Free inodes on $1 (percentage)</name>
                            <key>vfs.fs.inode[{#FSNAME},pfree]</key>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(0)}&lt;20</expression>
                                    <name>Free inodes is less than 20% on volume {#FSNAME}</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Free disk space on $1</name>
                            <key>vfs.fs.size[{#FSNAME},free]</key>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free disk space on $1 (percentage)</name>
                            <key>vfs.fs.size[{#FSNAME},pfree]</key>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(0)}&lt;20</expression>
                                    <name>Free disk space is less than 20% on volume {#FSNAME}</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Total disk space on $1</name>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <delay>1h</delay>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Used disk space on $1</name>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Disk space usage {#FSNAME}</name>
                            <width>600</width>
                            <height>340</height>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>C80000</color>
                                    <type>GRAPH_SUM</type>
                                    <item>
                                        <host>Template Linux Container</host>
                                        <key>vfs.fs.size[{#FSNAME},total]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00C800</color>
                                    <item>
                                        <host>Template Linux Container</host>
                                        <key>vfs.fs.size[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$LOAD_AVG_PER_CPU.MAX.WARN}</macro>
                    <value>1.5</value>
                    <description>Load per CPU considered sustainable. Tune if needed.</description>
                </macro>
                <macro>
                    <macro>{$MEMORY.AVAILABLE.MIN}</macro>
                    <value>20</value>
                    <description>This macro is used as a threshold in memory available trigger.</description>
                </macro>
                <macro>
                    <macro>{$SWAP.PFREE.MIN.WARN}</macro>
                    <value>50</value>
                    <description>-</description>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>System performance</name>
                    <hsize>2</hsize>
                    <vsize>3</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>CPU utilization</name>
                                <host>Template Linux Container</host>
                            </resource>
                            <width>500</width>
                            <height>148</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Memory usage</name>
                                <host>Template Linux Container</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Swap usage</name>
                                <host>Template Linux Container</host>
                            </resource>
                            <width>500</width>
                            <height>300</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>1</resourcetype>
                            <style>0</style>
                            <resource>
                                <key>proc.num[]</key>
                                <host>Template Linux Container</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>1</resourcetype>
                            <style>0</style>
                            <resource>
                                <key>proc.num[,,run]</key>
                                <host>Template Linux Container</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template Module Cisco CISCO-ENVMON-MIB SNMP</template>
            <name>Template Module Cisco CISCO-ENVMON-MIB SNMP</name>
            <description>Template Cisco CISCO-ENVMON-MIB&#13;
&#13;
MIBs used:&#13;
CISCO-ENVMON-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Fans</name>
                </application>
                <application>
                    <name>Power supply</name>
                </application>
                <application>
                    <name>Temperature</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>FAN Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SENSOR_INFO},1.3.6.1.4.1.9.9.13.1.4.1.2]</snmp_oid>
                    <key>fan.discovery</key>
                    <delay>1h</delay>
                    <description>The table of fan status maintained by the environmental monitor.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SENSOR_INFO}: Fan status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.13.1.4.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>sensor.fan.status[ciscoEnvMonFanState.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>2w</history>
                            <trends>0d</trends>
                            <description>MIB: CISCO-ENVMON-MIB</description>
                            <applications>
                                <application>
                                    <name>Fans</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>CISCO-ENVMON-MIB::CiscoEnvMonState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{count(#1,{$FAN_CRIT_STATUS:&quot;critical&quot;},eq)}=1 or {count(#1,{$FAN_CRIT_STATUS:&quot;shutdown&quot;},eq)}=1</expression>
                                    <name>{#SENSOR_INFO}: Fan is in critical state</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>Please check the fan unit</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{count(#1,{$FAN_WARN_STATUS:&quot;warning&quot;},eq)}=1 or {count(#1,{$FAN_WARN_STATUS:&quot;notFunctioning&quot;},eq)}=1</expression>
                                    <name>{#SENSOR_INFO}: Fan is in warning state</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Please check the fan unit</description>
                                    <dependencies>
                                        <dependency>
                                            <name>{#SENSOR_INFO}: Fan is in critical state</name>
                                            <expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.fan.status[ciscoEnvMonFanState.{#SNMPINDEX}].count(#1,{$FAN_CRIT_STATUS:&quot;critical&quot;},eq)}=1 or {Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.fan.status[ciscoEnvMonFanState.{#SNMPINDEX}].count(#1,{$FAN_CRIT_STATUS:&quot;shutdown&quot;},eq)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>PSU Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SENSOR_INFO},1.3.6.1.4.1.9.9.13.1.5.1.2]</snmp_oid>
                    <key>psu.discovery</key>
                    <delay>1h</delay>
                    <description>The table of power supply status maintained by the environmental monitor card.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SENSOR_INFO}: Power supply status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.13.1.5.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>sensor.psu.status[ciscoEnvMonSupplyState.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>2w</history>
                            <trends>0d</trends>
                            <description>MIB: CISCO-ENVMON-MIB</description>
                            <applications>
                                <application>
                                    <name>Power supply</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>CISCO-ENVMON-MIB::CiscoEnvMonState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{count(#1,{$PSU_CRIT_STATUS:&quot;critical&quot;},eq)}=1 or {count(#1,{$PSU_CRIT_STATUS:&quot;shutdown&quot;},eq)}=1</expression>
                                    <name>{#SENSOR_INFO}: Power supply is in critical state</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>Please check the power supply unit for errors</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{count(#1,{$PSU_WARN_STATUS:&quot;warning&quot;},eq)}=1 or {count(#1,{$PSU_WARN_STATUS:&quot;notFunctioning&quot;},eq)}=1</expression>
                                    <name>{#SENSOR_INFO}: Power supply is in warning state</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Please check the power supply unit for errors</description>
                                    <dependencies>
                                        <dependency>
                                            <name>{#SENSOR_INFO}: Power supply is in critical state</name>
                                            <expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.psu.status[ciscoEnvMonSupplyState.{#SNMPINDEX}].count(#1,{$PSU_CRIT_STATUS:&quot;critical&quot;},eq)}=1 or {Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.psu.status[ciscoEnvMonSupplyState.{#SNMPINDEX}].count(#1,{$PSU_CRIT_STATUS:&quot;shutdown&quot;},eq)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Temperature Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.13.1.3.1.2]</snmp_oid>
                    <key>temperature.discovery</key>
                    <delay>1h</delay>
                    <description>Discovery of ciscoEnvMonTemperatureTable (ciscoEnvMonTemperatureDescr), a table of ambient temperature status&#13;
maintained by the environmental monitor.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SNMPVALUE}: Temperature status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.13.1.3.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>2w</history>
                            <trends>0d</trends>
                            <description>MIB: CISCO-ENVMON-MIB&#13;
The current state of the test point being instrumented.</description>
                            <applications>
                                <application>
                                    <name>Temperature</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>CISCO-ENVMON-MIB::CiscoEnvMonState</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>{#SNMPVALUE}: Temperature</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.13.1.3.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <value_type>FLOAT</value_type>
                            <units>°C</units>
                            <description>MIB: CISCO-ENVMON-MIB&#13;
The current measurement of the test point being instrumented.</description>
                            <applications>
                                <application>
                                    <name>Temperature</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(5m)}&lt;{$TEMP_CRIT_LOW:&quot;{#SNMPVALUE}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min(5m)}&gt;{$TEMP_CRIT_LOW:&quot;{#SNMPVALUE}&quot;}+3</recovery_expression>
                                    <name>{#SNMPVALUE}: Temperature is too low: &lt;{$TEMP_CRIT_LOW:&quot;{#SNMPVALUE}&quot;}</name>
                                    <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].avg(5m)}&gt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}&#13;
or&#13;
{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}].last()}={$TEMP_CRIT_STATUS}&#13;
or&#13;
{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}].last()}={$TEMP_DISASTER_STATUS}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].max(5m)}&lt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}-3</recovery_expression>
                            <name>{#SNMPVALUE}: Temperature is above critical threshold: &gt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <description>This trigger uses temperature sensor values as well as temperature sensor status if available</description>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].avg(5m)}&gt;{$TEMP_WARN:&quot;{#SNMPVALUE}&quot;}&#13;
or&#13;
{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}].last()}={$TEMP_WARN_STATUS}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].max(5m)}&lt;{$TEMP_WARN:&quot;{#SNMPVALUE}&quot;}-3</recovery_expression>
                            <name>{#SNMPVALUE}: Temperature is above warning threshold: &gt;{$TEMP_WARN:&quot;{#SNMPVALUE}&quot;}</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>This trigger uses temperature sensor values as well as temperature sensor status if available</description>
                            <dependencies>
                                <dependency>
                                    <name>{#SNMPVALUE}: Temperature is above critical threshold: &gt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}</name>
                                    <expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].avg(5m)}&gt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}&#13;
or&#13;
{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}].last()}={$TEMP_CRIT_STATUS}&#13;
or&#13;
{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.status[ciscoEnvMonTemperatureState.{#SNMPINDEX}].last()}={$TEMP_DISASTER_STATUS}</expression>
                                    <recovery_expression>{Template Module Cisco CISCO-ENVMON-MIB SNMP:sensor.temp.value[ciscoEnvMonTemperatureValue.{#SNMPINDEX}].max(5m)}&lt;{$TEMP_CRIT:&quot;{#SNMPVALUE}&quot;}-3</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$FAN_CRIT_STATUS:&quot;critical&quot;}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$FAN_CRIT_STATUS:&quot;shutdown&quot;}</macro>
                    <value>4</value>
                </macro>
                <macro>
                    <macro>{$FAN_WARN_STATUS:&quot;notFunctioning&quot;}</macro>
                    <value>6</value>
                </macro>
                <macro>
                    <macro>{$FAN_WARN_STATUS:&quot;warning&quot;}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$PSU_CRIT_STATUS:&quot;critical&quot;}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$PSU_CRIT_STATUS:&quot;shutdown&quot;}</macro>
                    <value>4</value>
                </macro>
                <macro>
                    <macro>{$PSU_WARN_STATUS:&quot;notFunctioning&quot;}</macro>
                    <value>6</value>
                </macro>
                <macro>
                    <macro>{$PSU_WARN_STATUS:&quot;warning&quot;}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$TEMP_CRIT}</macro>
                    <value>60</value>
                </macro>
                <macro>
                    <macro>{$TEMP_CRIT:&quot;CPU&quot;}</macro>
                    <value>75</value>
                </macro>
                <macro>
                    <macro>{$TEMP_CRIT_LOW}</macro>
                    <value>5</value>
                </macro>
                <macro>
                    <macro>{$TEMP_CRIT_STATUS}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$TEMP_DISASTER_STATUS}</macro>
                    <value>4</value>
                </macro>
                <macro>
                    <macro>{$TEMP_WARN}</macro>
                    <value>50</value>
                </macro>
                <macro>
                    <macro>{$TEMP_WARN:&quot;CPU&quot;}</macro>
                    <value>70</value>
                </macro>
                <macro>
                    <macro>{$TEMP_WARN_STATUS}</macro>
                    <value>2</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</template>
            <name>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</name>
            <description>Template Cisco CISCO-MEMORY-POOL-MIB&#13;
&#13;
MIBs used:&#13;
CISCO-MEMORY-POOL-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Memory</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Memory Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.48.1.1.1.2]</snmp_oid>
                    <key>memory.discovery</key>
                    <delay>1h</delay>
                    <description>Discovery of ciscoMemoryPoolTable, a table of memory pool monitoring entries.&#13;
http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15216-contiguous-memory.html</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SNMPVALUE}: Free memory</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.48.1.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>vm.memory.free[ciscoMemoryPoolFree.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>MIB: CISCO-MEMORY-POOL-MIB&#13;
Indicates the number of bytes from the memory pool that are currently unused on the managed device. Note that the sum of ciscoMemoryPoolUsed and ciscoMemoryPoolFree is the total amount of memory in the pool&#13;
Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15216-contiguous-memory.html</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>{#SNMPVALUE}: Used memory</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.48.1.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>vm.memory.used[ciscoMemoryPoolUsed.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>MIB: CISCO-MEMORY-POOL-MIB&#13;
Indicates the number of bytes from the memory pool that are currently in use by applications on the managed device.&#13;
Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15216-contiguous-memory.html</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>{#SNMPVALUE}: Memory utilization</name>
                            <type>CALCULATED</type>
                            <key>vm.memory.util[vm.memory.util.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <params>last(&quot;vm.memory.used[ciscoMemoryPoolUsed.{#SNMPINDEX}]&quot;)/(last(&quot;vm.memory.free[ciscoMemoryPoolFree.{#SNMPINDEX}]&quot;)+last(&quot;vm.memory.used[ciscoMemoryPoolUsed.{#SNMPINDEX}]&quot;))*100</params>
                            <description>Memory utilization in %</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5m)}&gt;{$MEMORY.UTIL.MAX}</expression>
                                    <name>{#SNMPVALUE}: High memory utilization (&gt;{$MEMORY.UTIL.MAX}% for 5m)</name>
                                    <priority>AVERAGE</priority>
                                    <description>The system is running out of free memory.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{#SNMPVALUE}: Memory utilization</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <ymax_type_1>FIXED</ymax_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</host>
                                        <key>vm.memory.util[vm.memory.util.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$MEMORY.UTIL.MAX}</macro>
                    <value>90</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Cisco CISCO-PROCESS-MIB IOS versions 12.0_3_T-12.2_3.5 SNMP</template>
            <name>Template Module Cisco CISCO-PROCESS-MIB IOS versions 12.0_3_T-12.2_3.5 SNMP</name>
            <description>Template Module Cisco CISCO-PROCESS-MIB IOS versions 12.0_3_T-12.2_3.5&#13;
&#13;
MIBs used:&#13;
CISCO-PROCESS-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>CPU Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.109.1.1.1.1.5]</snmp_oid>
                    <key>cpu.discovery</key>
                    <delay>1h</delay>
                    <description>If your IOS device has several CPUs, you must use CISCO-PROCESS-MIB and its object cpmCPUTotal5minRev from the table called cpmCPUTotalTable ,&#13;
indexed with cpmCPUTotalIndex .&#13;
This table allows CISCO-PROCESS-MIB to keep CPU statistics for different physical entities in the router,&#13;
like different CPU chips, group of CPUs, or CPUs in different modules/cards.&#13;
In case of a single CPU, cpmCPUTotalTable has only one entry.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SNMPVALUE}: CPU utilization</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.109.1.1.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>system.cpu.util[cpmCPUTotal5min.{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>MIB: CISCO-PROCESS-MIB&#13;
The overall CPU busy percentage in the last 5 minute&#13;
period. This object deprecates the avgBusy5 object from&#13;
the OLD-CISCO-SYSTEM-MIB. This object is deprecated&#13;
by cpmCPUTotal5minRev which has the changed range&#13;
of value (0..100)&#13;
Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15215-collect-cpu-util-snmp.html</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5m)}&gt;{$CPU.UTIL.CRIT}</expression>
                                    <name>{#SNMPVALUE}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)</name>
                                    <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>CPU utilization is too high. The system might be slow to respond.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{#SNMPVALUE}: CPU utilization</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <ymax_type_1>FIXED</ymax_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Cisco CISCO-PROCESS-MIB IOS versions 12.0_3_T-12.2_3.5 SNMP</host>
                                        <key>system.cpu.util[cpmCPUTotal5min.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>90</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Cisco CISCO-PROCESS-MIB SNMP</template>
            <name>Template Module Cisco CISCO-PROCESS-MIB SNMP</name>
            <description>Template Cisco CISCO-PROCESS-MIB&#13;
&#13;
MIBs used:&#13;
CISCO-PROCESS-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>CPU Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.109.1.1.1.1.5]</snmp_oid>
                    <key>cpu.discovery</key>
                    <delay>1h</delay>
                    <description>If your IOS device has several CPUs, you must use CISCO-PROCESS-MIB and its object cpmCPUTotal5minRev from the table called cpmCPUTotalTable ,&#13;
indexed with cpmCPUTotalIndex .&#13;
This table allows CISCO-PROCESS-MIB to keep CPU statistics for different physical entities in the router,&#13;
like different CPU chips, group of CPUs, or CPUs in different modules/cards.&#13;
In case of a single CPU, cpmCPUTotalTable has only one entry.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>#{#SNMPINDEX}: CPU utilization</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.109.1.1.1.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>system.cpu.util[cpmCPUTotal5minRev.{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>MIB: CISCO-PROCESS-MIB&#13;
The cpmCPUTotal5minRev MIB object provides a more accurate view of the performance of the router over time than the MIB objects cpmCPUTotal1minRev and cpmCPUTotal5secRev . These MIB objects are not accurate because they look at CPU at one minute and five second intervals, respectively. These MIBs enable you to monitor the trends and plan the capacity of your network. The recommended baseline rising threshold for cpmCPUTotal5minRev is 90 percent. Depending on the platform, some routers that run at 90 percent, for example, 2500s, can exhibit performance degradation versus a high-end router, for example, the 7500 series, which can operate fine.&#13;
Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15215-collect-cpu-util-snmp.html</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5m)}&gt;{$CPU.UTIL.CRIT}</expression>
                                    <name>#{#SNMPINDEX}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)</name>
                                    <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>CPU utilization is too high. The system might be slow to respond.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>#{#SNMPINDEX}: CPU utilization</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <ymax_type_1>FIXED</ymax_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Cisco CISCO-PROCESS-MIB SNMP</host>
                                        <key>system.cpu.util[cpmCPUTotal5minRev.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>90</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Cisco Inventory SNMP</template>
            <name>Template Module Cisco Inventory SNMP</name>
            <description>Template Cisco Inventory&#13;
&#13;
MIBs used:&#13;
ENTITY-MIB&#13;
SNMPv2-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Inventory</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Hardware model name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.13.1</snmp_oid>
                    <key>system.hw.model</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: ENTITY-MIB</description>
                    <inventory_link>MODEL</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Hardware serial number</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.11.1</snmp_oid>
                    <key>system.hw.serialnumber</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: ENTITY-MIB</description>
                    <inventory_link>SERIALNO_A</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>Device has been replaced (new serial number received)</name>
                            <priority>INFO</priority>
                            <description>Device serial number has changed. Ack to close</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Operating system</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.1.0</snmp_oid>
                    <key>system.sw.os[sysDescr.0]</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB</description>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <params>Version (.+), RELEASE
\1</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>Operating system description has changed</name>
                            <priority>INFO</priority>
                            <description>Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Entity Serial Numbers Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#ENT_CLASS},1.3.6.1.2.1.47.1.1.1.1.5,{#ENT_NAME},1.3.6.1.2.1.47.1.1.1.1.7,{#ENT_SN},1.3.6.1.2.1.47.1.1.1.1.11]</snmp_oid>
                    <key>entity_sn.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#ENT_SN}</macro>
                                <value>.+</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#ENT_CLASS}</macro>
                                <value>[^3]</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#ENT_NAME}: Hardware serial number</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.11.{#SNMPINDEX}</snmp_oid>
                            <key>system.hw.serialnumber[entPhysicalSerialNum.{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>2w</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>MIB: ENTITY-MIB</description>
                            <applications>
                                <application>
                                    <name>Inventory</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1d</params>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                                    <name>{#ENT_NAME}: Device has been replaced (new serial number received)</name>
                                    <priority>INFO</priority>
                                    <description>Device serial number has changed. Ack to close</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template Module Cisco OLD-CISCO-CPU-MIB SNMP</template>
            <name>Template Module Cisco OLD-CISCO-CPU-MIB SNMP</name>
            <description>Template Cisco OLD-CISCO-CPU-MIB&#13;
&#13;
MIBs used:&#13;
OLD-CISCO-CPU-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>CPU utilization</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.9.2.1.58</snmp_oid>
                    <key>system.cpu.util[avgBusy5]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>MIB: OLD-CISCO-CPU-MIB&#13;
5 minute exponentially-decayed moving average of the CPU busy percentage.&#13;
Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15215-collect-cpu-util-snmp.html</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$CPU.UTIL.CRIT}</expression>
                            <name>High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)</name>
                            <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>CPU utilization is too high. The system might be slow to respond.</description>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>90</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module EtherLike-MIB SNMP</template>
            <name>Template Module EtherLike-MIB SNMP</name>
            <description>Template EtherLike-MIB (duplex control only)&#13;
&#13;
MIBs used:&#13;
EtherLike-MIB&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Network interfaces</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>EtherLike-MIB Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.10.7.2.1.19,{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2]</snmp_oid>
                    <key>net.if.duplex.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(2|3)</value>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with up(1) Operational Status are discovered.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Duplex status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <description>MIB: EtherLike-MIB&#13;
The current mode of operation of the MAC&#13;
entity.  'unknown' indicates that the current&#13;
duplex mode could not be determined.&#13;
&#13;
Management control of the duplex mode is&#13;
accomplished through the MAU MIB.  When&#13;
an interface does not support autonegotiation,&#13;
or when autonegotiation is not enabled, the&#13;
duplex mode is controlled using&#13;
ifMauDefaultType.  When autonegotiation is&#13;
supported and enabled, duplex mode is controlled&#13;
using ifMauAutoNegAdvertisedBits.  In either&#13;
case, the currently operating duplex mode is&#13;
reflected both in this object and in ifMauType.&#13;
&#13;
Note that this object provides redundant&#13;
information with ifMauType.  Normally, redundant&#13;
objects are discouraged.  However, in this&#13;
instance, it allows a management application to&#13;
determine the duplex status of an interface&#13;
without having to know every possible value of&#13;
ifMauType.  This was felt to be sufficiently&#13;
valuable to justify the redundancy.&#13;
Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>EtherLike-MIB::dot3StatsDuplexStatus</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=2</expression>
                                    <name>Interface {#IFNAME}({#IFALIAS}): In half-duplex mode</name>
                                    <priority>WARNING</priority>
                                    <description>Please check autonegotiation settings and cabling</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>try {
    var data = JSON.parse(value);
}
catch (error) {
    throw 'Failed to parse JSON of EtherLike-MIB discovery.';
}
var fields = ['{#SNMPVALUE}','{#IFOPERSTATUS}','{#IFALIAS}','{#IFNAME}','{#IFDESCR}'];
data.forEach(function (element) {
    fields.forEach(function (field) {
        element[field] = element[field] || '';
    });
});
return JSON.stringify(data);</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template Module Generic SNMP</template>
            <name>Template Module Generic SNMP</name>
            <description>Template Module Generic&#13;
&#13;
MIBs used:&#13;
SNMPv2-MIB&#13;
&#13;
Template tooling version used: 0.36</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Status</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>SNMP traps (fallback)</name>
                    <type>SNMP_TRAP</type>
                    <key>snmptrap.fallback</key>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>Item is used to collect all SNMP traps unmatched by other snmptrap items</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <logtimefmt>hh:mm:sszyyyy/MM/dd</logtimefmt>
                </item>
                <item>
                    <name>System contact details</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.4.0</snmp_oid>
                    <key>system.contact[sysContact.0]</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.</description>
                    <inventory_link>CONTACT</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System description</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.1.0</snmp_oid>
                    <key>system.descr[sysDescr.0]</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
A textual description of the entity. This value should&#13;
include the full name and version identification of the system's hardware type, software operating-system, and&#13;
networking software.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System location</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.6.0</snmp_oid>
                    <key>system.location[sysLocation.0]</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.</description>
                    <inventory_link>LOCATION</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>system.name</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.</description>
                    <inventory_link>NAME</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>System name has changed (new name: {ITEM.VALUE})</name>
                            <priority>INFO</priority>
                            <description>System name has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template Module Generic SNMP:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System object ID</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.2.0</snmp_oid>
                    <key>system.objectid[sysObjectID.0]</key>
                    <delay>15m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>system.uptime[sysUpTime.0]</key>
                    <delay>30s</delay>
                    <history>2w</history>
                    <trends>0d</trends>
                    <units>uptime</units>
                    <description>MIB: SNMPv2-MIB&#13;
The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
                            <priority>WARNING</priority>
                            <description>Uptime is less than 10 minutes</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>No SNMP data collection</name>
                                    <expression>{Template Module Generic SNMP:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template Module Generic SNMP:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max({$SNMP.TIMEOUT})}=0</expression>
                            <name>No SNMP data collection</name>
                            <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>SNMP is not available for polling. Please check device connectivity and SNMP settings.</description>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template Module Generic SNMP:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$SNMP.TIMEOUT}</macro>
                    <value>5m</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module ICMP Ping</template>
            <name>Template Module ICMP Ping</name>
            <description>Template Module ICMP Ping&#13;
&#13;
Template tooling version used: 0.34&#13;
ICMP checks for non-shop nodes</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>ICMP</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>ICMP packet loss</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP resopnse time</name>
                    <type>SIMPLE</type>
                    <key>icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Возвращает среднее за 3 попытки время отклика в миллисекундах</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0.1&#13;
and&#13;
{avg(300s)}&gt;0.1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;0.1&#13;
and&#13;
{avg(60s)}&lt;=0.1</recovery_expression>
                            <name>PIng 100 ms+</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>PIng 150 ms+</name>
                                    <expression>{Template Module ICMP Ping:icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}].last()}&gt;0.151&#13;
and&#13;
{Template Module ICMP Ping:icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}].avg(300s)}&gt;0.151</expression>
                                    <recovery_expression>({Template Module ICMP Ping:icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}].last()}&gt;0.151 or&#13;
{Template Module ICMP Ping:icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}].last()}&lt;=0.151 &#13;
)&#13;
and&#13;
{Template Module ICMP Ping:icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}].avg(60)}&lt;0.151</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;0.151&#13;
and&#13;
{avg(300s)}&gt;0.151</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({last()}&gt;0.151 or&#13;
{last()}&lt;=0.151 &#13;
)&#13;
and&#13;
{avg(60)}&lt;0.151</recovery_expression>
                            <name>PIng 150 ms+</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Node status</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}]</key>
                    <delay>120s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <description>Возвращает 0 или 1 в зависимости от доступности хоста.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{sum({$ICMP.UNAVAILABLE2})}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Unavailable ({$ICMP.UNAVAILABLE2}+)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE3}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].sum({$ICMP.UNAVAILABLE3})}=0</expression>
                                    <recovery_expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum({$ICMP.UNAVAILABLE3})}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Unavailable ({$ICMP.UNAVAILABLE3}+)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE4}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].sum({$ICMP.UNAVAILABLE4})}=0</expression>
                                    <recovery_expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].min(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum({$ICMP.UNAVAILABLE4})}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#2)}&lt;&gt;0</recovery_expression>
                            <name>Unavailable ({$ICMP.UNAVAILABLE4}+)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE5}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].sum({$ICMP.UNAVAILABLE5})}=0</expression>
                                    <recovery_expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].min(#1)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum({$ICMP.UNAVAILABLE5})}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#1)}&lt;&gt;0</recovery_expression>
                            <name>Unavailable ({$ICMP.UNAVAILABLE5}+)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{max({$ICMP.UNAVAILABLE})}=0</expression>
                            <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE2}+)</name>
                                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].sum({$ICMP.UNAVAILABLE2})}=0</expression>
                                    <recovery_expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP average response time</name>
                    <type>CALCULATED</type>
                    <key>ping_avg</key>
                    <delay>0;wd1-5h0-23m/3;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <params>avg(&quot;icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}]&quot;, 1800s)</params>
                    <description>Возвращает среднее значение времени ответа в течении последних 30 минут.&#13;
&#13;
ICMP avarage response time during last 30 mim</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP average packet loss</name>
                    <type>CALCULATED</type>
                    <key>ping_loss_avg</key>
                    <delay>0;wd1-5h0-23m/2;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(&quot;icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}]&quot;, 1800s)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$ICMP.PACKET.COUNT}</macro>
                    <value>5</value>
                </macro>
                <macro>
                    <macro>{$ICMP.PACKET.COUNT2}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$ICMP.PACKET.SIZE}</macro>
                    <value>1000</value>
                </macro>
                <macro>
                    <macro>{$ICMP.UNAVAILABLE}</macro>
                    <value>120s</value>
                    <description>Unavailable 2 minutes in secs</description>
                </macro>
                <macro>
                    <macro>{$ICMP.UNAVAILABLE2}</macro>
                    <value>600s</value>
                    <description>Unavailable 10 minutes in secs</description>
                </macro>
                <macro>
                    <macro>{$ICMP.UNAVAILABLE3}</macro>
                    <value>1800s</value>
                    <description>Unavailable 30 minutes in secs</description>
                </macro>
                <macro>
                    <macro>{$ICMP.UNAVAILABLE4}</macro>
                    <value>7200s</value>
                    <description>Unavailable 120 minutes in secs</description>
                </macro>
                <macro>
                    <macro>{$ICMP.UNAVAILABLE5}</macro>
                    <value>18000s</value>
                    <description>Unavailable 300 minutes in secs</description>
                </macro>
                <macro>
                    <macro>{$ICMP_LOSS_WARN}</macro>
                    <value>25</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>ICMP</name>
                    <hsize>2</hsize>
                    <vsize>3</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>1</resourcetype>
                            <style>0</style>
                            <resource>
                                <key>icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}]</key>
                                <host>Template Module ICMP Ping</host>
                            </resource>
                            <width>700</width>
                            <height>150</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>7</resourcetype>
                            <style>1</style>
                            <resource>0</resource>
                            <width>150</width>
                            <height>200</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Packet loss % [all]</name>
                                <host>Template Module ICMP Ping</host>
                            </resource>
                            <width>700</width>
                            <height>150</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Packet loss % [avg]</name>
                                <host>Template Module ICMP Ping</host>
                            </resource>
                            <width>700</width>
                            <height>150</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Response time (ms) [all]</name>
                                <host>Template Module ICMP Ping</host>
                            </resource>
                            <width>700</width>
                            <height>150</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Response time (ms) [avg]</name>
                                <host>Template Module ICMP Ping</host>
                            </resource>
                            <width>700</width>
                            <height>150</height>
                            <x>1</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template Module Interfaces SNMP</template>
            <name>Template Module Interfaces SNMP</name>
            <description>Template Module Interfaces&#13;
&#13;
MIBs used:&#13;
IF-MIB&#13;
&#13;
Template tooling version used: 0.36</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Network interfaces</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interfaces discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFADMINSTATUS}</macro>
                                <value>{$NET.IF.IFADMINSTATUS.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFADMINSTATUS}</macro>
                                <value>{$NET.IF.IFADMINSTATUS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>{$NET.IF.IFOPERSTATUS.MATCHES}</value>
                                <formulaid>I</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>{$NET.IF.IFOPERSTATUS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>J</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.MATCHES}</value>
                                <formulaid>G</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>H</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.MATCHES}</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>F</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFTYPE}</macro>
                                <value>{$NET.IF.IFTYPE.MATCHES}</value>
                                <formulaid>K</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFTYPE}</macro>
                                <value>{$NET.IF.IFTYPE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>L</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovering interfaces from IF-MIB.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.in.discards[ifInDiscards.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>MIB: IF-MIB&#13;
The number of inbound packets which were chosen to be discarded&#13;
even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.&#13;
One possible reason for discarding such a packet could be to free up buffer space.&#13;
Discontinuities in the value of this counter can occur at re-initialization of the management system,&#13;
and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.in.errors[ifInErrors.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>MIB: IF-MIB&#13;
For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Bits received</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <description>MIB: IF-MIB&#13;
The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>MIB: IF-MIB&#13;
The number of outbound packets which were chosen to be discarded&#13;
even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.&#13;
One possible reason for discarding such a packet could be to free up buffer space.&#13;
Discontinuities in the value of this counter can occur at re-initialization of the management system,&#13;
and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.out.errors[ifOutErrors.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <description>MIB: IF-MIB&#13;
For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Bits sent</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <description>MIB: IF-MIB&#13;
The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Speed</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.speed[ifHighSpeed.{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>0d</trends>
                            <units>bps</units>
                            <description>MIB: IF-MIB&#13;
An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Operational status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.status[ifOperStatus.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>MIB: IF-MIB&#13;
The current operational state of the interface.&#13;
- The testing(3) state indicates that no operational packet scan be passed&#13;
- If ifAdminStatus is down(2) then ifOperStatus should be down(2)&#13;
- If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic&#13;
- It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)&#13;
- It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state&#13;
- It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({last()}=2 and {diff()}=1)</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>This trigger expression works as follows:&#13;
1. Can be triggered if operations status is down.&#13;
2. {$IFCONTROL:&quot;{#IFNAME}&quot;}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.&#13;
3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)&#13;
&#13;
WARNING: if closed manually - won't fire again on next poll, because of .diff.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Interface type</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.type[ifType.{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>7d</history>
                            <trends>0d</trends>
                            <description>MIB: IF-MIB&#13;
The type of interface.&#13;
Additional values for ifType are assigned by the Internet Assigned NumbersAuthority (IANA),&#13;
through updating the syntax of the IANAifType textual convention.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}({#IFALIAS})</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>IF-MIB::ifType</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1d</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].change()}&lt;0 and {Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()}&gt;0&#13;
and (&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=6 or&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=7 or&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=11 or&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=62 or&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=69 or&#13;
{Template Module Interfaces SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=117&#13;
)&#13;
and&#13;
({Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;&gt;2)</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].change()}&gt;0 and {Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].prev()}&gt;0) or&#13;
({Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2)</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before</name>
                            <opdata>Current reported speed: {ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <description>This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                                    <recovery_expression>{Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>({Template Module Interfaces SNMP:net.if.in[ifHCInOctets.{#SNMPINDEX}].avg(15m)}&gt;({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}/100)*{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()} or&#13;
{Template Module Interfaces SNMP:net.if.out[ifHCOutOctets.{#SNMPINDEX}].avg(15m)}&gt;({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}/100)*{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()}) and&#13;
{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template Module Interfaces SNMP:net.if.in[ifHCInOctets.{#SNMPINDEX}].avg(15m)}&lt;(({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}-3)/100)*{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()} and&#13;
{Template Module Interfaces SNMP:net.if.out[ifHCOutOctets.{#SNMPINDEX}].avg(15m)}&lt;(({$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}-3)/100)*{Template Module Interfaces SNMP:net.if.speed[ifHighSpeed.{#SNMPINDEX}].last()}</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (&gt; {$IF.UTIL.MAX:&quot;{#IFNAME}&quot;}% )</name>
                            <opdata>In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <description>The network interface utilization is close to its estimated maximum bandwidth.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                                    <recovery_expression>{Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Module Interfaces SNMP:net.if.in.errors[ifInErrors.{#SNMPINDEX}].min(5m)}&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}&#13;
or {Template Module Interfaces SNMP:net.if.out.errors[ifOutErrors.{#SNMPINDEX}].min(5m)}&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template Module Interfaces SNMP:net.if.in.errors[ifInErrors.{#SNMPINDEX}].max(5m)}&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8&#13;
and {Template Module Interfaces SNMP:net.if.out.errors[ifOutErrors.{#SNMPINDEX}].max(5m)}&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): High error rate (&gt; {$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} for 5m)</name>
                            <opdata>errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <description>Recovers when below 80% of {$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} threshold</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                                    <recovery_expression>{Template Module Interfaces SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.out.errors[ifOutErrors.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.in.errors[ifInErrors.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FC6EA3</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Interfaces SNMP</host>
                                        <key>net.if.in.discards[ifInDiscards.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$IF.ERRORS.WARN}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$IF.UTIL.MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$IFCONTROL}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFADMINSTATUS.MATCHES}</macro>
                    <value>^.*</value>
                    <description>Ignore notPresent(6)</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFADMINSTATUS.NOT_MATCHES}</macro>
                    <value>^2$</value>
                    <description>Ignore down(2) administrative status</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFALIAS.MATCHES}</macro>
                    <value>.*</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFALIAS.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFDESCR.MATCHES}</macro>
                    <value>.*</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFDESCR.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.NOT_MATCHES}</macro>
                    <value>(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12}|Vlan\d{1,}|vlan\d{1,}|VLAN\d{1,}|VL{1,})</value>
                    <description>Filter out loopbacks, nulls, docker veth links and docker0 bridge by default</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFOPERSTATUS.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFOPERSTATUS.NOT_MATCHES}</macro>
                    <value>^6$</value>
                    <description>Ignore notPresent(6)</description>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFTYPE.MATCHES}</macro>
                    <value>.*</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFTYPE.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>Network interfaces</name>
                    <hsize>1</hsize>
                    <vsize>1</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                                <host>Template Module Interfaces SNMP</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template Module Linux block devices by Zabbix agent</template>
            <name>Template Module Linux block devices by Zabbix agent</name>
            <description>Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Storage</name>
                </application>
                <application>
                    <name>Zabbix raw items</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Block devices discovery</name>
                    <key>vfs.dev.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#DEVTYPE}</macro>
                                <value>disk</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DEVNAME}</macro>
                                <value>{$VFS.DEV.DEVNAME.MATCHES}</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DEVNAME}</macro>
                                <value>{$VFS.DEV.DEVNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk average queue size (avgqu-sz)</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.queue_size[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Current average disk queue, the number of requests outstanding on the disk at the time the performance data is collected.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[10]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.001</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk read request avg waiting time (r_await)</name>
                            <type>CALCULATED</type>
                            <key>vfs.dev.read.await[{#DEVNAME}]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!ms</units>
                            <params>(last(&quot;vfs.dev.read.time.rate[{#DEVNAME}]&quot;)/(last(&quot;vfs.dev.read.rate[{#DEVNAME}]&quot;)+(last(&quot;vfs.dev.read.rate[{#DEVNAME}]&quot;)=0)))*1000*(last(&quot;vfs.dev.read.rate[{#DEVNAME}]&quot;) &gt; 0)</params>
                            <description>This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk read rate</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.read.rate[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!r/s</units>
                            <description>r/s. The number (after merges) of read requests completed per second for the device.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[0]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk read time (rate)</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.read.time.rate[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Rate of total read time counter. Used in r_await calculation</description>
                            <applications>
                                <application>
                                    <name>Zabbix raw items</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[3]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.001</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk utilization</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.util[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>This item is the percentage of elapsed time that the selected disk drive was busy servicing read or writes requests.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[9]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk write request avg waiting time (w_await)</name>
                            <type>CALCULATED</type>
                            <key>vfs.dev.write.await[{#DEVNAME}]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!ms</units>
                            <params>(last(&quot;vfs.dev.write.time.rate[{#DEVNAME}]&quot;)/(last(&quot;vfs.dev.write.rate[{#DEVNAME}]&quot;)+(last(&quot;vfs.dev.write.rate[{#DEVNAME}]&quot;)=0)))*1000*(last(&quot;vfs.dev.write.rate[{#DEVNAME}]&quot;) &gt; 0)</params>
                            <description>This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk write rate</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.write.rate[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>!w/s</units>
                            <description>w/s. The number (after merges) of write requests completed per second for the device.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disk {#DEVNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[4]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Disk write time (rate)</name>
                            <type>DEPENDENT</type>
                            <key>vfs.dev.write.time.rate[{#DEVNAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Rate of total write time counter. Used in w_await calculation</description>
                            <applications>
                                <application>
                                    <name>Zabbix raw items</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[7]</params>
                                </step>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.001</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DEVNAME}: Get stats</name>
                            <key>vfs.file.contents[/sys/block/{#DEVNAME}/stat]</key>
                            <history>0</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Get contents of /sys/block/{#DEVNAME}/stat for disk stats.</description>
                            <applications>
                                <application>
                                    <name>Zabbix raw items</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>return JSON.stringify(value.trim().split(/ +/));</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Module Linux block devices by Zabbix agent:vfs.dev.read.await[{#DEVNAME}].min(15m)} &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;} or {Template Module Linux block devices by Zabbix agent:vfs.dev.write.await[{#DEVNAME}].min(15m)} &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;}</expression>
                            <name>{#DEVNAME}: Disk read/write request responses are too high (read &gt; {$VFS.DEV.READ.AWAIT.WARN:&quot;{#DEVNAME}&quot;} ms for 15m or write &gt; {$VFS.DEV.WRITE.AWAIT.WARN:&quot;{#DEVNAME}&quot;} ms for 15m)</name>
                            <priority>WARNING</priority>
                            <description>This trigger might indicate disk {#DEVNAME} saturation.</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{#DEVNAME}: Disk average waiting time</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.read.await[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.write.await[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>{#DEVNAME}: Disk read/write rates</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.read.rate[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.write.rate[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>{#DEVNAME}: Disk utilization and queue</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.queue_size[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template Module Linux block devices by Zabbix agent</host>
                                        <key>vfs.dev.util[{#DEVNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$VFS.DEV.DEVNAME.MATCHES}</macro>
                    <value>.+</value>
                    <description>This macro is used in block devices discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.DEVNAME.NOT_MATCHES}</macro>
                    <value>^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)</value>
                    <description>This macro is used in block devices discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.READ.AWAIT.WARN}</macro>
                    <value>20</value>
                    <description>Disk read average response time (in ms) before the trigger would fire</description>
                </macro>
                <macro>
                    <macro>{$VFS.DEV.WRITE.AWAIT.WARN}</macro>
                    <value>20</value>
                    <description>Disk write average response time (in ms) before the trigger would fire</description>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Linux CPU by Zabbix agent</template>
            <name>Template Module Linux CPU by Zabbix agent</name>
            <description>Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Interrupts per second</name>
                    <key>system.cpu.intr</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Load average (1m avg)</name>
                    <key>system.cpu.load[all,avg1]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Load average (5m avg)</name>
                    <key>system.cpu.load[all,avg5]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Load average (15m avg)</name>
                    <key>system.cpu.load[all,avg15]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Number of CPUs</name>
                    <key>system.cpu.num</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Context switches per second</name>
                    <key>system.cpu.switches</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>CPU utilization</name>
                    <type>DEPENDENT</type>
                    <key>system.cpu.util</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>CPU utilization in %</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>//Calculate utilization
return (100 - value)</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.cpu.util[,idle]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$CPU.UTIL.CRIT}</expression>
                            <name>High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)</name>
                            <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>CPU utilization is too high. The system might be slow to respond.</description>
                            <dependencies>
                                <dependency>
                                    <name>Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)</name>
                                    <expression>{Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg1].min(5m)}/{Template Module Linux CPU by Zabbix agent:system.cpu.num.last()}&gt;{$LOAD_AVG_PER_CPU.MAX.WARN}&#13;
and {Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg5].last()}&gt;0&#13;
and {Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg15].last()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU guest time</name>
                    <key>system.cpu.util[,guest]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Guest  time (time  spent  running  a  virtual  CPU  for  a  guest  operating  system)</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU guest nice time</name>
                    <key>system.cpu.util[,guest_nice]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Time spent running a niced guest (virtual CPU for guest operating systems under the control of the Linux kernel)</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU idle time</name>
                    <key>system.cpu.util[,idle]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent doing nothing.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU interrupt time</name>
                    <key>system.cpu.util[,interrupt]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of time the CPU has been servicing hardware interrupts.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU iowait time</name>
                    <key>system.cpu.util[,iowait]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Amount of time the CPU has been waiting for I/O to complete.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU nice time</name>
                    <key>system.cpu.util[,nice]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that have been niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU softirq time</name>
                    <key>system.cpu.util[,softirq]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of time the CPU has been servicing software interrupts.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU steal time</name>
                    <key>system.cpu.util[,steal]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of CPU 'stolen' from this virtual machine by the hypervisor for other tasks (such as running another virtual machine).</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU system time</name>
                    <key>system.cpu.util[,system]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running the kernel and its processes.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU user time</name>
                    <key>system.cpu.util[,user]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that are not niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$LOAD_AVG_PER_CPU.MAX.WARN}</macro>
                    <value>1.5</value>
                    <description>Load per CPU considered sustainable. Tune if needed.</description>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Linux filesystems by Zabbix agent</template>
            <name>Template Module Linux filesystems by Zabbix agent</name>
            <description>Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Filesystems</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Mounted filesystem discovery</name>
                    <key>vfs.fs.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>{$VFS.FS.FSTYPE.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>{$VFS.FS.FSTYPE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>{$VFS.FS.FSNAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>{$VFS.FS.FSNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of file systems of different types.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#FSNAME}: Free inodes in %</name>
                            <key>vfs.fs.inode[{#FSNAME},pfree]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Filesystem {#FSNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5m)}&lt;{$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}</expression>
                                    <name>{#FSNAME}: Running out of free inodes (free &lt; {$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                                    <opdata>Free inodes: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>It may become impossible to write to disk if there are no index nodes left.&#13;
As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{min(5m)}&lt;{$VFS.FS.INODE.PFREE.MIN.WARN:&quot;{#FSNAME}&quot;}</expression>
                                    <name>{#FSNAME}: Running out of free inodes (free &lt; {$VFS.FS.INODE.PFREE.MIN.WARN:&quot;{#FSNAME}&quot;}%)</name>
                                    <opdata>Free inodes: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>It may become impossible to write to disk if there are no index nodes left.&#13;
As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>{#FSNAME}: Running out of free inodes (free &lt; {$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                                            <expression>{Template Module Linux filesystems by Zabbix agent:vfs.fs.inode[{#FSNAME},pfree].min(5m)}&lt;{$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#FSNAME}: Space utilization</name>
                            <key>vfs.fs.size[{#FSNAME},pused]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>Space utilization in % for {#FSNAME}</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Filesystem {#FSNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#FSNAME}: Total space</name>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Total space in Bytes</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Filesystem {#FSNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#FSNAME}: Used space</name>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Used storage in Bytes</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Filesystem {#FSNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].last()}&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and&#13;
(({Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},total].last()}-{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},used].last()})&lt;5G or {Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}&lt;1d)</expression>
                            <name>{#FSNAME}: Disk space is critically low (used &gt; {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                            <opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata>
                            <priority>AVERAGE</priority>
                            <description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}.&#13;
 Second condition should be one of the following:&#13;
 - The disk free space is less than 5G.&#13;
 - The disk will be full in less than 24 hours.</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].last()}&gt;{$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;} and&#13;
(({Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},total].last()}-{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},used].last()})&lt;10G or {Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}&lt;1d)</expression>
                            <name>{#FSNAME}: Disk space is low (used &gt; {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}%)</name>
                            <opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}.&#13;
 Second condition should be one of the following:&#13;
 - The disk free space is less than 10G.&#13;
 - The disk will be full in less than 24 hours.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{#FSNAME}: Disk space is critically low (used &gt; {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}%)</name>
                                    <expression>{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].last()}&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and&#13;
(({Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},total].last()}-{Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},used].last()})&lt;5G or {Template Module Linux filesystems by Zabbix agent:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}&lt;1d)</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{#FSNAME}: Disk space usage</name>
                            <width>600</width>
                            <height>340</height>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>969696</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <type>GRAPH_SUM</type>
                                    <item>
                                        <host>Template Module Linux filesystems by Zabbix agent</host>
                                        <key>vfs.fs.size[{#FSNAME},total]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>C80000</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Template Module Linux filesystems by Zabbix agent</host>
                                        <key>vfs.fs.size[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$VFS.FS.FSNAME.MATCHES}</macro>
                    <value>.+</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSNAME.NOT_MATCHES}</macro>
                    <value>^(/dev|/sys|/run|/proc|.+/shm$)</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSTYPE.MATCHES}</macro>
                    <value>^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs)$</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.FSTYPE.NOT_MATCHES}</macro>
                    <value>^\s$</value>
                    <description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description>
                </macro>
                <macro>
                    <macro>{$VFS.FS.INODE.PFREE.MIN.CRIT}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$VFS.FS.INODE.PFREE.MIN.WARN}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$VFS.FS.PUSED.MAX.CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$VFS.FS.PUSED.MAX.WARN}</macro>
                    <value>80</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Linux generic by Zabbix agent</template>
            <name>Template Module Linux generic by Zabbix agent</name>
            <description>Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Inventory</name>
                </application>
                <application>
                    <name>Security</name>
                </application>
                <application>
                    <name>Status</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Maximum number of open file descriptors</name>
                    <key>kernel.maxfiles</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;{$KERNEL.MAXFILES.MIN}</expression>
                            <name>Configured max number of open filedescriptors is too low (&lt; {$KERNEL.MAXFILES.MIN})</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Maximum number of processes</name>
                    <key>kernel.maxproc</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;{$KERNEL.MAXPROC.MIN}</expression>
                            <name>Configured max number of processes is too low (&lt; {$KERNEL.MAXPROC.MIN})</name>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>Getting closer to process limit (over 80% used)</name>
                                    <expression>{Template Module Linux generic by Zabbix agent:proc.num.last()}/{Template Module Linux generic by Zabbix agent:kernel.maxproc.last()}*100&gt;80</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of processes</name>
                    <key>proc.num</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Number of running processes</name>
                    <key>proc.num[,,run]</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System boot time</name>
                    <key>system.boottime</key>
                    <delay>15m</delay>
                    <history>7d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>System host name.</description>
                    <inventory_link>NAME</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>System name has changed (new name: {ITEM.VALUE})</name>
                            <priority>INFO</priority>
                            <description>System name has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System local time</name>
                    <key>system.localtime</key>
                    <history>7d</history>
                    <units>unixtime</units>
                    <description>System local time of the host.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime({$SYSTEM.FUZZYTIME.MAX})}=0</expression>
                            <name>System time is out of sync (diff with Zabbix server &gt; {$SYSTEM.FUZZYTIME.MAX}s)</name>
                            <priority>WARNING</priority>
                            <description>The host system time is different from the Zabbix server time.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Operating system architecture</name>
                    <key>system.sw.arch</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Operating system architecture of the host.</description>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Operating system</name>
                    <key>system.sw.os</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>Operating system description has changed</name>
                            <priority>INFO</priority>
                            <description>Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>System name has changed (new name: {ITEM.VALUE})</name>
                                    <expression>{Template Module Linux generic by Zabbix agent:system.hostname.diff()}=1 and {Template Module Linux generic by Zabbix agent:system.hostname.strlen()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Software installed</name>
                    <key>system.sw.packages</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System description</name>
                    <key>system.uname</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>The information as normally returned by 'uname -a'.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System uptime</name>
                    <key>system.uptime</key>
                    <delay>30s</delay>
                    <history>2w</history>
                    <trends>0d</trends>
                    <units>uptime</units>
                    <description>System uptime in 'N days, hh:mm:ss' format.</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
                            <priority>WARNING</priority>
                            <description>The host uptime is less than 10 minutes</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of logged in users</name>
                    <key>system.users.num</key>
                    <history>7d</history>
                    <description>Number of users who are currently logged in.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Checksum of /etc/passwd</name>
                    <key>vfs.file.cksum[/etc/passwd]</key>
                    <delay>15m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Security</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}&gt;0</expression>
                            <name>/etc/passwd has been changed</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Operating system description has changed</name>
                                    <expression>{Template Module Linux generic by Zabbix agent:system.sw.os.diff()}=1 and {Template Module Linux generic by Zabbix agent:system.sw.os.strlen()}&gt;0</expression>
                                </dependency>
                                <dependency>
                                    <name>System name has changed (new name: {ITEM.VALUE})</name>
                                    <expression>{Template Module Linux generic by Zabbix agent:system.hostname.diff()}=1 and {Template Module Linux generic by Zabbix agent:system.hostname.strlen()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$KERNEL.MAXFILES.MIN}</macro>
                    <value>256</value>
                </macro>
                <macro>
                    <macro>{$KERNEL.MAXPROC.MIN}</macro>
                    <value>1024</value>
                </macro>
                <macro>
                    <macro>{$SYSTEM.FUZZYTIME.MAX}</macro>
                    <value>60</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Linux memory by Zabbix agent</template>
            <name>Template Module Linux memory by Zabbix agent</name>
            <description>Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Memory</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Free swap space</name>
                    <key>system.swap.size[,free]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>The free space of swap volume/file in bytes.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free swap space in %</name>
                    <key>system.swap.size[,pfree]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The free space of swap volume/file in percent.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total swap space</name>
                    <key>system.swap.size[,total]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>The total space of swap volume/file in bytes.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Available memory</name>
                    <key>vm.memory.size[available]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Available memory, in Linux, available = free + buffers + cache. On other platforms calculation may vary. See also: https://www.zabbix.com/documentation/5.0/manual/appendix/items/vm.memory.size_params</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Available memory in %</name>
                    <key>vm.memory.size[pavailable]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Available memory as percentage of total. See also: https://www.zabbix.com/documentation/5.0/manual/appendix/items/vm.memory.size_params</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total memory</name>
                    <key>vm.memory.size[total]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Total memory in Bytes</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used memory</name>
                    <key>vm.memory.size[used]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>Used memory, in Linux, Used = total - free. On other platforms calculation may vary. See also: https://www.zabbix.com/documentation/5.0/manual/appendix/items/vm.memory.size_params</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memory utilization</name>
                    <type>DEPENDENT</type>
                    <key>vm.memory.utilization</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Memory used percentage is calculated as (100-pavailable)</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>return (100-value);</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vm.memory.size[pavailable]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$MEMORY.UTIL.MAX}</expression>
                            <name>High memory utilization (&gt;{$MEMORY.UTIL.MAX}% for 5m)</name>
                            <priority>AVERAGE</priority>
                            <description>The system is running out of free memory.</description>
                            <dependencies>
                                <dependency>
                                    <name>Lack of available memory (&lt; {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})</name>
                                    <expression>{Template Module Linux memory by Zabbix agent:vm.memory.size[available].min(5m)}&lt;{$MEMORY.AVAILABLE.MIN} and {Template Module Linux memory by Zabbix agent:vm.memory.size[total].last()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$MEMORY.AVAILABLE.MIN}</macro>
                    <value>20M</value>
                    <description>This macro is used as a threshold in memory available trigger.</description>
                </macro>
                <macro>
                    <macro>{$MEMORY.UTIL.MAX}</macro>
                    <value>90</value>
                    <description>This macro is used as a threshold in memory utilization trigger.</description>
                </macro>
                <macro>
                    <macro>{$SWAP.PFREE.MIN.WARN}</macro>
                    <value>50</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Linux network interfaces by Zabbix agent</template>
            <name>Template Module Linux network interfaces by Zabbix agent</name>
            <description>Known Issues:&#13;
&#13;
  Description: High interface utilization trigger is removed since currently it is not possible to retrieve interface speed to determine the max bandwidth.&#13;
&#13;
Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Network interfaces</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interface discovery</name>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Discovery of network interfaces.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Inbound packets discarded</name>
                            <key>net.if.in[&quot;{#IFNAME}&quot;,dropped]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Inbound packets with errors</name>
                            <key>net.if.in[&quot;{#IFNAME}&quot;,errors]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Bits received</name>
                            <key>net.if.in[&quot;{#IFNAME}&quot;]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Outbound packets discarded</name>
                            <key>net.if.out[&quot;{#IFNAME}&quot;,dropped]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Outbound packets with errors</name>
                            <key>net.if.out[&quot;{#IFNAME}&quot;,errors]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Bits sent</name>
                            <key>net.if.out[&quot;{#IFNAME}&quot;]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Operational status</name>
                            <key>vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;]</key>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>Indicates the interface RFC2863 operational state as a string.&#13;
Possible values are:&quot;unknown&quot;, &quot;notpresent&quot;, &quot;down&quot;, &quot;lowerlayerdown&quot;, &quot;testing&quot;,&quot;dormant&quot;, &quot;up&quot;.&#13;
Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var newvalue;
switch(value) {
  case &quot;up&quot;:
    newvalue = 1;
    break;
  case &quot;down&quot;:
    newvalue = 2;
    break;
  case &quot;testing&quot;:
    newvalue = 4;
    break;
  case &quot;unknown&quot;:
    newvalue = 5;
    break;
  case &quot;dormant&quot;:
    newvalue = 6;
    break;
  case &quot;notPresent&quot;:
    newvalue = 7;
    break;
  default:
    newvalue = &quot;Problem parsing interface operstate in JS&quot;;
}
return newvalue;</params>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({last()}=2 and {diff()}=1)</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                    <name>Interface {#IFNAME}: Link down</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>This trigger expression works as follows:&#13;
1. Can be triggered if operations status is down.&#13;
2. {$IFCONTROL:&quot;{#IFNAME}&quot;}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.&#13;
3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)&#13;
&#13;
WARNING: if closed manually - won't fire again on next poll, because of .diff.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFNAME}: Interface type</name>
                            <key>vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;]</key>
                            <delay>1h</delay>
                            <history>7d</history>
                            <trends>0d</trends>
                            <description>Indicates the interface protocol type as a decimal value.&#13;
See include/uapi/linux/if_arp.h for all possible values.&#13;
Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Interface {#IFNAME}</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>Linux::Interface protocol types</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1d</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].change()}&lt;0 and {Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].last()}&gt;0&#13;
and&#13;
({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].last()}=6&#13;
or {Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].last()}=1)&#13;
and&#13;
({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}&lt;&gt;2)</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].change()}&gt;0 and {Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/type&quot;].prev()}&gt;0) or&#13;
({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}=2)</recovery_expression>
                            <name>Interface {#IFNAME}: Ethernet has changed to lower speed than it was before</name>
                            <opdata>Current reported speed: {ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <description>This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}: Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}=2 and {Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].diff()}=1)</expression>
                                    <recovery_expression>{Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{Template Module Linux network interfaces by Zabbix agent:net.if.in[&quot;{#IFNAME}&quot;,errors].min(5m)}&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}&#13;
or {Template Module Linux network interfaces by Zabbix agent:net.if.out[&quot;{#IFNAME}&quot;,errors].min(5m)}&gt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template Module Linux network interfaces by Zabbix agent:net.if.in[&quot;{#IFNAME}&quot;,errors].max(5m)}&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8&#13;
and {Template Module Linux network interfaces by Zabbix agent:net.if.out[&quot;{#IFNAME}&quot;,errors].max(5m)}&lt;{$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;}*0.8</recovery_expression>
                            <name>Interface {#IFNAME}: High error rate (&gt; {$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} for 5m)</name>
                            <opdata>errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <description>Recovers when below 80% of {$IF.ERRORS.WARN:&quot;{#IFNAME}&quot;} threshold</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}: Link down</name>
                                    <expression>{$IFCONTROL:&quot;{#IFNAME}&quot;}=1 and ({Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}=2 and {Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].diff()}=1)</expression>
                                    <recovery_expression>{Template Module Linux network interfaces by Zabbix agent:vfs.file.contents[&quot;/sys/class/net/{#IFNAME}/operstate&quot;].last()}&lt;&gt;2 or {$IFCONTROL:&quot;{#IFNAME}&quot;}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Interface {#IFNAME}: Network traffic</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.in[&quot;{#IFNAME}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.out[&quot;{#IFNAME}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.out[&quot;{#IFNAME}&quot;,errors]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.in[&quot;{#IFNAME}&quot;,errors]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FC6EA3</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.out[&quot;{#IFNAME}&quot;,dropped]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template Module Linux network interfaces by Zabbix agent</host>
                                        <key>net.if.in[&quot;{#IFNAME}&quot;,dropped]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$IF.ERRORS.WARN}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$IFCONTROL}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$NET.IF.IFNAME.NOT_MATCHES}</macro>
                    <value>(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})</value>
                    <description>Filter out loopbacks, nulls, docker veth links and docker0 bridge by default</description>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>Network interfaces</name>
                    <hsize>1</hsize>
                    <vsize>1</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Interface {#IFNAME}: Network traffic</name>
                                <host>Template Module Linux network interfaces by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template Module Zabbix agent</template>
            <name>Template Module Zabbix agent</name>
            <description>Use this template for agents reachable from Zabbix server/proxy (passive mode).&#13;
&#13;
Template tooling version used: 0.34</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Monitoring agent</name>
                </application>
                <application>
                    <name>Status</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Host name of Zabbix agent running</name>
                    <key>agent.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Monitoring agent</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Zabbix agent ping</name>
                    <key>agent.ping</key>
                    <history>7d</history>
                    <description>The agent always returns 1 for this item. It could be used in combination with nodata() for availability check.</description>
                    <applications>
                        <application>
                            <name>Monitoring agent</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Zabbix agent ping status</name>
                    </valuemap>
                </item>
                <item>
                    <name>Version of Zabbix agent running</name>
                    <key>agent.version</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Monitoring agent</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Zabbix agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,agent,available]</key>
                    <history>7d</history>
                    <description>Monitoring agent availability status</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max({$AGENT.TIMEOUT})}=0</expression>
                            <name>Zabbix agent is not available (for {$AGENT.TIMEOUT})</name>
                            <priority>AVERAGE</priority>
                            <description>For passive only agents, host availability is used with {$AGENT.TIMEOUT} as time threshold.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$AGENT.TIMEOUT}</macro>
                    <value>3m</value>
                    <description>Timeout after which agent is considered unavailable. Works only for agents reachable from Zabbix server/proxy (passive mode).</description>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Module Zabbix agent active</template>
            <name>Template Module Zabbix agent active</name>
            <description>Use this template instead of 'Template Module Zabbix agent' for agents running in active mode only.&#13;
&#13;
Template tooling version used: 0.34</description>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Monitoring agent</name>
                </application>
                <application>
                    <name>Status</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Host name of Zabbix agent running</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>agent.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Monitoring agent</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Zabbix agent ping</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>agent.ping</key>
                    <history>7d</history>
                    <description>The agent always returns 1 for this item. It could be used in combination with nodata() for availability check.</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Zabbix agent ping status</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{nodata({$AGENT.NODATA_TIMEOUT})}=1</expression>
                            <name>Zabbix agent is not available (or nodata for {$AGENT.NODATA_TIMEOUT})</name>
                            <priority>AVERAGE</priority>
                            <description>For active agents, nodata() with agent.ping is used with {$AGENT.NODATA_TIMEOUT} as time threshold.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Version of Zabbix agent running</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>agent.version</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Monitoring agent</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$AGENT.NODATA_TIMEOUT}</macro>
                    <value>30m</value>
                    <description>No data timeout for active agents. Consider to keep it relatively high.</description>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template Net Cisco IOS prior to 12.0_3_T SNMP</template>
            <name>Template Net Cisco IOS prior to 12.0_3_T SNMP</name>
            <description>Cisco IOS Software releases prior to 12.0(3)T&#13;
&#13;
Template tooling version used: 0.38</description>
            <templates>
                <template>
                    <name>Template Module Cisco CISCO-ENVMON-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco Inventory SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco OLD-CISCO-CPU-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Generic SNMP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Cisco</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template Net Cisco IOS SNMP</template>
            <name>Template Net Cisco IOS SNMP</name>
            <description>Template Cisco IOS Software releases 12.2(3.5) or later&#13;
&#13;
Known Issues:&#13;
&#13;
  Description: no if(in|out)(Errors|Discards) are available for vlan ifType&#13;
  Version: IOS for example: 12.1(22)EA11, 15.4(3)M2&#13;
  Device: C2911, C7600&#13;
&#13;
Template tooling version used: 0.38</description>
            <templates>
                <template>
                    <name>Template Module Cisco CISCO-ENVMON-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco CISCO-PROCESS-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco Inventory SNMP</name>
                </template>
                <template>
                    <name>Template Module EtherLike-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Generic SNMP</name>
                </template>
                <template>
                    <name>Template Module Interfaces SNMP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Cisco</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template Net Cisco IOS versions 12.0_3_T-12.2_3.5 SNMP</template>
            <name>Template Net Cisco IOS versions 12.0_3_T-12.2_3.5 SNMP</name>
            <description>Cisco IOS Software releases later to 12.0(3)T and prior to 12.2(3.5)&#13;
&#13;
Template tooling version used: 0.38</description>
            <templates>
                <template>
                    <name>Template Module Cisco CISCO-ENVMON-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco CISCO-MEMORY-POOL-MIB SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco CISCO-PROCESS-MIB IOS versions 12.0_3_T-12.2_3.5 SNMP</name>
                </template>
                <template>
                    <name>Template Module Cisco Inventory SNMP</name>
                </template>
                <template>
                    <name>Template Module Generic SNMP</name>
                </template>
                <template>
                    <name>Template Module Interfaces SNMP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Cisco</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template OS Linux by Zabbix agent</template>
            <name>Template OS Linux by Zabbix agent</name>
            <description>Official Linux template. Requires agent of Zabbix 3.0.14, 3.4.5 and 4.0.0 or newer.&#13;
&#13;
Known Issues:&#13;
&#13;
  Description: Network discovery. Zabbix agent as of 4.2 doesn't support items such as net.if.status, net.if.speed.&#13;
&#13;
You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux&#13;
&#13;
Template tooling version used: 0.38</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template Module Linux block devices by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Linux CPU by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Linux filesystems by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Linux generic by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Linux memory by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Linux network interfaces by Zabbix agent</name>
                </template>
                <template>
                    <name>Template Module Zabbix agent</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Motherboard</name>
                    <key>system.hw.chassis[full]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{change()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Motherboard: caption has been changed ({HOST.IP})</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template OS Linux by Zabbix agent:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU</name>
                    <key>system.hw.cpu[all,model]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{change()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>CPU: caption has been changed ({HOST.IP})</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                    <expression>{Template OS Linux by Zabbix agent:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <screens>
                <screen>
                    <name>System performance</name>
                    <hsize>2</hsize>
                    <vsize>7</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>System load</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>CPU usage</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Memory usage</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Swap usage</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>{#FSNAME}: Disk space usage</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>{#DEVNAME}: Disk read/write rates</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>3</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>{#DEVNAME}: Disk average waiting time</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>4</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>{#DEVNAME}: Disk utilization and queue</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>5</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Interface {#IFNAME}: Network traffic</name>
                                <host>Template OS Linux by Zabbix agent</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>6</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template OS Linux Solvo</template>
            <name>Template OS Linux Solvo</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Seq</name>
                </application>
                <application>
                    <name>WMS_GATEWAY</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>host2wms</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/host2wms/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;100</expression>
                            <name>host2wms &gt; 100</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>host2wms_fail</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/host2wms_fail/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;100</expression>
                            <name>host2wms_fail &gt; 100</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>host2wms_success</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/host2wms_success/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>wms2host</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/wms2host/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;100</expression>
                            <name>wms2host &gt; 100</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>wms2host_fail</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/wms2host_fail/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;100</expression>
                            <name>wms2host_fail &gt; 100</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>wms2host_success</name>
                    <key>system.run[ls /usr/local/WMS/MPS/gateway/wms2host_success/ | wc -l]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>7d</trends>
                    <applications>
                        <application>
                            <name>WMS_GATEWAY</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>SeqN</name>
                    <key>vfs.file.contents[/seq]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Seq</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template OS Windows by Zabbix Agent</template>
            <name>Template OS Windows by Zabbix Agent</name>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template_Host_Status</name>
                </template>
                <template>
                    <name>Template_Windows_General</name>
                </template>
                <template>
                    <name>Template_Windows_Memory</name>
                </template>
                <template>
                    <name>Template_Windows_Processor</name>
                </template>
                <template>
                    <name>Template_Windows_SysInfo</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>PL</name>
                    <key>system.cpu.load[,avg1]</key>
                    <delay>2m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;4</expression>
                            <name>Большая нагрузка на процессор {HOSTNAME}</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>PU</name>
                    <key>system.cpu.util[,,avg1]</key>
                    <delay>2m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(#3)}&gt;50</expression>
                            <name>{HOSTNAME} - Процессор нагружен более 50%</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>pAvailable memory</name>
                    <key>vm.memory.size[pavailable]</key>
                    <delay>2m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(#3)}&lt;10</expression>
                            <name>{HOSTNAME} - Свободная память &lt; 10 %</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template pfSense Active</template>
            <name>pfsense Active</name>
            <description>Active template for pfsense, requires pfsense_zbx.php installed to pfSense Box.&#13;
Version 1.0.2&#13;
&#13;
https://github.com/rbicelli/pfsense-zabbix-template</description>
            <groups>
                <group>
                    <name>Templates/PfSense</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Filesystems</name>
                </application>
                <application>
                    <name>Gateways</name>
                </application>
                <application>
                    <name>HA</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network interfaces</name>
                </application>
                <application>
                    <name>Network Limits</name>
                </application>
                <application>
                    <name>OpenVPN Client</name>
                </application>
                <application>
                    <name>OpenVPN Server</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>Processes</name>
                </application>
                <application>
                    <name>Services</name>
                </application>
                <application>
                    <name>System</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Maximum number of opened files</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>kernel.maxfiles</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;1024</expression>
                            <name>Configured max number of opened files is too low on {HOST.NAME}</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Maximum number of processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>kernel.maxproc</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <description>It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;256</expression>
                            <name>Configured max number of processes is too low on {HOST.NAME}</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Used memory (calc)</name>
                    <type>CALCULATED</type>
                    <key>kt.mem.used</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <params>last(vm.memory.size[total]) - last(vm.memory.size[available])</params>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Expected CARP Status</name>
                    <type>CALCULATED</type>
                    <key>pfsense.expected_carp_status</key>
                    <delay>30s</delay>
                    <params>{$EXPECTED_CARP_STATUS}</params>
                    <description>Expected CARP Status</description>
                    <applications>
                        <application>
                            <name>HA</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>pfSense CARP Status</name>
                    </valuemap>
                </item>
                <item>
                    <name>MBUF Cache</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.mbuf.cache</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>MBUF Current</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.mbuf.current</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>MBUF Max</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.mbuf.max</key>
                    <delay>600</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>MBUF Total Used (percent)</name>
                    <type>CALCULATED</type>
                    <key>pfsense.mbuf.ptotal</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>((last(pfsense.mbuf.current) + last(pfsense.mbuf.cache)) * 100) / last(pfsense.mbuf.max)</params>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;80</expression>
                            <name>MBUF used at 80%</name>
                            <priority>WARNING</priority>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;90</expression>
                            <name>MBUF used at 90%</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>States Table Current</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.states.current</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>States Table Max</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.states.max</key>
                    <delay>600</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>States Table Current (percent)</name>
                    <type>CALCULATED</type>
                    <key>pfsense.states.pused</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>(last(pfsense.states.current) * 100) / last(pfsense.states.max)</params>
                    <applications>
                        <application>
                            <name>Network Limits</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;80</expression>
                            <name>State Table used at 80%</name>
                            <priority>WARNING</priority>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;90</expression>
                            <name>State Table used at 90%</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CARP Status</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[carp_status]</key>
                    <delay>30s</delay>
                    <description>pfSense CARP Status</description>
                    <applications>
                        <application>
                            <name>HA</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>pfSense CARP Status</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;2</expression>
                            <name>CARP  Problems on {HOST.NAME}</name>
                            <priority>HIGH</priority>
                            <description>CARP Problems</description>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;2</expression>
                            <name>DHCP Failover Problems on {HOST.NAME}</name>
                            <url>https://docs.netgate.com/pfsense/en/latest/troubleshooting/ha-dhcp-failover.html</url>
                            <priority>HIGH</priority>
                            <description>One or more DHCP Pools are experiencing failover problems. This could potentially cause other problems in yourr network.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DHCP Failover Pool Problems</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[dhcp,failover]</key>
                    <delay>120s</delay>
                    <description>This value indicates, in a HA scenario, if DHCP failover pool partners are out of sync.</description>
                    <applications>
                        <application>
                            <name>HA</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Gateway Status Raw</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[gw_status]</key>
                    <delay>60s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Gateway Status Raw</description>
                    <applications>
                        <application>
                            <name>Gateways</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{diff()}=0</recovery_expression>
                            <name>pfSense Gateway Status Changed on {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                            <description>Gateway Status Change, for use with an acion Script (e.g. update DNS record)</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>pfSense Installed Version</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[system,installed_version]</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>New Version of pfSense Available</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[system,new_version_available]</key>
                    <delay>1d</delay>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Generic YesNo</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=1</expression>
                            <name>New Version of pfSense Available on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <description>A new version of pfSense is available for update.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Packages Needing Update</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[system,packages_update]</key>
                    <delay>1d</delay>
                    <description>Number of packages needing update.</description>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Packages Update Available on {HOST.NAME}</name>
                            <priority>INFO</priority>
                            <description>New version of packages are available</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>pfSense Available Version</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.value[system,version]</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Number of running processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>proc.num[,,run]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <description>Number of processes in running state.</description>
                    <applications>
                        <application>
                            <name>Processes</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;30</expression>
                            <name>Too many processes running on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>proc.num[]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <description>Total number of processes in any state.</description>
                    <applications>
                        <application>
                            <name>Processes</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;300</expression>
                            <name>Too many processes on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host boot time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.boottime</key>
                    <delay>600</delay>
                    <history>27d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Interrupts per second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.intr</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>ips</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Processor load (1min/core)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.load[percpu,avg1]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;5</expression>
                            <name>Processor load is too high on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor load (5min/core)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.load[percpu,avg5]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Processor load (15min/core)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.load[percpu,avg15]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as system CPU load divided by number of CPU cores.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Context switches per second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.switches</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>sps</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.util[,idle]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent doing nothing.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.util[,interrupt]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The amount of time the CPU has been servicing hardware interrupts.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.util[,nice]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that have been niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.util[,system]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running the kernel and its processes.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU $2 time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.cpu.util[,user]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>The time the CPU has spent running users' processes that are not niced.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Host name</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.hostname</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>System host name.</description>
                    <inventory_link>NAME</inventory_link>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Hostname was changed on {HOST.NAME}</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host local time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.localtime</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free swap space</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,free]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free swap space in %</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,pfree]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;50</expression>
                            <name>Lack of free swap space on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                            <description>It probably means that the systems requires more physical memory.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total swap space</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,total]</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used swap space</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,used]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System information</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uname</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>The information as normally returned by 'uname -a'.</description>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Host information was changed on {HOST.NAME}</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System uptime</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uptime</key>
                    <delay>600</delay>
                    <history>27d</history>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{change(0)}&lt;0</expression>
                            <name>{HOST.NAME} has just been restarted</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of logged in users</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.users.num</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <description>Number of users who are currently logged in.</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Checksum of $1</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vfs.file.cksum[/etc/passwd]</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>/etc/passwd has been changed on {HOST.NAME}</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Active memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[active]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <description>quantité de mémoire en cours d'utilisation par les processus</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Available memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[available]</key>
                    <delay>60</delay>
                    <history>27d</history>
                    <units>B</units>
                    <description>Available memory is defined as free+cached+buffers memory.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;20M</expression>
                            <name>Lack of available memory on server {HOST.NAME}</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Buffered memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[buffers]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <description>Cache d'entrées des IO disque.&#13;
&#13;
(Item désactivé car buggé)</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Cached memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[cached]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <description>quantité de mémoire utilisée pour mettre des données en cache</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[free]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <description>quantité de mémoire complètement libre et prête a être utilisée directement.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Inactive memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[inactive]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <description>quantité de mémoire qui contient des données qui ne sont plus utilisées (peut être directement libéré si besoin)</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Available memory (percent)</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[pavailable]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Available memory is defined as free+cached+buffers memory.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Shared memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[shared]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <description>quantité de mémoire partagée entre plusieurs processus&#13;
&#13;
(Item désactivé car non utilisé)</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[total]</key>
                    <delay>3600</delay>
                    <history>27d</history>
                    <units>B</units>
                    <description>quantité de mémoire totale</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Used memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[used]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <description>Item désactivé car non utilisé</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Wired memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vm.memory.size[wired]</key>
                    <delay>60</delay>
                    <history>28d</history>
                    <units>B</units>
                    <description>quantité de mémoire utilisée par le kernel, ne peut être ni déchargée en swap, ni compressée.</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Gateways Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[gw]</key>
                    <delay>300s</delay>
                    <description>Gateway Discovery</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Gateway $2 RTT</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[gw_value,{#GATEWAY},delay]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <applications>
                                <application>
                                    <name>Gateways</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>RTRIM</type>
                                    <params>ms</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Gateway $2 Packet  Loss</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[gw_value,{#GATEWAY},loss]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Gateways</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>RTRIM</type>
                                    <params>%</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Gateway $2 Status</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[gw_value,{#GATEWAY},status]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <description>Status of Gateway</description>
                            <applications>
                                <application>
                                    <name>Gateways</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense Gateway Status</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=5</expression>
                                    <name>Gateway {#GATEWAY} is down</name>
                                    <priority>DISASTER</priority>
                                    <description>Gateway is Down</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}=4</expression>
                                    <name>Gateway {#GATEWAY} is forced down</name>
                                    <priority>INFO</priority>
                                    <description>Gateway is forced down by system administrator</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}=2</expression>
                                    <name>High Delay on gateway {#GATEWAY}</name>
                                    <priority>WARNING</priority>
                                    <description>Gateway is lagging</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}=3</expression>
                                    <name>High packet Loss on {#GATEWAY}</name>
                                    <priority>HIGH</priority>
                                    <description>High Packet Loss on Gateway</description>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}=1</expression>
                                    <name>Packet Loss on {#GATEWAY}</name>
                                    <priority>WARNING</priority>
                                    <description>Packet loss on Gateway</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Gateway $2 RTT Std Deviation</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[gw_value,{#GATEWAY},stddev]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                            <applications>
                                <application>
                                    <name>Gateways</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>RTRIM</type>
                                    <params>ms</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Gateway {#GATEWAY} Availability</name>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>pfsense.value[gw_value,{#GATEWAY},delay]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>FF5722</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>pfsense.value[gw_value,{#GATEWAY},loss]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Gateway {#GATEWAY} Status</name>
                            <yaxismax>5</yaxismax>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <ymax_type_1>FIXED</ymax_type_1>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>pfsense.value[gw_value,{#GATEWAY},status]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interface discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[interfaces]</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>@Network interfaces for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Discovery of network interfaces as defined in global regular expression &quot;Network interfaces for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Incoming Errors on {#IFDESCR}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.in[{#IFNAME},errors]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming network traffic on {#IFDESCR}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.in[{#IFNAME}]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing errors on {#IFDESCR}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.out[{#IFNAME},errors]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing network traffic on {#IFDESCR}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>net.if.out[{#IFNAME}]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Network traffic on {#IFDESCR}</name>
                            <show_triggers>NO</show_triggers>
                            <show_legend>NO</show_legend>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>29E900</color>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>net.if.in[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>FD0000</color>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>net.if.out[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>OpenVPN Client Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[openvpn_client]</key>
                    <delay>300s</delay>
                    <description>OpenVPN Client Discovery</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>OpenVPN Client  {#NAME} Tunnel Status</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_clientvalue,{#CLIENT},status]</key>
                            <delay>60s</delay>
                            <applications>
                                <application>
                                    <name>OpenVPN Client</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense OpenVPN Interface Status</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=0</expression>
                                    <name>OpenVPN Client {#NAME} Tunnel is Down</name>
                                    <priority>HIGH</priority>
                                    <description>OpenVPN Tunnel Down</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>OpenVPN Server Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[openvpn_server]</key>
                    <delay>300s</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>OpenVPN Server {#NAME} Clients Connected</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_servervalue,{#SERVER},conns]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>OpenVPN Server</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#NAME} Mode</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_servervalue,{#SERVER},mode]</key>
                            <delay>300s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>OpenVPN Server</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense OpenVPN Mode</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#NAME} Port</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_servervalue,{#SERVER},port]</key>
                            <delay>300s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>OpenVPN Server</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#NAME} Tunnel Status</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_servervalue,{#SERVER},status]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>OpenVPN Server</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense OpenVPN Interface Status</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template pfSense Active:pfsense.expected_carp_status.last()}&lt;&gt;2 and {Template pfSense Active:pfsense.value[openvpn_servervalue,{#SERVER},status].last()}=0</expression>
                            <name>OpenVPN Server {#NAME} is Down</name>
                            <priority>HIGH</priority>
                            <description>OpenVPN Tunnel is Down</description>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Services Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[services]</key>
                    <delay>300s</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Service {#DESCRIPTION}  enabled on CARP Slave</name>
                            <key>pfsense.value[service_value,{#SERVICE},run_on_carp_slave]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>Services</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Generic YesNo</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Service {#DESCRIPTION} Status</name>
                            <key>pfsense.value[service_value,{#SERVICE},status]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <applications>
                                <application>
                                    <name>Services</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Service state</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template pfSense Active:pfsense.value[service_value,{#SERVICE},status].last()}=0 and (&#13;
&#13;
({Template pfSense Active:pfsense.value[service_value,{#SERVICE},run_on_carp_slave].last()}=1 and &#13;
{Template pfSense Active:pfsense.value[carp_status].last()}=2)&#13;
&#13;
or&#13;
&#13;
( {Template pfSense Active:pfsense.value[carp_status].last()}=1)&#13;
&#13;
or&#13;
&#13;
({Template pfSense Active:pfsense.value[carp_status].last()}=0)&#13;
)</expression>
                            <name>Service {#DESCRIPTION} is not running</name>
                            <priority>HIGH</priority>
                            <description>Service is not running</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Mounted filesystem discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>vfs.fs.discovery</key>
                    <delay>3600</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>@File systems for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Discovery of file systems of different types as defined in global regular expression &quot;File systems for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Free inodes on $1 (percentage)</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.inode[{#FSNAME},pfree]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(0)}&lt;20</expression>
                                    <name>Free inodes is less than 20% on volume {#FSNAME}</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Free disk space on $1</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},free]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free disk space on $1 (percentage)</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},pfree]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(0)}&lt;20</expression>
                                    <name>Free disk space is less than 20% on volume {#FSNAME}</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Total disk space on $1</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <delay>3600</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Used disk space on $1</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Disk space usage {#FSNAME}</name>
                            <width>600</width>
                            <height>340</height>
                            <yaxismax>0</yaxismax>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>CC0000</color>
                                    <type>GRAPH_SUM</type>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>vfs.fs.size[{#FSNAME},total]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>5B5B5B</color>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>vfs.fs.size[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>AEEE00</color>
                                    <item>
                                        <host>Template pfSense Active</host>
                                        <key>vfs.fs.size[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$CARP_SERVICES_STOPPED}</macro>
                    <value>^(haproxy|openvpn)$</value>
                </macro>
                <macro>
                    <macro>{$CARP_SLAVE_SERVICES:&quot;haproxy&quot;}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$CARP_SLAVE_SERVICES:&quot;openvpn&quot;}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$EXPECTED_CARP_STATUS}</macro>
                    <value>0</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>System performance</name>
                    <hsize>2</hsize>
                    <vsize>2</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Active Connections (pie)</name>
                                <host>Template pfSense Active</host>
                            </resource>
                            <width>450</width>
                            <height>250</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Network Memory Buffer (pie)</name>
                                <host>Template pfSense Active</host>
                            </resource>
                            <width>450</width>
                            <height>250</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>CPU load</name>
                                <host>Template pfSense Active</host>
                            </resource>
                            <width>450</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Memory Usage simple (pie)</name>
                                <host>Template pfSense Active</host>
                            </resource>
                            <width>450</width>
                            <height>250</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
        <template>
            <template>Template pfSense Active IPsec</template>
            <name>pfSense Active: IPsec</name>
            <description>Extension for pfSense Active Template.&#13;
Monitor IPsec VPN.&#13;
&#13;
Requires pfsense_zbx.php installed to pfSense Box.&#13;
Version 1.0.2&#13;
&#13;
https://github.com/rbicelli/pfsense-zabbix-template</description>
            <groups>
                <group>
                    <name>Templates/PfSense</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>IPsec</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>IPsec Phase 1 Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[ipsec_ph1]</key>
                    <delay>1200s</delay>
                    <description>Discovery of IPsec Phase 1</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME} Tunnel Enabled</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},disabled]</key>
                            <delay>120s</delay>
                            <history>14d</history>
                            <description>IPsec Phase 1  Tunnel Mode</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Enabled</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME} IKE Type</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},iketype]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>IPsec Phase 1 IKE Type</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec IKE Type</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME} Tunnel Mode</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},mode]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>IPsec Phase 1  Tunnel Mode</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Tunnel Mode</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME} Protocol</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},protocol]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>IPsec Phase 1 Protocol</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Protocol</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME}  Remote Gateway</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},remote-gateway]</key>
                            <delay>600s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>IPsec Phase 1  Remote Gateway</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel {#IKEID} {#NAME}  Phase 1 Status</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph1,{#IKEID},status]</key>
                            <delay>60s</delay>
                            <history>14d</history>
                            <description>IPsec Phase 1  Tunnel Mode</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Phase 1 Status</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template pfSense Active IPsec:pfsense.value[ipsec_ph1,{#IKEID},disabled].last()}=0 and {Template pfSense Active IPsec:pfsense.value[ipsec_ph1,{#IKEID},status].last()}&lt;&gt;1 and {Template pfSense Active IPsec:pfsense.value[ipsec_ph1,{#IKEID},status].last()}&lt;10</expression>
                            <name>IPsec Tunnel {#IKEID} ({#NAME}) Not Connected</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <description>IPsec Phase 1 is not connected.</description>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>IPsec Phase 2 Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[ipsec_ph2]</key>
                    <delay>1200s</delay>
                    <description>Discovery of IPsec Phase 2</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>IPsec Tunnel  {#IKEID}.{#REQID} {#NAME} Phase 2 Enabled</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph2,{#UNIQID},disabled]</key>
                            <delay>120s</delay>
                            <history>14d</history>
                            <description>IPsec Tunnel Phase 2 Protocol</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Enabled</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel  {#IKEID}.{#REQID} {#NAME} Phase 2 Life Time</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph2,{#UNIQID},lifetime]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <units>s</units>
                            <description>IPsec Tunnel Phase 2 Life Time</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel  {#IKEID}.{#REQID} {#NAME} Phase 2 Mode</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph2,{#UNIQID},mode]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>IPsec Tunnel Phase 2 Mode</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>IPsec Tunnel  {#IKEID}.{#REQID} {#NAME} Phase 2 Protocol</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[ipsec_ph2,{#UNIQID},protocol]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>IPsec Tunnel Phase 2 Protocol</description>
                            <applications>
                                <application>
                                    <name>IPsec</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>pfSense IPsec Phase 2 Protocol</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template pfSense Active OpenVPN Server User Auth</template>
            <name>pfSense Active: OpenVPN Server User Auth</name>
            <description>Extension for pfSense Active Template.&#13;
Monitor client Connections of OpenVPN Server.&#13;
&#13;
Requires pfsense_zbx.php installed to pfSense Box.&#13;
Version 1.0.2&#13;
&#13;
https://github.com/rbicelli/pfsense-zabbix-template</description>
            <groups>
                <group>
                    <name>Templates/PfSense</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>OpenVPN Server Clients</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>OpenVPN User Auth Connected Clients Discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>pfsense.discovery[openvpn_server_user]</key>
                    <delay>60s</delay>
                    <description>Discovery of clients connected to OpenVPN Server in User Auth Mode</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Bytes Received</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},bytes_recv]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <units>bytes</units>
                            <description>Client Bytes Received</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Bytes Sent</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},bytes_sent]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <units>bytes</units>
                            <description>Client Bytes Sent</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Connection Time</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},connect_time_unix]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <units>unixtime</units>
                            <description>Client Connect Time</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Remote Host</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},remote_host]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Remote Host</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: User Name</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},user_name]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Client User Name</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Virtual IP Address (IPv6)</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},virtual_addr6]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>IPv6 Address assigned from OpenVPN Server</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Virtual IP Address</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue,{#UNIQUEID},virtual_addr]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>IP Address assigned from OpenVPN Server</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Client ID</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue_numeric,{#UNIQUEID},client_id]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <description>Client ID</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>OpenVPN Server {#SERVERNAME}, Client {#USERID}: Peer ID</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>pfsense.value[openvpn_server_uservalue_numeric,{#UNIQUEID},peer_id]</key>
                            <delay>60s</delay>
                            <trends>0</trends>
                            <description>Peer ID</description>
                            <applications>
                                <application>
                                    <name>OpenVPN Server Clients</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template SNMP Mikrotik CCR 2004</template>
            <name>Template Net Mikrotik CCR 2004</name>
            <description>Template for Mikrotik CCR 2004 router</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template SNMP Mikrotik Global</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Board temperature 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7101</snmp_oid>
                    <key>mikrotik.board.temperature.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <value_type>FLOAT</value_type>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Board temperature 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7102</snmp_oid>
                    <key>mikrotik.board.temperature.2</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <value_type>FLOAT</value_type>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7001</snmp_oid>
                    <key>mikrotik.fan.speed.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7002</snmp_oid>
                    <key>mikrotik.fan.speed.2</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Temperature 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.14</snmp_oid>
                    <key>mikrotik.temperature.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <value_type>FLOAT</value_type>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
        <template>
            <template>Template SNMP Mikrotik CRS 328</template>
            <name>Template Net Mikrotik CRS 328</name>
            <description>Template for Mikrotik CRS 328 switch</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template SNMP Mikrotik Global</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Fan Speed 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7001</snmp_oid>
                    <key>mikrotik.fan.speed.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7002</snmp_oid>
                    <key>mikrotik.fan.speed.2</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
        <template>
            <template>Template SNMP Mikrotik CRS 354</template>
            <name>Template Net Mikrotik CRS 354</name>
            <description>Template for Mikrotik CRS 354 switch</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template SNMP Mikrotik Global</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Board temperature 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7101</snmp_oid>
                    <key>mikrotik.board.temperature.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <value_type>FLOAT</value_type>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Board temperature 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7101</snmp_oid>
                    <key>mikrotik.board.temperature.2</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <value_type>FLOAT</value_type>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7001</snmp_oid>
                    <key>mikrotik.fan.speed.1</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7002</snmp_oid>
                    <key>mikrotik.fan.speed.2</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Fan Speed 3</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.100.1.3.7003</snmp_oid>
                    <key>mikrotik.fan.speed.3</key>
                    <delay>45s</delay>
                    <trends>1825d</trends>
                    <units>rpm</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
        <template>
            <template>Template SNMP Mikrotik Global</template>
            <name>Template Net Mikrotik common</name>
            <description>Template for Mikrotik common items</description>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Disk</name>
                </application>
                <application>
                    <name>Error</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Health</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>Packets</name>
                </application>
                <application>
                    <name>RouterOS</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Host status (old)</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},3,2000]</key>
                    <delay>30s</delay>
                    <history>24h</history>
                    <trends>1w</trends>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Network</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}=0</expression>
                            <name>{HOSTNAME} - Unavailable</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU frequency</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.14.0</snmp_oid>
                    <key>mikrotik.cpu.frequency</key>
                    <delay>600s</delay>
                    <history>14d</history>
                    <units>Hz</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1000000</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>CPU temperature</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.11.0</snmp_oid>
                    <key>mikrotik.cpu.temperature</key>
                    <delay>45s</delay>
                    <history>14d</history>
                    <trends>1825d</trends>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>DHCP leases</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.6.1.0</snmp_oid>
                    <key>mikrotik.dhcp.leases</key>
                    <delay>30m</delay>
                    <history>14d</history>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free disk space</name>
                    <type>CALCULATED</type>
                    <key>mikrotik.free.disk.memory</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <params>last(&quot;mikrotik.total.disk.space&quot;)-last(&quot;mikrotik.used.disk.space&quot;)</params>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free memory</name>
                    <type>CALCULATED</type>
                    <key>mikrotik.free.memory</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <params>last(&quot;mikrotik.total.memory&quot;)-last(&quot;mikrotik.used.memory&quot;)</params>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>mikrotik.identity.name</key>
                    <delay>600s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>PSU1 state</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.15.0</snmp_oid>
                    <key>mikrotik.psu1.state</key>
                    <delay>45s</delay>
                    <history>14d</history>
                    <trends>1825d</trends>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Network port admin status</name>
                    </valuemap>
                </item>
                <item>
                    <name>PSU2 state</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.16.0</snmp_oid>
                    <key>mikrotik.psu2.state</key>
                    <delay>45s</delay>
                    <history>14d</history>
                    <trends>1825d</trends>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Network port admin status</name>
                    </valuemap>
                </item>
                <item>
                    <name>RouterBoard serial number</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.7.3.0</snmp_oid>
                    <key>mikrotik.rb.serialnumber</key>
                    <delay>600s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>RouterOS: license level</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.4.3.0</snmp_oid>
                    <key>mikrotik.ros.license</key>
                    <delay>600s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>RouterOS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Software ID</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.4.1.0</snmp_oid>
                    <key>mikrotik.software.id</key>
                    <delay>600s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total disk space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.131073</snmp_oid>
                    <key>mikrotik.total.disk.space</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Total memory</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.65536</snmp_oid>
                    <key>mikrotik.total.memory</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>mikrotik.uptime</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Used disk space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.131073</snmp_oid>
                    <key>mikrotik.used.disk.space</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Used memory</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.65536</snmp_oid>
                    <key>mikrotik.used.memory</key>
                    <delay>300s</delay>
                    <history>14d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>RouterOS: version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>iso.3.6.1.2.1.47.1.1.1.1.2.65536</snmp_oid>
                    <key>mikrotik.version.and.hw</key>
                    <delay>600s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>RouterOS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total sector writes</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Sector writes since reboot</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;1&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Bad blocks</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;2&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>CPU load</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#HRPROCESSORLOAD},1.3.6.1.2.1.25.3.3.1.2]</snmp_oid>
                    <key>hrProcessorLoad</key>
                    <delay>3600s</delay>
                    <description>HOST-RESOURCES-MIB::hrProcessorLoad</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>CPU $1 load</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>hrProcessorLoad.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>CPU {#SNMPINDEX} load</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template SNMP Mikrotik Global</host>
                                        <key>hrProcessorLoad.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>ifDescovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>@Mikrotik_Ethernet</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>This discovery rule detects all interfaces at switch and collect the most general information about the interface &#13;
&#13;
{$SNMP_COMMUNITY_SECURE}, {$SNMP_PRIVATE_PASSWORD} is a global macro.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Admin status of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatus.[{#SNMPINDEX}]</key>
                            <delay>300s</delay>
                            <history>14d</history>
                            <description>The desired state of the interface.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>SNMP interface status (ifAdminStatus)</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Alias of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAlias.{#SNMPINDEX}</snmp_oid>
                            <key>ifAlias.[{#SNMPINDEX}]</key>
                            <delay>120</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Description of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>ifDescr.[{#SNMPINDEX}]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>A textual string containing information about the interface.  This string should include the name of the manufacturer, the product name and the version of the interface hardware/software.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total bytes in</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.31.{#SNMPINDEX}</snmp_oid>
                            <key>ifinBytes.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>B</units>
                            <description>Total bytes received on the interface&#13;
Количество байт получено данным интерфейсом.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscards.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Drop RX packets on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.14988.1.1.14.1.1.55.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDrops.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Колиичество отброшенных пакетов на интерфейсе&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Inbound errors on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrors.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Incoming traffic on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>ifInOctets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>bps</units>
                            <description>The number of octets in valid MAC frames received on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total packets in</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>ifinPackets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total packets received on the interface&#13;
Количество пакетов принятое этим интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: MTU on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.2.2.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>ifMtu.[{#SNMPINDEX}]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Operational status of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatus.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>The current operational state of the interface.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>SNMP interface status (ifOperStatus)</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <name>Operational status was changed on {HOST.NAME} interface {#IFDESCR}</name>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total bytes out</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.61.{#SNMPINDEX}</snmp_oid>
                            <key>ifoutBytes.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>B</units>
                            <description>Total bytes transmitted on the interface.&#13;
Всего байт передано с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscards.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Drop TX packets on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.14988.1.1.14.1.1.85.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDrops.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Колиичество отброшенных пакетов на интерфейсе&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outbound errors on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrors.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>For packet-oriented interfaces, the number of outbound packets that could not be transmitted because of errors. For character-oriented or fixed-length interfaces, the number of outbound transmission units that could not be transmitted because of errors.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outgoing traffic on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutOctets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>bps</units>
                            <description>The number of octets transmitted in MAC frames on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total packets out</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.11.{#SNMPINDEX}</snmp_oid>
                            <key>ifoutPackets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total packets transmitted from the interface.&#13;
Количество пакетов переданных с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Speed on interface (in megabits)</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}</snmp_oid>
                            <key>ifSpeed.[{#SNMPINDEX}]</key>
                            <delay>300s</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}&#13;
&#13;
1.3.6.1.2.1.31.1.1.1.15 - 64 bit&#13;
1.3.6.1.2.1.2.2.1.5 - 32 bit</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#IFDESCR}</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>00AA00</color>
                                    <item>
                                        <host>Template SNMP Mikrotik Global</host>
                                        <key>ifInOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>3333FF</color>
                                    <item>
                                        <host>Template SNMP Mikrotik Global</host>
                                        <key>ifOutOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template SNMP Mikrotik HAP</template>
            <name>Template Net Mikrotik HAP</name>
            <description>Template for Mikrotik HAP series</description>
            <templates>
                <template>
                    <name>Template SNMP Mikrotik Global</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Status of tunnel</name>
                    <type>EXTERNAL</type>
                    <key>getOIDscripts.sh[&quot;{HOST.IP}&quot;]</key>
                    <delay>30s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <description>State equal &quot;Empty string&quot; -  Timeout over 15 seconds. Probably SNMP unavailable&#13;
&#13;
State equal &quot;Established&quot; -  Tunnel is okay.&#13;
&#13;
State equal &quot;Not established&quot; - Tunnel is down</description>
                    <applications>
                        <application>
                            <name>Network</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>RouterOS: updates status</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>RouterOS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(New version is available,#1)}=1</expression>
                            <name>RouterOS: New Version Available on {HOST.IP}</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOSTNAME} - Unavailable</name>
                                    <expression>{Template SNMP Mikrotik HAP:icmpping[{HOST.IP},3,2000].last(0)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total sector writes</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Sector writes since reboot</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;1&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Bad blocks</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;2&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total CPU load (avg 5 min)</name>
                    <type>CALCULATED</type>
                    <key>total.cpu.load.avg5</key>
                    <history>14d</history>
                    <params>(avg(hrProcessorLoad.[1], 300s) + avg(hrProcessorLoad.[2], 300s) + avg(hrProcessorLoad.[3], 300s) + avg(hrProcessorLoad.[4], 300s))</params>
                    <description>Maximum - 400 (4 core x 100 % load)&#13;
Minimum - 0</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;280</expression>
                            <name>Total CPU load &gt; 70 (last 5 min)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Total CPU load &gt; 70 (last 10 min)</name>
                                    <expression>{Template SNMP Mikrotik HAP:total.cpu.load.avg10.last()}&gt;280</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total CPU load (avg 10 min)</name>
                    <type>CALCULATED</type>
                    <key>total.cpu.load.avg10</key>
                    <history>14d</history>
                    <params>(avg(hrProcessorLoad.[1], 600s) + avg(hrProcessorLoad.[2], 600s) + avg(hrProcessorLoad.[3], 600s) + avg(hrProcessorLoad.[4], 600s))</params>
                    <description>Maximum - 400 (4 core x 100 % load)&#13;
Minimum - 0</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;280</expression>
                            <name>Total CPU load &gt; 70 (last 10 min)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template SNMP Mikrotik HEX</template>
            <name>Template Net Mikrotik HEX</name>
            <description>Template for Mikrotik HEX series</description>
            <templates>
                <template>
                    <name>Template SNMP Mikrotik Global</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Status of tunnel</name>
                    <type>EXTERNAL</type>
                    <key>getOIDscripts.sh[&quot;{HOST.IP}&quot;]</key>
                    <delay>30s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <description>State equal &quot;Empty string&quot; -  Timeout over 15 seconds. Probably SNMP unavailable&#13;
&#13;
State equal &quot;Established&quot; -  Tunnel is okay.&#13;
&#13;
State equal &quot;Not established&quot; - Tunnel is down</description>
                    <applications>
                        <application>
                            <name>Network</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU Temperature</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.10.0</snmp_oid>
                    <key>mikrotik.temperature</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Voltage</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.8.0</snmp_oid>
                    <key>mikrotik.voltage</key>
                    <delay>0;900s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>V</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>RouterOS: updates status</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>RouterOS</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(New version is available,#1)}=1</expression>
                            <name>RouterOS: New Version Available on {HOST.IP}</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>{HOSTNAME} - Unavailable</name>
                                    <expression>{Template SNMP Mikrotik HEX:icmpping[{HOST.IP},3,2000].last(0)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total sector writes</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Sector writes since reboot</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;1&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Bad blocks</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;2&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;statusofhdd&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total CPU load (avg 5 min)</name>
                    <type>CALCULATED</type>
                    <key>total.cpu.load.avg5</key>
                    <history>14d</history>
                    <params>(avg(hrProcessorLoad.[1], 300s) + avg(hrProcessorLoad.[2], 300s) + avg(hrProcessorLoad.[3], 300s) + avg(hrProcessorLoad.[4], 300s))</params>
                    <description>Maximum - 400 (4 core x 100 % load)&#13;
Minimum - 0</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;280</expression>
                            <name>Total CPU load &gt; 50 (last 5 min)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Total CPU load &gt; 70 (last 10 min)</name>
                                    <expression>{Template SNMP Mikrotik HEX:total.cpu.load.avg10.last()}&gt;280</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total CPU load (avg 10 min)</name>
                    <type>CALCULATED</type>
                    <key>total.cpu.load.avg10</key>
                    <history>14d</history>
                    <params>(avg(hrProcessorLoad.[1], 600s) + avg(hrProcessorLoad.[2], 600s) + avg(hrProcessorLoad.[3], 600s) + avg(hrProcessorLoad.[4], 600s))</params>
                    <description>Maximum - 400 (4 core x 100 % load)&#13;
Minimum - 0</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;280</expression>
                            <name>Total CPU load &gt; 70 (last 10 min)</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template SNMP Mikrotik RB Office</template>
            <name>Template Net Mikrotik HEX Office</name>
            <description>Template for RB HEX gr3 or other RB</description>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Mikrotik</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Disk</name>
                </application>
                <application>
                    <name>Error</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Health</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>Packets</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Status of tunnel</name>
                    <type>EXTERNAL</type>
                    <key>getOIDscripts.sh[&quot;{HOST.IP}&quot;]</key>
                    <delay>30s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <description>State equal &quot;Empty string&quot; -  Timeout over 15 seconds. Probably SNMP unavailable&#13;
&#13;
State equal &quot;Established&quot; -  Tunnel is okay.&#13;
&#13;
State equal &quot;Not established&quot; - Tunnel is down</description>
                    <applications>
                        <application>
                            <name>Network</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU frequency</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.14.0</snmp_oid>
                    <key>mikrotik.cpu.frequency</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>Hz</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1000000</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>DHCP leases</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.6.1.0</snmp_oid>
                    <key>mikrotik.dhcp.leases</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>mikrotik.identity.name</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>RouterBoard serial number</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.7.3.0</snmp_oid>
                    <key>mikrotik.rb.serialnumber</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>RouterOS license level</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.4.3.0</snmp_oid>
                    <key>mikrotik.ros.license</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Software ID</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.4.1.0</snmp_oid>
                    <key>mikrotik.software.id</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Temperature</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.10.0</snmp_oid>
                    <key>mikrotik.temperature</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>°C</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Total disk space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.131073</snmp_oid>
                    <key>mikrotik.total.disk.space</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Disk</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Total memory</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.65536</snmp_oid>
                    <key>mikrotik.total.memory</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>mikrotik.uptime</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Used disk space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.131073</snmp_oid>
                    <key>mikrotik.used.disk.space</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Disk</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Used memory</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.65536</snmp_oid>
                    <key>mikrotik.used.memory</key>
                    <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System version and hw</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>iso.3.6.1.2.1.47.1.1.1.1.2.65536</snmp_oid>
                    <key>mikrotik.version.and.hw</key>
                    <delay>0;7200s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;14400s/6-7,06:00-24:00;14400s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Voltage</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.8.0</snmp_oid>
                    <key>mikrotik.voltage</key>
                    <delay>0;900s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>14d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>V</units>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.1</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Total sector writes</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Disk</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Sector writes since reboot</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;1&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Disk</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Bad blocks</name>
                    <type>EXTERNAL</type>
                    <key>runner_mikrotik_script.sh[&quot;--param&quot;,&quot;2&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;3&quot;]</key>
                    <delay>300s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Disk</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>CPU load</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#HRPROCESSORLOAD},1.3.6.1.2.1.25.3.3.1.2]</snmp_oid>
                    <key>hrProcessorLoad</key>
                    <delay>3600s</delay>
                    <description>HOST-RESOURCES-MIB::hrProcessorLoad&#13;
&#13;
{$SNMP_COMMUNITY} is a global macros</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>CPU $1 load</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>hrProcessorLoad.[{#SNMPINDEX}]</key>
                            <delay>0;180s/1-5,06:00-24:00;120s/1-5,00:00-03:00;360s/6-7,06:00-24:00;60s/6-7,00:00-03:00</delay>
                            <history>14d</history>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>ifDescovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>@Mikrotik_Ethernet</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFTYPEIFACE}</macro>
                                <value>6</value>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs.&#13;
&#13;
{$SNMP_COMMUNITY} is a global macro.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Admin status of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatus.[{#SNMPINDEX}]</key>
                            <delay>0;600s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;1800s/6-7,06:00-24:00;600s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <description>The desired state of the interface.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>SNMP interface status (ifAdminStatus)</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Alias of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAlias.{#SNMPINDEX}</snmp_oid>
                            <key>ifAlias.[{#SNMPINDEX}]</key>
                            <delay>120</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Description of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>ifDescr.[{#SNMPINDEX}]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <value_type>CHAR</value_type>
                            <description>A textual string containing information about the interface.  This string should include the name of the manufacturer, the product name and the version of the interface hardware/software.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total bytes in</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.31.{#SNMPINDEX}</snmp_oid>
                            <key>ifinBytes.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <units>B</units>
                            <description>Total bytes received on the interface&#13;
Количество байт получено данным интерфейсом.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscards.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Inbound errors on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrors.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Incoming traffic on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>ifInOctets.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <units>bps</units>
                            <description>The number of octets in valid MAC frames received on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total packets in</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.32.{#SNMPINDEX}</snmp_oid>
                            <key>ifinPackets.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <description>Total packets received on the interface&#13;
Количество пакетов принятое этим интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: MTU on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.2.2.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>ifMtu.[{#SNMPINDEX}]</key>
                            <delay>0;3600s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>type was char&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Operational status of interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatus.[{#SNMPINDEX}]</key>
                            <delay>0;600s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;1800s/6-7,06:00-24:00;600s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <description>The current operational state of the interface.&#13;
Display of availability &quot;links&quot; on the interface&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>SNMP interface status (ifOperStatus)</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <name>Operational status was changed on {HOST.NAME} interface {#IFDESCR}</name>
                                    <priority>INFO</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                                            <expression>{Template SNMP Mikrotik RB Office:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total bytes out</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.61.{#SNMPINDEX}</snmp_oid>
                            <key>ifoutBytes.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <units>B</units>
                            <description>Total bytes transmitted on the interface.&#13;
Всего байт передано с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscards.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outbound errors on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrors.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>For packet-oriented interfaces, the number of outbound packets that could not be transmitted because of errors. For character-oriented or fixed-length interfaces, the number of outbound transmission units that could not be transmitted because of errors.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Outgoing traffic on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutOctets.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;900s/1-5,00:00-03:00;3600s/6-7,06:00-24:00;450s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <units>bps</units>
                            <description>The number of octets transmitted in MAC frames on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Total packets out</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.14988.1.1.14.1.1.62.{#SNMPINDEX}</snmp_oid>
                            <key>ifoutPackets.[{#SNMPINDEX}]</key>
                            <delay>0;1800s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>7d</history>
                            <trends>45d</trends>
                            <description>Total packets transmitted from the interface.&#13;
Количество пакетов переданных с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#IFDESCR}: Speed on interface</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>ifSpeed.[{#SNMPINDEX}]</key>
                            <delay>0;3600s/1-5,06:00-24:00;7200s/1-5,00:00-03:00;7200s/6-7,06:00-24:00;7200s/6-7,00:00-03:00</delay>
                            <history>3d</history>
                            <trends>45d</trends>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#IFDESCR}</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>00AA00</color>
                                    <item>
                                        <host>Template SNMP Mikrotik RB Office</host>
                                        <key>ifInOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>3333FF</color>
                                    <item>
                                        <host>Template SNMP Mikrotik RB Office</host>
                                        <key>ifOutOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template SNMP NetPing</template>
            <name>Template SNMP NetPing</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Temperature</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Temperature of the first port</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.25728.8800.1.1.2.1</snmp_oid>
                    <key>SWITCH_1</key>
                    <delay>120s</delay>
                    <history>3d</history>
                    <trends>30d</trends>
                    <units>Celcius</units>
                    <applications>
                        <application>
                            <name>Temperature</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;24 and&#13;
{last()}&lt;=26</expression>
                            <name>Высокая температура {HOSTNAME}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Высокая температура в серверной</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Высокая температура {HOSTNAME}</name>
                                    <expression>{Template SNMP NetPing:SWITCH_1.last()}&gt;26 and&#13;
{Template SNMP NetPing:SWITCH_1.last()}&lt;30</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;26 and&#13;
{last()}&lt;30</expression>
                            <name>Высокая температура {HOSTNAME}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <description>Высокая температура в серверной</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Критическая температура {HOSTNAME}</name>
                                    <expression>{Template SNMP NetPing:SWITCH_1.last()}&gt;=30</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;=30</expression>
                            <name>Критическая температура {HOSTNAME}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Temperature of the third port</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.25728.8800.1.1.2.3</snmp_oid>
                    <key>SWITCH_3</key>
                    <delay>120s</delay>
                    <history>3d</history>
                    <trends>30d</trends>
                    <status>DISABLED</status>
                    <units>Celcius</units>
                    <applications>
                        <application>
                            <name>Temperature</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template terminal</template>
            <name>Template terminal</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>dms_num</name>
                    <key>proc.num[&quot;dms.exe&quot;]</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Количество активный пользователей (RDP)</name>
                    <key>rdp_user_active</key>
                    <delay>0;180s/1-7,09:00-21:00;720s/1-7,21:00-23:59;720s/1-7,00:01-08:59</delay>
                    <history>30d</history>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Backups</template>
            <name>Template_Backups</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Backups_list</name>
                    <key>system.run[find /backups/ -name $(date +%\F)* -type f -mtime -1 -size +500k]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;-solvo&quot;)}=0 or {str(&quot;-otrs&quot;)}=0 or {str(&quot;-gkArcade&quot;)}=0 or {str(&quot;-RK7&quot;)}=0 or {str(&quot;-repositories&quot;)}=0 or {str(&quot;-Att2003&quot;)}=0 or {str(&quot;-template&quot;)}=0 or {str(&quot;-mediawiki&quot;)}=0 or {str(&quot;-asterisk&quot;)}=0 or {str(&quot;-base.succuba&quot;)}=0 or {str(&quot;-nalog&quot;)}=0 or {str(&quot;-dms&quot;)}=0</expression>
                            <name>Backups warning</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Backups_list_1C</name>
                    <key>system.run[find /backups/1c/sql/ -name &quot;*&quot; -not -path &quot;/backups/1c/sql/arch_*&quot;  -type f -mtime -1 -size +5M]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;buh_activ-&quot;)}=0 or&#13;
{str(&quot;buh_germes-&quot;)}=0 or&#13;
{str(&quot;buh_odissey-&quot;)}=0  or&#13;
{str(&quot;buh_parus-&quot;)}=0 or&#13;
{str(&quot;buh_perekr-&quot;)}=0 or&#13;
{str(&quot;buh_sokolov-&quot;)}=0 or&#13;
{str(&quot;buh_sud-&quot;)}=0 or&#13;
{str(&quot;buh_uliss-&quot;)}=0 or&#13;
{str(&quot;buh_vahr-&quot;)}=0</expression>
                            <name>Backups warning 1C buh_</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>{str(&quot;hrm_hermes-&quot;)}=0 or&#13;
{str(&quot;hrm_mens-&quot;)}=0 or&#13;
{str(&quot;hrm_metro-&quot;)}=0 or&#13;
{str(&quot;hrm_pazd-&quot;)}=0 or&#13;
{str(&quot;hrm_perekr-&quot;)}=0 or&#13;
{str(&quot;hrm_sl_vad-&quot;)}=0 or&#13;
{str(&quot;hrm_sl_vas-&quot;)}=0 or&#13;
{str(&quot;hrm_vahr-&quot;)}=0</expression>
                            <name>Backups warning 1C hrm_</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>{str(&quot;cons-&quot;)}=0 or&#13;
{str(&quot;metro-alco-&quot;)}=0 or&#13;
{str(&quot;metro-&quot;)}=0 or&#13;
{str(&quot;utap_activ-&quot;)}=0 or&#13;
{str(&quot;utap_parus-&quot;)}=0 or&#13;
{str(&quot;utap_sokolov-&quot;)}=0</expression>
                            <name>Backups warning 1C other</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Camera</template>
            <name>Template_Camera</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Статус камеры</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP}]</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>180d</trends>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{max(#5)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0&#13;
and &#13;
{sum(6h)}&lt;&gt;0</recovery_expression>
                            <name>Камера {HOSTNAME} - недоступна</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Камера {HOSTNAME} - недоступна более 2 часов</name>
                                    <expression>{Template_Camera:icmpping[{HOST.IP}].max(7200s)}=0</expression>
                                    <recovery_expression>{Template_Camera:icmpping[{HOST.IP}].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(7200s)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Камера {HOSTNAME} - недоступна более 2 часов</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_DiskDrive_SMARTMONTOOLS_LLD</template>
            <name>Template_DiskDrive_SMARTMONTOOLS_LLD</name>
            <description>https://github.com/v-zhuravlev/zbx-smartctl&#13;
3.4 version with dependent items. Please check your UserParameters.&#13;
Template version: v1.5</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Drive</name>
                </application>
                <application>
                    <name>SMART monitoring (smartctl)</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>smartctl-disks-discovery (HDD)</name>
                    <key>uHDD.discovery[&quot;{$SMARTCTL_STATIC_DISKS}&quot;]</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SMART_ENABLED}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DISKTYPE}</macro>
                                <value>0</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>SMARTCTL_STATIC_DISKS - add additional disks in this macro with -d option. Replace all spaces with '_' inside each disk command. Separate multiple disks with space. &#13;
For example, to discover 2 drives behind hardware RAID, set this macro on the host level:&#13;
&#13;
SMARTCTL_STATIC_DISKS = /dev/sda_-d_sat+megaraid,00 /dev/sda_-d_sat+megaraid,01&#13;
&#13;
Useful for disks that cannot be easily discovered such as disks hidden behind RAID or when agent is installed on Windows or Mac where automatic discovery is not so powerful. &#13;
&#13;
Setting this macro doesn't prevent any automatic attempts to discover disks using smartctl --scan-open and so on.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#DISKNAME}: Capacity</name>
                            <type>DEPENDENT</type>
                            <key>uHDD.capacity[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var p1 = /(|User\s)Capacity:\s{1,}.{1,}]/g;

var cap1 = value.match(p1) !== null ? value.match(p1)[0] : &quot;&quot;;

if (cap1.length == 0) {return &quot;Error in variable 'cap1'&quot;}

var cap2 = cap1.search(/\[(\d{1,}\,\d{1,}|\d{1,})\s\w\w\]/g);
var cap3 = cap1.slice(cap2, cap1.length).trim();
var cap4 = cap3.search(/\s{1,}\w\w\]/g) != null ? cap3.search(/\s{1,}\w\w\]/g) : &quot;&quot;;

if (cap4 == &quot;&quot;) {return &quot;Error in variable 'cap4'&quot;}
// cap5 - number. Example 128, 256, 512 and any other number that the size of the drive
var cap5 = cap3.slice(0+1, cap4).trim();
// cap6 - prefix. Example MB, GB, TB
var cap6 = cap3.slice(cap4, cap3.length-1).trim();

if (cap5.indexOf(&quot;,&quot;) &gt; -1) {
  cap5 = cap5.replace(&quot;,&quot;, &quot;.&quot;)
}

var capacity = &quot;&quot;;
if (cap6 === &quot;MB&quot;) {
  const capMB = parseInt(cap5)*10**6
  capacity += capMB
  return capacity
} else if (cap6 === &quot;GB&quot;) {
  const capGB = parseInt(cap5)*10**9
  capacity += capGB
  return capacity
} else if (cap6 === &quot;TB&quot;) {
  const capTB = parseInt(cap5)*10**12
  capacity += capTB
  return capacity
} else if (cap6 === &quot;PB&quot;) {
  const capPB = parseInt(cap5)*10**15
  capacity += capPB
  return capacity
} else {return &quot;Unknown prefix&quot;}</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: smartctl</name>
                            <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{str(&quot;FAILING_NOW&quot;)}=1</expression>
                                    <name>{#DISKNAME}: one or more SMART attributes are FAILING_NOW</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Check test result output for details.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{nodata(30m)}=1&#13;
or &#13;
{regexp(&quot;: \smartmontools\bin\smartctl.exe&quot;)}=1</expression>
                                    <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Test result</name>
                            <type>DEPENDENT</type>
                            <key>uHDD.health[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:SMART overall-health self-assessment test result:|SMART Health Status:) +\b([\S ]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                    <name>{#DISKNAME}: SMART status is not OK</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or &#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;: \smartmontools\bin\smartctl.exe&quot;)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{str(&quot;FAILED!&quot;)}=1</expression>
                                    <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Device model</name>
                            <type>DEPENDENT</type>
                            <key>uHDD.model.[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:Vendor: +(.+)\nProduct:|[Dd]evice [Mm]odel:|[Mm]odel [Nn]umber:) +(.+)
\1 \2</params>
                                </step>
                                <step>
                                    <type>LTRIM</type>
                                    <params><![CDATA[ ]]></params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Serial number</name>
                            <type>DEPENDENT</type>
                            <key>uHDD.sn.[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>[Ss]erial [Nn]umber: +(.+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1  and {strlen()}&gt;0</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>{#DISKNAME}: Disk has been replaced (new serial number received)</name>
                                    <priority>INFO</priority>
                                    <description>Last value: {ITEM.LASTVALUE1}.&#13;
Device serial number has changed. Ack to close</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or &#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;: \smartmontools\bin\smartctl.exe&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 5 Reallocated sectors count</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,5 Reallocated]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>Count of reallocated sectors. The raw value represents a count of the bad sectors that have been found and remapped.Thus, the higher the attribute value, the more sectors the drive has had to reallocate. This value is primarily used as a metric of the life expectancy of the drive; a drive which has had any reallocations at all is significantly more likely to fail in the immediate months.&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes &#13;&#13;
For SATA disks, mapped to 'ID 5 Reallocated Sectors Count'&#13;
For Kingston disks, mapped to 'ID 5 Retired Block Count'&#13;
For SAS disks, number of 'Elements in grown defect list' is used.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:5 Reallocate.+|5 Retired_Block_Count.+|Elements in grown defect list:)(?:[\t ]+)([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{delta(7d)}&gt;0&#13;
and &#13;
{sum(3)}&gt;0</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{sum(3)}=0</recovery_expression>
                                    <name>{#DISKNAME}: SMART Reallocated Sectors Count has been registered</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Count of reallocated sectors. The raw value represents a count of the bad sectors that have been found and remapped.Thus, the higher the attribute value, the more sectors the drive has had to reallocate. This value is primarily used as a metric of the life expectancy of the drive; a drive which has had any reallocations at all is significantly more likely to fail in the immediate months.&#13;
&#13;
Trigger: Timeouts in 7 days if there are no new reallocated sectors.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 197 Current pending sector count</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,Current_Pending_Sector]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>SATA: ID 197 Current Pending Sector Count. Count of &quot;unstable&quot; sectors (waiting to be remapped, because of unrecoverable read errors). If an unstable sector is subsequently read successfully, the sector is remapped and this value is decreased. Read errors on a sector will not remap the sector immediately (since the correct value cannot be read and so the value to remap is not known, and also it might become readable later); instead, the drive firmware remembers that the sector needs to be remapped, and will remap it the next time it's written.&#13;
However, some drives will not immediately remap such sectors when written; instead the drive will first attempt to write to the problem sector and if the write operation is successful then the sector will be marked good (in this case, the &quot;Reallocation Event Count&quot; (0xC4) will not be increased). This is a serious shortcoming, for if such a drive contains marginal sectors that consistently fail only after some time has passed following a successful write operation, then the drive will never remap these problem sectors.&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes
SAS: Not supported.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>197 Current_Pending_Sector.+ ([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{delta(3d)}&gt;0</expression>
                                    <name>{#DISKNAME}: SMART Current Pending Sector counter incremented</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>WARNING</priority>
                                    <description>Count of &quot;unstable&quot; sectors (waiting to be remapped, because of unrecoverable read errors). If an unstable sector is subsequently read successfully, the sector is remapped and this value is decreased. Read errors on a sector will not remap the sector immediately (since the correct value cannot be read and so the value to remap is not known, and also it might become readable later); instead, the drive firmware remembers that the sector needs to be remapped, and will remap it the next time it's written.&#13;
However, some drives will not immediately remap such sectors when written; instead the drive will first attempt to write to the problem sector and if the write operation is successful then the sector will be marked good (in this case, the &quot;Reallocation Event Count&quot; (0xC4) will not be increased). This is a serious shortcoming, for if such a drive contains marginal sectors that consistently fail only after some time has passed following a successful write operation, then the drive will never remap these problem sectors.&#13;
&#13;
Triiger: Timeouts in 3 days if ther are no new sectors</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or &#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;: \smartmontools\bin\smartctl.exe&quot;)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART Reallocated Sectors Count has been registered</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,5 Reallocated].delta(7d)}&gt;0&#13;
and &#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,5 Reallocated].sum(3)}&gt;0</expression>
                                            <recovery_expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,5 Reallocated].sum(3)}=0</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 198 Uncorrectable errors count</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,Offline_Uncorrectable]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>SATA: ID 198 (Offline) Uncorrectable Sector Count. The total count of uncorrectable errors when reading/writing a sector. A rise in the value of this attribute indicates defects of the disk surface and/or problems in the mechanical subsystem.&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes
SAS: error counter log should be parsed with JS in Zabbix 4.2: read+write
&quot;Error counter log
           Errors Corrected by           Total   Correction     Gigabytes    Total
               ECC          rereads/    errors   algorithm      processed    uncorrected
           fast | delayed   rewrites  corrected  invocations   [10^9 bytes]  errors
read:    2242530    24029   1718309   2266559      30372     409777.659           0
write:   1685701     2629      5464   1688330       2636      35228.365           0
verify:     4400        2         2      4402          2        432.531           0&quot;. Should be added to SSD as well.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>Offline_Uncorrectable.+ ([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{delta(7d)}&gt;0</expression>
                                    <name>{#DISKNAME}: SMART (Offline) Uncorrectable Sector Count has been registered</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>The total count of uncorrectable errors when reading/writing a sector. A rise in the value of this attribute indicates defects of the disk surface and/or problems in the mechanical subsystem.&#13;
&#13;
Trigger: Timeouts in 7 days if there are no new reallocated sectors.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 9 Power on hours</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,Power_On]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <units>s</units>
                            <description>Count of hours in power-on state. The raw value of this attribute shows total count of hours (or minutes, or seconds, depending on manufacturer) in power-on state.&#13;
&quot;By default, the total expected lifetime of a hard disk in perfect condition is defined as 5 years (running every day and night on all days). This is equal to 1825 days in 24/7 mode or 43800 hours.&quot;&#13;
&#13;
On some pre-2005 drives, this raw value may advance erratically and/or &quot;wrap around&quot; (reset to zero periodically).&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:Power_On_Hours.+ |Accumulated power on time, hours:minutes |Power On Hours:.+ )([0-9]+)
\1</params>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>3600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 10 Spin retry count</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,Spin_Retry_Count]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>SATA: ID 10 Spin_Retry_Count. Count of retry of spin start attempts. This attribute stores a total count of the spin start attempts to reach the fully operational speed (under the condition that the first attempt was unsuccessful). An increase of this attribute value is a sign of problems in the hard disk mechanical subsystem.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>10 Spin_Retry_Count.+ ([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{delta(7d)}&gt;0</expression>
                                    <name>{#DISKNAME}: SMART Spin Retry Count has been registered</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <url>https://kb.acronis.com/content/9110</url>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Spin retry event is logged each time the drive was unable to spin its platters up to the rated rotation speed in the due time. Spin-up attempt was aborted and retried. This typically indicates severe controller or bearing problem, but may be sometimes caused by power supply problems.&#13;
Trigger: Timeouts in 7 days if there are no spin retry events.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 190/194 Temperature</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,Temperature_Celsius]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>90d</trends>
                            <units>°C</units>
                            <description>Current drive temperature.
SATA: Parses value from attribute ID 194 or ID 190.
SAS: Supported
NVMe: Supported</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:194 Temperature[^(\n]+|Airflow_Temperature[^(\n]+|Drive Temperature:|Temperature:) +([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(5m)}&gt;{$TEMP_CRIT:&quot;HDD&quot;} and&#13;
{last()}&lt;100</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(5m)}&lt;{$TEMP_CRIT:&quot;HDD&quot;}-3</recovery_expression>
                                    <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{avg(5m)}&gt;{$TEMP_WARN:&quot;HDD&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(5m)}&lt;{$TEMP_WARN:&quot;HDD&quot;}-3</recovery_expression>
                                    <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].avg(5m)}&gt;{$TEMP_CRIT:&quot;HDD&quot;} and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].last()}&lt;100</expression>
                                            <recovery_expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].avg(5m)}&lt;{$TEMP_CRIT:&quot;HDD&quot;}-3</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or &#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uHDD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;: \smartmontools\bin\smartctl.exe&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 199 CRC error count</name>
                            <type>DEPENDENT</type>
                            <key>uHDD[&quot;{#DISKCMD}&quot;,UDMA_CRC_Error]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>SATA: ID 199 CRC Error Count. The count of errors in data transfer via the interface cable as determined by ICRC (Interface Cyclic Redundancy Check).
SAS: mapped to 'Non-medium error count'
NVMe: mapped to 'Media and Data Integrity Errors'</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:UDMA_CRC_Error|CRC_Error_Count|Non-medium error count:|Media and Data Integrity Errors:).+ ([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uHDD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100 and {delta(1d)}&gt;0</expression>
                                    <name>{#DISKNAME}: SMART UltraDMA CRC Error Count too high: {ITEM.LASTVALUE}. Check cable!</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <url>http://www.z-a-recovery.com/man-smart.htm</url>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Low value of this attribute typically indicates that something is wrong with the connectors and/or cables. Disk-to-host transfers are protected by CRC error detection code when Ultra-DMA 66 or 100 is used. So if the data gets garbled between the disk and the host machine, the receiving controller senses this and the retransmission is initiated. Such a situation is called &quot;UDMA CRC error&quot;. Once the problem is rectified (typically by replacing a cable), the attribute value returns to the normal levels pretty quick.&#13;
&#13;
Triger: Timeouts in 1 day if there are no new errors.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>smartctl-disks-discovery (SSD)</name>
                    <key>uSSD.discovery[&quot;{$SMARTCTL_STATIC_DISKS}&quot;]</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SMART_ENABLED}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DISKTYPE}</macro>
                                <value>1</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>SMARTCTL_STATIC_DISKS - add additional disks in this macro with -d option. Replace all spaces with '_' inside each disk command. Separate multiple disks with space. &#13;
For example, to discover 2 drives behind hardware RAID, set this macro on the host level:&#13;
&#13;
SMARTCTL_STATIC_DISKS = /dev/sda_-d_sat+megaraid,00 /dev/sda_-d_sat+megaraid,01&#13;
&#13;
Useful for disks that cannot be easily discovered such as disks hidden behind RAID or when agent is installed on Windows or Mac where automatic discovery is not so powerful. &#13;
&#13;
Setting this macro doesn't prevent any automatic attempts to discover disks using smartctl --scan-open and so on.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#DISKNAME}: Capacity</name>
                            <type>DEPENDENT</type>
                            <key>uSSD.capacity[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var p1 = /(|User\s)Capacity:\s{1,}.{1,}]/g;

var cap1 = value.match(p1) !== null ? value.match(p1)[0] : &quot;&quot;;

if (cap1.length == 0) {return &quot;Error in variable 'cap1'&quot;}

var cap2 = cap1.search(/\[(\d{1,}\,\d{1,}|\d{1,})\s\w\w\]/g);
var cap3 = cap1.slice(cap2, cap1.length).trim();
var cap4 = cap3.search(/\s{1,}\w\w\]/g) != null ? cap3.search(/\s{1,}\w\w\]/g) : &quot;&quot;;

if (cap4 == &quot;&quot;) {return &quot;Error in variable 'cap4'&quot;}
// cap5 - number. Example 128, 256, 512 and any other number that the size of the drive
var cap5 = cap3.slice(0+1, cap4).trim();
// cap6 - prefix. Example MB, GB, TB
var cap6 = cap3.slice(cap4, cap3.length-1).trim();

if (cap5.indexOf(&quot;,&quot;) &gt; -1) {
  cap5 = cap5.replace(&quot;,&quot;, &quot;.&quot;)
}

var capacity = &quot;&quot;;
if (cap6 === &quot;MB&quot;) {
  const capMB = parseInt(cap5)*10**6
  capacity += capMB
  return capacity
} else if (cap6 === &quot;GB&quot;) {
  const capGB = parseInt(cap5)*10**9
  capacity += capGB
  return capacity
} else if (cap6 === &quot;TB&quot;) {
  const capTB = parseInt(cap5)*10**12
  capacity += capTB
  return capacity
} else if (cap6 === &quot;PB&quot;) {
  const capPB = parseInt(cap5)*10**15
  capacity += capPB
  return capacity
} else {return &quot;Unknown prefix&quot;}</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: smartctl</name>
                            <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{str(&quot;FAILING_NOW&quot;)}=1</expression>
                                    <name>{#DISKNAME}: one or more SMART attributes are FAILING_NOW</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Check test result output for details.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{nodata(30m)}=1&#13;
or&#13;
{regexp(&quot;:\smartmontools\bin\smartctl.exe\&quot;&quot;)}=1</expression>
                                    <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Test result</name>
                            <type>DEPENDENT</type>
                            <key>uSSD.health[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:SMART overall-health self-assessment test result:|SMART Health Status:) +\b([\S ]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                    <name>{#DISKNAME}: SMART status is not OK</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;:\smartmontools\bin\smartctl.exe\&quot;&quot;)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{str(&quot;FAILED!&quot;)}=1</expression>
                                    <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Device model</name>
                            <type>DEPENDENT</type>
                            <key>uSSD.model.[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:Vendor: +(.+)\nProduct:|[Dd]evice [Mm]odel:|[Mm]odel [Nn]umber:) +(.+)
\1 \2</params>
                                </step>
                                <step>
                                    <type>LTRIM</type>
                                    <params><![CDATA[ ]]></params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: Serial number</name>
                            <type>DEPENDENT</type>
                            <key>uSSD.sn.[&quot;{#DISKCMD}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>[Ss]erial [Nn]umber: +(.+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1  and {strlen()}&gt;0</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>{#DISKNAME}: Disk has been replaced (new serial number received)</name>
                                    <priority>INFO</priority>
                                    <description>Last value: {ITEM.LASTVALUE1}.&#13;
Device serial number has changed. Ack to close</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;:\smartmontools\bin\smartctl.exe\&quot;&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 5 Reallocated sectors count</name>
                            <type>DEPENDENT</type>
                            <key>uSSD[&quot;{#DISKCMD}&quot;,5 Reallocated]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>Count of reallocated sectors. The raw value represents a count of the bad sectors that have been found and remapped.Thus, the higher the attribute value, the more sectors the drive has had to reallocate. This value is primarily used as a metric of the life expectancy of the drive; a drive which has had any reallocations at all is significantly more likely to fail in the immediate months.&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes &#13;
&#13;
For SATA disks, mapped to 'ID 5 Reallocated Sectors Count'&#13;
For Kingston disks, mapped to 'ID 5 Retired Block Count'&#13;
For SAS disks, number of 'Elements in grown defect list' is used.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:5 Reallocate.+|5 Retired_Block_Count.+|Elements in grown defect list:)(?:[\t ]+)([0-9]+)
\1</params>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>0</error_handler_params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{delta(7d)}&gt;0&#13;
and &#13;
{sum(#3)}&gt;0</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{sum(#3)}=0</recovery_expression>
                                    <name>{#DISKNAME}: SMART Reallocated Sectors Count has been registered</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Count of reallocated sectors. The raw value represents a count of the bad sectors that have been found and remapped.Thus, the higher the attribute value, the more sectors the drive has had to reallocate. This value is primarily used as a metric of the life expectancy of the drive; a drive which has had any reallocations at all is significantly more likely to fail in the immediate months.&#13;
&#13;
Trigger: Timeouts in 7 days if there are no new reallocated sectors.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART status is not OK</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SATA&quot;},ne)}=1 and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].count(#1,{$SMARTCTL_OK_STATUS:&quot;SAS&quot;},ne)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SMART test status: FAILED!</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.health[&quot;{#DISKCMD}&quot;].str(&quot;FAILED!&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 9 Power on hours</name>
                            <type>DEPENDENT</type>
                            <key>uSSD[&quot;{#DISKCMD}&quot;,Power_On]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <units>s</units>
                            <description>Count of hours in power-on state. The raw value of this attribute shows total count of hours (or minutes, or seconds, depending on manufacturer) in power-on state.&#13;
&quot;By default, the total expected lifetime of a hard disk in perfect condition is defined as 5 years (running every day and night on all days). This is equal to 1825 days in 24/7 mode or 43800 hours.&quot;&#13;
&#13;
On some pre-2005 drives, this raw value may advance erratically and/or &quot;wrap around&quot; (reset to zero periodically).&#13;
https://en.wikipedia.org/wiki/S.M.A.R.T.#Known_ATA_S.M.A.R.T._attributes</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:Power_On_Hours.+ |Accumulated power on time, hours:minutes |Power On Hours:.+ )([0-9]+)
\1</params>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>3600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 177/202/233 SSD wearout</name>
                            <type>DEPENDENT</type>
                            <key>uSSD[&quot;{#DISKCMD}&quot;,SSD wearout]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>%</units>
                            <description>SATA: Multiple IDs are used, depending on the vendor: 177 Wear Leveling Count:&#13;
&quot;The Wear Leveling Count (WLC) SMART value gives us all the data we need. The current value stands for the remaining endurance of the drive in percentage, meaning that it starts from 100 and decreases linearly as the drive is written to. The raw WLC value counts the consumed P/E cycles, so if these two values are monitored while writing to the drive, sooner than later we will find the spot where the normalized value drops by one.&quot;&#13;
http://www.anandtech.com/show/8239/update-on-samsung-850-pro-endurance-vnand-die-size&#13;
&#13;
Number of erase/program cycles per block on average. This attribute is intended to be an indicator of imminent wear-out. Normalized Equation: 100 – ( 100 * Average Erase Count / NAND max rated number of erase cycles)&#13;
&#13;
233 Media Wearout Indicator:&#13;
Intel SSDs report a normalized value from 100, a new drive, to a minimum of 1. It decreases while the NAND erase cycles increase from 0 to the maximum-rated cycles.&#13;
202 Percent_Lifetime_Used:&#13;
A value of 0% indicates that 100% of the expected lifetime has been used.
SAS: 'Percentage used endurance indicator:' can be used, but it must inversed: 100%-used first. For that Zabbix 4.2 preprocessing is required.
NVMe: 'Available Spare:' value is used, where 100% idicated new drive and 0% indicates that 100% of the expected lifetime has been used.</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:(?:177 Wear_Leveling_Count|202 Percent_Lifetime_Used|202 Percent_Lifetime_Remain|230 Media_Wearout_Indicator|233 Media_Wearout_Indicator|231 SSD_Life_Left) +0x[0-9a-z]+|Available Spare:) +([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;5</expression>
                                    <name>{#DISKNAME}: SSD wearout (&lt;5% left)</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;10</expression>
                                    <name>{#DISKNAME}: SSD wearout (&lt;10% left)</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;:\smartmontools\bin\smartctl.exe\&quot;&quot;)}=1</expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: SSD wearout (&lt;5% left)</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD[&quot;{#DISKCMD}&quot;,SSD wearout].last()}&lt;5</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 190/194 Temperature</name>
                            <type>DEPENDENT</type>
                            <key>uSSD[&quot;{#DISKCMD}&quot;,Temperature_Celsius]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>90d</trends>
                            <units>°C</units>
                            <description>Current drive temperature.
SATA: Parses value from attribute ID 194 or ID 190.
SAS: Supported
NVMe: Supported</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:194 Temperature[^(\n]+|Airflow_Temperature[^(\n]+|Drive Temperature:|Temperature:) +([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(5m)}&gt;{$TEMP_CRIT:&quot;HDD&quot;} and&#13;
{last()}&lt;100</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(5m)}&lt;{$TEMP_CRIT:&quot;HDD&quot;}-3</recovery_expression>
                                    <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{avg(5m)}&gt;{$TEMP_WARN:&quot;HDD&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(5m)}&lt;{$TEMP_WARN:&quot;HDD&quot;}-3</recovery_expression>
                                    <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>{#DISKNAME}: Disk temperature: {ITEM.LASTVALUE}</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].avg(5m)}&gt;{$TEMP_CRIT:&quot;HDD&quot;} and&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].last()}&lt;100</expression>
                                            <recovery_expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD[&quot;{#DISKCMD}&quot;,Temperature_Celsius].avg(5m)}&lt;{$TEMP_CRIT:&quot;HDD&quot;}-3</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>{#DISKNAME}: S.M.A.R.T no data 30 minutes</name>
                                            <expression>{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].nodata(30m)}=1&#13;
or&#13;
{Template_DiskDrive_SMARTMONTOOLS_LLD:uSSD.get[&quot;{#DISKCMD}&quot;].regexp(&quot;:\smartmontools\bin\smartctl.exe\&quot;&quot;)}=1</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#DISKNAME}: ID 199 CRC error count</name>
                            <type>DEPENDENT</type>
                            <key>uSSD[&quot;{#DISKCMD}&quot;,UDMA_CRC_Error]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <description>SATA: ID 199 CRC Error Count. The count of errors in data transfer via the interface cable as determined by ICRC (Interface Cyclic Redundancy Check).
SAS: mapped to 'Non-medium error count'
NVMe: mapped to 'Media and Data Integrity Errors'</description>
                            <applications>
                                <application>
                                    <name>SMART monitoring (smartctl)</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>REGEX</type>
                                    <params>(?:UDMA_CRC_Error|CRC_Error_Count|Non-medium error count:|Media and Data Integrity Errors:).+ ([0-9]+)
\1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>uSSD.get[&quot;{#DISKCMD}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100 and {delta(1d)}&gt;0</expression>
                                    <name>{#DISKNAME}: SMART UltraDMA CRC Error Count too high: {ITEM.LASTVALUE}. Check cable!</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <url>http://www.z-a-recovery.com/man-smart.htm</url>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Low value of this attribute typically indicates that something is wrong with the connectors and/or cables. Disk-to-host transfers are protected by CRC error detection code when Ultra-DMA 66 or 100 is used. So if the data gets garbled between the disk and the host machine, the receiving controller senses this and the retransmission is initiated. Such a situation is called &quot;UDMA CRC error&quot;. Once the problem is rectified (typically by replacing a cable), the attribute value returns to the normal levels pretty quick.&#13;
&#13;
Triger: Timeouts in 1 day if there are no new errors.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$SMARTCTL_OK_STATUS:&quot;SAS&quot;}</macro>
                    <value>OK</value>
                </macro>
                <macro>
                    <macro>{$SMARTCTL_OK_STATUS:&quot;SATA&quot;}</macro>
                    <value>PASSED</value>
                </macro>
                <macro>
                    <macro>{$SMARTCTL_STATIC_DISKS}</macro>
                </macro>
                <macro>
                    <macro>{$TEMP_CRIT:&quot;HDD&quot;}</macro>
                    <value>65</value>
                </macro>
                <macro>
                    <macro>{$TEMP_WARN:&quot;HDD&quot;}</macro>
                    <value>50</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template_EGAIS</template>
            <name>Template_EGAIS</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>EGAIS</name>
                </application>
                <application>
                    <name>UTM</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Сертификат ГОСТ (осталось часов)</name>
                    <type>EXTERNAL</type>
                    <key>convUTMdate.sh[&quot;gost&quot;, &quot;{HOST.IP}&quot;]</key>
                    <delay>3h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;168</expression>
                            <name>УТМ: Сертификат ГОСТ истекает через 7 дней</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>УТМ: Сертификат ГОСТ истекает через 48 часов</name>
                                    <expression>{Template_EGAIS:convUTMdate.sh[&quot;gost&quot;, &quot;{HOST.IP}&quot;].last()}&lt;=48</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;240</expression>
                            <name>УТМ: Сертификат ГОСТ истекает через 10 дней</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>УТМ: Сертификат ГОСТ истекает через 7 дней</name>
                                    <expression>{Template_EGAIS:convUTMdate.sh[&quot;gost&quot;, &quot;{HOST.IP}&quot;].last()}&lt;168</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;=48</expression>
                            <name>УТМ: Сертификат ГОСТ истекает через 48 часов</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Сертификат RSA (осталось часов)</name>
                    <type>EXTERNAL</type>
                    <key>convUTMdate.sh[&quot;rsa&quot;, &quot;{HOST.IP}&quot;]</key>
                    <delay>3h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;168</expression>
                            <name>УТМ: Сертификат RSA истекает через 7 дней</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>УТМ: Сертификат RSA истекает через 48 часов</name>
                                    <expression>{Template_EGAIS:convUTMdate.sh[&quot;rsa&quot;, &quot;{HOST.IP}&quot;].last()}&lt;=48</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;240</expression>
                            <name>УТМ: Сертификат RSA истекает через 10 дней</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>УТМ: Сертификат RSA истекает через 7 дней</name>
                                    <expression>{Template_EGAIS:convUTMdate.sh[&quot;rsa&quot;, &quot;{HOST.IP}&quot;].last()}&lt;168</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;=48</expression>
                            <name>УТМ: Сертификат RSA истекает через 48 часов</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Подключение к БД EGAIS</name>
                    <type>EXTERNAL</type>
                    <key>db_active_egais.sh[&quot;{HOST.IP}&quot;]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>EGAIS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;failed&quot;)}=1 and {diff()}=0</expression>
                            <name>Нет подключения к БД EGAIS</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Подключение к &quot;Firebird&quot; недоступно</name>
                                    <expression>{Template_Firebird_Win:net.tcp.port[{HOST.IP},3050].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Состояние УТМ</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[http,{HOST.IP},8181]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;1</expression>
                            <name>Страница УТМ недоступна</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Страница УТМ недоступна более 30 минут</name>
                                    <expression>{Template_EGAIS:net.tcp.service[http,{HOST.IP},8181].max(30m)}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(30m)}&lt;&gt;1</expression>
                            <name>Страница УТМ недоступна более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Страница УТМ недоступна больше 2 часов</name>
                                    <expression>{Template_EGAIS:net.tcp.service[http,{HOST.IP},8181].max(2h)}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(2h)}&lt;&gt;1</expression>
                            <name>Страница УТМ недоступна больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Страница УТМ недоступна больше 5 часов</name>
                                    <expression>{Template_EGAIS:net.tcp.service[http,{HOST.IP},8181].max(5h)}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(5h)}&lt;&gt;1</expression>
                            <name>Страница УТМ недоступна больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ЕГАИС.Синхронизация</name>
                    <key>service.info[Egais_Sync]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>EGAIS</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна более 30 минут</name>
                                    <expression>{Template_EGAIS:service.info[Egais_Sync].min(30m)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0</expression>
                            <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_EGAIS:service.info[Egais_Sync].min(2h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0</expression>
                            <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_EGAIS:service.info[Egais_Sync].min(5h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0</expression>
                            <name>Служба &quot;ЕГАИС.Синхронизация&quot; недоступна больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Transport-Monitoring</name>
                    <key>service.info[Transport-Monitoring]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>EGAIS</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0&#13;
and &#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Monitoring&quot; недоступна</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Monitoring&quot; недоступна более 30 минут</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Monitoring].min(30m)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Monitoring].min(30m)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0&#13;
and&#13;
{min(30m)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Monitoring&quot; недоступна более 30 минут</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Monitoring&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Monitoring].min(2h)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Monitoring].min(2h)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0&#13;
and&#13;
{min(2h)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Monitoring&quot; недоступна больше 2 часов</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Monitoring&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Monitoring].min(5h)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Monitoring].min(5h)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0&#13;
and&#13;
{min(5h)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Monitoring&quot; недоступна больше 5 часов</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Transport-Updater</name>
                    <key>service.info[Transport-Updater]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>EGAIS</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0&#13;
and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Updater&quot; недоступна</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Updater&quot; недоступна более 30 минут</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Updater].min(30m)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Updater].min(30m)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0&#13;
and&#13;
{min(30m)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Updater&quot; недоступна более 30 минут</name>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Updater&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Updater].min(2h)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Updater].min(2h)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0&#13;
and&#13;
{min(2h)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Updater&quot; недоступна больше 2 часов</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport-Updater&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport-Updater].min(5h)}&gt;0&#13;
and&#13;
{Template_EGAIS:service.info[Transport-Updater].min(5h)}&lt;&gt;255</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0&#13;
and&#13;
{min(5h)}&lt;&gt;255</expression>
                            <name>Служба &quot;Transport-Updater&quot; недоступна больше 5 часов</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Transport</name>
                    <key>service.info[Transport]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>EGAIS</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Служба &quot;Transport&quot; недоступна</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport&quot; недоступна более 30 минут</name>
                                    <expression>{Template_EGAIS:service.info[Transport].min(30m)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0</expression>
                            <name>Служба &quot;Transport&quot; недоступна более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport].min(2h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0</expression>
                            <name>Служба &quot;Transport&quot; недоступна больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Transport&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_EGAIS:service.info[Transport].min(5h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0</expression>
                            <name>Служба &quot;Transport&quot; недоступна больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Сертификат ГОСТ</name>
                    <type>HTTP_AGENT</type>
                    <key>UTM4_gost_expire</key>
                    <delay>3h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.body.gost.expireDate</params>
                        </step>
                    </preprocessing>
                    <url>{HOST.IP}:8181/api/info/list/</url>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <name>Статус лицензии</name>
                    <type>HTTP_AGENT</type>
                    <key>UTM4_license</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.body.license</params>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <params>true
Лицензия на вид деятельности действует</params>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Лицензия на вид деятельности отсутствует</error_handler_params>
                        </step>
                    </preprocessing>
                    <url>{HOST.IP}:8181/api/info/list/</url>
                    <output_format>JSON</output_format>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;Лицензия на вид деятельности отсутствует&quot;)}=1</expression>
                            <name>УТМ: Отсутствует лицензия</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Сертификат RSA</name>
                    <type>HTTP_AGENT</type>
                    <key>UTM4_rsa_expire</key>
                    <delay>3h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.body.rsa.expireDate</params>
                        </step>
                    </preprocessing>
                    <url>{HOST.IP}:8181/api/info/list/</url>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <name>Неотправленные чеки (4.2+)</name>
                    <type>HTTP_AGENT</type>
                    <key>UTM4_unsent_doc</key>
                    <delay>5m</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>The item returns an empty string because no usnent documents were found.&#13;
If unsent documents were found the item returns last date.</description>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.body.checkInfo</params>
                        </step>
                    </preprocessing>
                    <url>{HOST.IP}:8181/api/info/list/</url>
                    <output_format>JSON</output_format>
                    <triggers>
                        <trigger>
                            <expression>{strlen()}&gt;0&#13;
and&#13;
{count(30m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;6</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{strlen(#2)}=0&#13;
and &#13;
{strlen(#1)}=0</recovery_expression>
                            <name>Чеки не отправляются в УТМ более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Чеки не отправляются в УТМ больше 2 часов</name>
                                    <expression>{Template_EGAIS:UTM4_unsent_doc.strlen()}&gt;0&#13;
and&#13;
{Template_EGAIS:UTM4_unsent_doc.count(120m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;24</expression>
                                    <recovery_expression>{Template_EGAIS:UTM4_unsent_doc.strlen(#1)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{strlen()}&gt;0&#13;
and&#13;
{count(120m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;24</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{strlen(#1)}=0</recovery_expression>
                            <name>Чеки не отправляются в УТМ больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Чеки не отправляются в УТМ больше 3 часов</name>
                                    <expression>{Template_EGAIS:UTM4_unsent_doc.strlen()}&gt;0&#13;
and&#13;
{Template_EGAIS:UTM4_unsent_doc.count(180m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;36</expression>
                                    <recovery_expression>{Template_EGAIS:UTM4_unsent_doc.strlen(#1)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{strlen()}&gt;0&#13;
and&#13;
{count(180m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;36</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{strlen(#1)}=0</recovery_expression>
                            <name>Чеки не отправляются в УТМ больше 3 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Чеки не отправляются в УТМ больше 5 часов</name>
                                    <expression>{Template_EGAIS:UTM4_unsent_doc.strlen()}&gt;0&#13;
and&#13;
{Template_EGAIS:UTM4_unsent_doc.count(300m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;60</expression>
                                    <recovery_expression>{Template_EGAIS:UTM4_unsent_doc.strlen(#1)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{strlen()}&gt;0&#13;
and&#13;
{count(300m,&quot;.{1,}\s\+0500&quot;,regexp)}&gt;60</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{strlen(#1)}=0</recovery_expression>
                            <name>Чеки не отправляются в УТМ больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Версия ПО</name>
                    <type>HTTP_AGENT</type>
                    <key>UTM4_version</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.body.version</params>
                        </step>
                    </preprocessing>
                    <url>{HOST.IP}:8181/api/info/list/</url>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <name>Количество исходящих документов min</name>
                    <type>CALCULATED</type>
                    <key>utm_in_min</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <params>min(&quot;web.page.regexp[localhost,\&quot;xhr/db/in?order=asc&amp;limit=1&amp;offset=0\&quot;,8181,\&quot;total.:([0-9]+)\&quot;,,\1]&quot;, 2100s)</params>
                    <description>минимальное значение за последние 35 минут</description>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Количество входящих документов min</name>
                    <type>CALCULATED</type>
                    <key>utm_out_min</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <params>min(&quot;web.page.regexp[localhost,\&quot;xhr/db/out?order=asc&amp;limit=1&amp;offset=0\&quot;,8181,\&quot;total.:([0-9]+)\&quot;,,\1]&quot;, 2100s)</params>
                    <description>минимальное значение за последние 35 минут</description>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Время открытия страницы УТМ</name>
                    <key>web.page.perf[localhost,,8181]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Количество исходящих документов</name>
                    <key>web.page.regexp[localhost,&quot;xhr/db/in?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(30m)}&gt;50</expression>
                            <name>Не обрабатываются исходящие документы УТМ более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются исходящие документы УТМ больше 2 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/in?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(2h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;50</expression>
                            <name>Не обрабатываются исходящие документы УТМ больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются исходящие документы УТМ больше 3 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/in?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(3h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(3h)}&gt;50</expression>
                            <name>Не обрабатываются исходящие документы УТМ больше 3 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются исходящие документы УТМ больше 5 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/in?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(5h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;50</expression>
                            <name>Не обрабатываются исходящие документы УТМ больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Количество входящих документов</name>
                    <key>web.page.regexp[localhost,&quot;xhr/db/out?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(30m)}&gt;50</expression>
                            <name>Не обрабатываются входящие документы УТМ более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются входящие документы УТМ больше 2 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/out?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(2h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;50</expression>
                            <name>Не обрабатываются входящие документы УТМ больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются входящие документы УТМ больше 3 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/out?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(3h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(3h)}&gt;50</expression>
                            <name>Не обрабатываются входящие документы УТМ больше 3 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Не обрабатываются входящие документы УТМ больше 5 часов</name>
                                    <expression>{Template_EGAIS:web.page.regexp[localhost,&quot;xhr/db/out?order=asc&amp;limit=1&amp;offset=0&quot;,8181,&quot;total.:([0-9]+)&quot;,,\1].min(5h)}&gt;50</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;50</expression>
                            <name>Не обрабатываются входящие документы УТМ больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Неотправленные чеки</name>
                    <key>web.page.regexp[localhost,,8181,&quot;(Отсутствуют неотправленные чеки)|(Чеки не отправлялись с [-: 0-9]+)&quot;,,]</key>
                    <delay>5m</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ключ FSRAR</name>
                    <key>web.page.regexp[localhost,,8181,&quot;FSRAR-RSA-([0-9]+)&quot;,,\1]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>UTM</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_FB_disk</template>
            <name>Template_FB_disk</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Free disk space on /backup</name>
                    <key>vfs.fs.size[/backup,free]</key>
                    <delay>5m</delay>
                    <history>14d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Free disk space on /backup in %</name>
                    <key>vfs.fs.size[/backup,pfree]</key>
                    <delay>5m</delay>
                    <history>14d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total disk space on /backup</name>
                    <key>vfs.fs.size[/backup,total]</key>
                    <delay>3h</delay>
                    <trends>90d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Free disk space on /db</name>
                    <key>vfs.fs.size[/db,free]</key>
                    <delay>5m</delay>
                    <history>14d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Free disk space on /db in %</name>
                    <key>vfs.fs.size[/db,pfree]</key>
                    <delay>5m</delay>
                    <history>14d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total disk space on /db</name>
                    <key>vfs.fs.size[/db,total]</key>
                    <delay>3h</delay>
                    <trends>90d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Fingerprint</template>
            <name>Template_Fingerprint</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Статус хоста</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},3,2000]</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>30d</trends>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>{HOSTNAME} - недоступн</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Firebird_connect</template>
            <name>Template_Firebird_connect</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Firebird status base</name>
                    <type>EXTERNAL</type>
                    <key>db_active.sh[&quot;{HOST.IP}&quot;,&quot;{$DBNAME}&quot;]</key>
                    <delay>0;h6-23m/5</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;failed&quot;)}=1</expression>
                            <name>{HOST.IP} - Firebirdу плохо</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Connect Firebird 3050</name>
                    <key>net.tcp.port[{HOST.IP},3050]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>{HOSTNAME} - Firebird 3050 нет коннекта</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Firebird_Win</template>
            <name>Template_Firebird_Win</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Firebird</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Connect Firebird 3050</name>
                    <key>net.tcp.port[{HOST.IP},3050]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Firebird</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Подключение к &quot;Firebird&quot; недоступно</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Подключение к &quot;Firebird&quot; недоступно больше 1 часа</name>
                                    <expression>{Template_Firebird_Win:net.tcp.port[{HOST.IP},3050].max(60m)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(60m)}=0</expression>
                            <name>Подключение к &quot;Firebird&quot; недоступно больше 1 часа</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Подключение к &quot;Firebird&quot; недоступно больше 3 часов</name>
                                    <expression>{Template_Firebird_Win:net.tcp.port[{HOST.IP},3050].max(3h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(3h)}=0</expression>
                            <name>Подключение к &quot;Firebird&quot; недоступно больше 3 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Подключение к &quot;Firebird&quot; недоступно больше 5 часов</name>
                                    <expression>{Template_Firebird_Win:net.tcp.port[{HOST.IP},3050].max(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(5h)}=0</expression>
                            <name>Подключение к &quot;Firebird&quot; недоступно больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Firebird&quot; недоступна</name>
                                    <expression>{Template_Firebird_Win:service.info[FirebirdServerDefaultInstance].last()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы: Firebird</name>
                    <key>service.info[FirebirdServerDefaultInstance]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Firebird</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Служба &quot;Firebird&quot; недоступна</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Firebird&quot; недоступна больше 1 часа</name>
                                    <expression>{Template_Firebird_Win:service.info[FirebirdServerDefaultInstance].min(60m)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(60m)}&gt;0</expression>
                            <name>Служба &quot;Firebird&quot; недоступна больше 1 часа</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Firebird&quot; недоступна больше 3 часов</name>
                                    <expression>{Template_Firebird_Win:service.info[FirebirdServerDefaultInstance].min(3h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(3h)}&gt;0</expression>
                            <name>Служба &quot;Firebird&quot; недоступна больше 3 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;Firebird&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_Firebird_Win:service.info[FirebirdServerDefaultInstance].min(5h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0</expression>
                            <name>Служба &quot;Firebird&quot; недоступна больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Gate</template>
            <name>Template_Gate</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Статус хоста</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},3,2000]</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>180d</trends>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(5m,1)}&gt;3</recovery_expression>
                            <name>{HOSTNAME} - {HOST.IP} - Шлюз недоступен</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>{HOSTNAME} - {HOST.IP} - Шлюз недоступен 24 часа</name>
                                    <expression>{Template_Gate:icmpping[{HOST.IP},3,2000].sum(24h)}=0</expression>
                                    <recovery_expression>{Template_Gate:icmpping[{HOST.IP},3,2000].count(6m,1)}&gt;3</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(24h)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6m,1)}&gt;3</recovery_expression>
                            <name>{HOSTNAME} - {HOST.IP} - Шлюз недоступен 24 часа</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Host_Status</template>
            <name>Template_Host_Status</name>
            <description>параметры идентичные для всех компов независимо от ОС</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>System information</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>localtime</name>
                    <key>system.localtime[utc]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>14d</trends>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(300)}=0</expression>
                            <name>неверное время</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>OC</name>
                    <key>system.uname</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Возвращает операционную систему и её SP</description>
                    <applications>
                        <application>
                            <name>System information</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Host uptime (in sec)</name>
                    <key>system.uptime</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Available RAM</name>
                    <key>vm.memory.size[available]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free RAM</name>
                    <key>vm.memory.size[free]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;40M</expression>
                            <name>{HOSTNAME} - Свободной памяти меньше 40 Mb - {ITEM.VALUE}</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total RAM</name>
                    <key>vm.memory.size[total]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_ICMP_Shop</template>
            <name>Template_ICMP_Shop</name>
            <description>Only for shop devices</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>ICMP</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>ICMP packet loss</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{HOST.IP},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP resopnse time</name>
                    <type>SIMPLE</type>
                    <key>icmppingsec[{HOST.IP},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Возвращает среднее за 3 попытки время отклика в миллисекундах</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0.1 and {avg(300s)}&gt;0.1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;=0.1 and {avg(60s)}&lt;=0.1</recovery_expression>
                            <name>Время ответа от узла больше 100 мс</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Время ответа от узла больше 150 мс</name>
                                    <expression>{Template_ICMP_Shop:icmppingsec[{HOST.IP},3].last()}&gt;0.151&#13;
and&#13;
{Template_ICMP_Shop:icmppingsec[{HOST.IP},3].avg(300s)}&gt;0.151</expression>
                                    <recovery_expression>({Template_ICMP_Shop:icmppingsec[{HOST.IP},3].last()}&gt;0.151 or&#13;
{Template_ICMP_Shop:icmppingsec[{HOST.IP},3].last()}&lt;=0.151)&#13;
and&#13;
{Template_ICMP_Shop:icmppingsec[{HOST.IP},3].avg(60s)}&lt;0.151</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;0.151&#13;
and&#13;
{avg(300s)}&gt;0.151</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({last()}&gt;0.151 or&#13;
{last()}&lt;=0.151)&#13;
and&#13;
{avg(60s)}&lt;0.151</recovery_expression>
                            <name>Время ответа от узла больше 150 мс</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Node status</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},2,1000]</key>
                    <delay>120s</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Возвращает 0 или 1 в зависимости от доступности хоста.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Недоступен</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен более 30 минут</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].sum(30m)}=0</expression>
                                    <recovery_expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен больше 2 часов</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].sum(2h)}=0</expression>
                                    <recovery_expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].min(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#2)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен больше 5 часов</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].sum(5h)}=0</expression>
                                    <recovery_expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].min(#1)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#1)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP average response time</name>
                    <type>CALCULATED</type>
                    <key>ping_avg</key>
                    <delay>0;wd1-5h0-23m/3;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <params>avg(&quot;icmppingsec[{HOST.IP},3]&quot;, 1800s)</params>
                    <description>Возвращает среднее значение времени ответа в течении последних 30 минут.&#13;
&#13;
ICMP avarage response time during last 30 mim</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP average packet loss</name>
                    <type>CALCULATED</type>
                    <key>ping_loss_avg</key>
                    <delay>0;wd1-5h0-23m/2;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(&quot;icmppingloss[{HOST.IP},3]&quot;, 1800s)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Magaz_IP</template>
            <name>Template_Magaz_IP</name>
            <templates>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template_Magaz_Prisma</template>
            <name>Template_Magaz_Prisma</name>
            <templates>
                <template>
                    <name>Template_Host_Status</name>
                </template>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
                <template>
                    <name>Template_Windows_SHOP</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent_SHOP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Службы призмы</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Changes states ICMP</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>abschange(&quot;icmpping[{HOST.IP},2,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(6h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;4 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 5 за 6 часов</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                                    <expression>{Template_Magaz_Prisma:icmp_flaps.count(6h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Prisma:icmp_flaps.count(6h,1)}&lt;9 or&#13;
{Template_Magaz_Prisma:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;9 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                                    <expression>{Template_Magaz_Prisma:icmp_flaps.count(6h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Prisma:icmp_flaps.count(6h,1)}&lt;13 or&#13;
{Template_Magaz_Prisma:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;13 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CashEventService</name>
                    <key>service.info[CashEventService]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;CashEventService&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;CashEventService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[CashEventService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;CashEventService&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[CashEventService].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;CashEventService&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;CashEventService&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;CashEventService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[CashEventService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[CashEventService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DBTrimmingService2</name>
                    <key>service.info[DBTrimmingService2]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;DBTrimmingService2&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;DBTrimmingService2&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;DBTrimmingService2&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;DBTrimmingService2&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;DBTrimmingService2&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;DBTrimmingService2&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[DBTrimmingService2].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>MSSQLServer</name>
                    <key>service.info[MSSQLSERVER]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>MySQL</name>
                    <key>service.info[MySQL]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>PostgreSQL</name>
                    <key>service.info[postgresql-9.4]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>PostgreSQL x64</name>
                    <key>service.info[postgresql-x64-9.4]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ServiceGuard</name>
                    <key>service.info[ServiceGuard]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;ServiceGuard&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;ServiceGuard&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[ServiceGuard].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;ServiceGuard&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[ServiceGuard].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;ServiceGuard&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;ServiceGuard&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;ServiceGuard&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[ServiceGuard].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[ServiceGuard].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SETLicenseManager</name>
                    <key>service.info[SETLicenseManager]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;SETLicenseManager&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;SETLicenseManager&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETLicenseManager].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;SETLicenseManager&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETLicenseManager].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;SETLicenseManager&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;SETLicenseManager&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;SETLicenseManager&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETLicenseManager].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETLicenseManager].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SETPrismaEventsServer</name>
                    <key>service.info[SETPrismaEventsServer]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;SETPrismaEventsServer&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;SETPrismaEventsServer&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;SETPrismaEventsServer&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;SETPrismaEventsServer&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;SETPrismaEventsServer&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;SETPrismaEventsServer&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[SETPrismaEventsServer].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>StreamVideo</name>
                    <key>service.info[StreamVideo]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;StreamVideo&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;StreamVideo&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[StreamVideo].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;StreamVideo&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[StreamVideo].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;StreamVideo&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;StreamVideo&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;StreamVideo&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[StreamVideo].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[StreamVideo].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TrimService</name>
                    <key>service.info[TrimService]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)</expression>
                            <name>Служба &quot;TrimService&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;TrimService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[TrimService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;TrimService&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[TrimService].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;TrimService&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;TrimService&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;TrimService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[TrimService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[TrimService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>VideoArhivService</name>
                    <key>service.info[VideoArhivService]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;VideoArhivService&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;VideoArhivService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoArhivService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;VideoArhivService&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoArhivService].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;VideoArhivService&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;VideoArhivService&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;VideoArhivService&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoArhivService].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoArhivService].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>VideoComServer</name>
                    <key>service.info[VideoComServer]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы призмы</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255</expression>
                            <name>Служба &quot;VideoComServer&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;VideoComServer&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoComServer].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                                <dependency>
                                    <name>Служба &quot;VideoComServer&quot; недоступна более 30 минут</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoComServer].sum(30m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].sum(30m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(120m)}&lt;&gt;0 and&#13;
{sum(120m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;VideoComServer&quot; недоступна более 2 часов</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                        <trigger>
                            <expression>({last()}&lt;&gt;0 and&#13;
{last()}&lt;&gt;255)&#13;
and ({sum(30m)}&lt;&gt;0 and&#13;
{sum(30m)}&lt;&gt;255)</expression>
                            <name>Служба &quot;VideoComServer&quot; недоступна более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;VideoComServer&quot; недоступна более 2 часов</name>
                                    <expression>({Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].last()}&lt;&gt;255)&#13;
and ({Template_Magaz_Prisma:service.info[VideoComServer].sum(120m)}&lt;&gt;0 and&#13;
{Template_Magaz_Prisma:service.info[VideoComServer].sum(120m)}&lt;&gt;255)</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Magaz_Server</template>
            <name>Template_Magaz_Server</name>
            <description>Сервера магазинов</description>
            <templates>
                <template>
                    <name>Template_DiskDrive_SMARTMONTOOLS_LLD</name>
                </template>
                <template>
                    <name>Template_EGAIS</name>
                </template>
                <template>
                    <name>Template_Firebird_Win</name>
                </template>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
                <template>
                    <name>Template_MetroShopSrv</name>
                </template>
                <template>
                    <name>Template_Windows_SHOP</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent_SHOP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Logging</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>OTRS Ticket counts</name>
                </application>
                <application>
                    <name>Sberbank</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Status cashless payment in shop</name>
                    <type>TRAP</type>
                    <key>cashless_info</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Содержит информацию о доступности серверов безналичного расчета сбербанка.&#13;
&#13;
Success - доступен&#13;
Failed - не доступен</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>VNC auth</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Information&quot;,&quot;tvnserver&quot;,257,,]</key>
                    <delay>30m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Windows auth</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Security,,,&quot;Microsoft-Windows-Security-Auditing&quot;,,,skip]</key>
                    <delay>120s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Status cashless payment by first IP</name>
                    <type>TRAP</type>
                    <key>first_sber_ip</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <description>Отображает доступность сервисов безналичной оплаты сбербанка через IP 194.54.14.89&#13;
&#13;
1 - Доступен&#13;
0 - Не доступен.</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Недоступен основной сервер безналичной оплаты сбербанка</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Срабатывает, если последнее полученное значение равно 0</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP packet loss ISP 1</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{$GATE_IP1},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов для провайдера 1.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>ICMP packet loss ISP 2</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{$GATE_IP2},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов для провайдера 2.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Связь Провайдер 1</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{$GATE_IP1},5,1000]</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{sum(#4)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{sum(#2)}&lt;&gt;0</recovery_expression>
                            <name>Провайдер 1 недоступен {$GATE_IP1}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен более 30 минут {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP1},5,1000].sum(30m)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <name>Провайдер 1 недоступен более 30 минут {$GATE_IP1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен  больше 2 часов {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP1},5,1000].sum(2h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <name>Провайдер 1 недоступен  больше 2 часов {$GATE_IP1}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен  больше 5 часов {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP1},5,1000].sum(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <name>Провайдер 1 недоступен  больше 5 часов {$GATE_IP1}</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Связь Провайдер 2</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{$GATE_IP2},5,1000]</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{sum(#4)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{sum(#2)}&lt;&gt;0</recovery_expression>
                            <name>Провайдер 2 недоступен  {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен более 30 минут {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP2},5,1000].sum(30m)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <name>Провайдер 2 недоступен более 30 минут {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  больше 2 часов {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP2},5,1000].sum(2h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <name>Провайдер 2 недоступен  больше 2 часов {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  больше 5 часов {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP2},5,1000].sum(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <name>Провайдер 2 недоступен  больше 5 часов {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{HOST.IP},2,1000]&quot;) - last(&quot;icmpping[{HOST.IP},2,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(6h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 5 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps.count(6h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps.count(1h,1)}&lt;4</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps.count(6h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps.count(1h,1)}&lt;4</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP Gate IP1</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps_ip1</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{$GATE_IP1},5,1000]&quot;) - last(&quot;icmpping[{$GATE_IP1},5,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(12h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;3</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 5 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 10 за 12 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps_ip1.count(12h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps_ip1.count(12h,1)}&lt;7</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;7</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 10 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 15 за 12 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps_ip1.count(12h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps_ip1.count(12h,1)}&lt;12</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;12</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 15 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP Gate IP2</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps_ip2</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{$GATE_IP2},5,1000]&quot;) - last(&quot;icmpping[{$GATE_IP2},5,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(12h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;3</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 5 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 10 за 12 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps_ip2.count(12h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps_ip2.count(12h,1)}&lt;7</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;7</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 10 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 15 за 12 часов</name>
                                    <expression>{Template_Magaz_Server:icmp_flaps_ip2.count(12h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmp_flaps_ip2.count(12h,1)}&lt;12</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;12</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 15 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Information of KKT1</name>
                    <type>TRAP</type>
                    <key>kkt_info1</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <triggers>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=1 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=1 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=0 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=0 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Do not have access to MikroTik - ISP 1</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[&quot;tcp&quot;,{$GATE_IP1},&quot;51958&quot;]</key>
                    <delay>0;300s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;300s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <description>Проверяет доступность нашего маршрутизатора через ISP 1.&#13;
Checks the available of our router via ISP 1</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Нет доступа к маршрутизатору через провайдера 1 ({$GATE_IP1})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP1},5,1000].sum(#4)}=0</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmpping[{$GATE_IP1},5,1000].sum(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Do not have access to MikroTik - ISP 2</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[&quot;tcp&quot;,{$GATE_IP2},&quot;51958&quot;]</key>
                    <delay>0;300s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;300s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <description>Проверяет доступность нашего маршрутизатора через ISP 2.&#13;
Checks the available of our router via ISP 2</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Нет доступа к маршрутизатору через провайдера 2 ({$GATE_IP2})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server:icmpping[{$GATE_IP2},5,1000].sum(#4)}=0</expression>
                                    <recovery_expression>{Template_Magaz_Server:icmpping[{$GATE_IP2},5,1000].sum(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Status cashless payment by second IP</name>
                    <type>TRAP</type>
                    <key>secondary_sber_ip</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <description>Отображает доступность сервисов безналичной оплаты сбербанка через IP 194.54.14.162&#13;
&#13;
1 - Доступен&#13;
0 - Не доступен.</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Недоступен второй сервер безналичной оплаты сбербанка</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Срабатывает, если последнее полученное значение равно 0</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>localtime</name>
                    <key>system.localtime[utc]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>14d</trends>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(300)}=0</expression>
                            <name>неверное время</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Launcher: Status cashless payment</name>
                    <key>system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;^0$&quot;)}=0&#13;
and &#13;
{prev()}&lt;&gt;0</expression>
                            <name>Launcher: problem with sber_check</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>0 - ok, any string that diff from 0 is not okay</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(10m)}=1</expression>
                            <name>Launcher: sber_check no data</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host uptime (in sec)</name>
                    <key>system.uptime</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Кол-во заявок ОТРС</name>
                    <type>TRAP</type>
                    <key>ticket_counts_otrs</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>OTRS Ticket counts</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Заявок в ОТРС - {ITEM.LASTVALUE1}</name>
                            <status>DISABLED</status>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Admin rights</name>
                    <key>URV[{HOST.HOST}]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Display the availability of admin rights.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>if (value == &quot;&quot;){return &quot;User hasn't admin right&quot;} else {return value}</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;User has admin rights&quot;,#1)}=1</expression>
                            <name>Admin rights: current user has admin rights ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(30m)}=1 or&#13;
{regexp(&quot;C:\\Program&quot;)}=1</expression>
                            <name>Admin rights: no data 30 min ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Свободно места на диске D</name>
                    <key>vfs.fs.size[d:,free]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;1G</expression>
                            <name>Мало места на диске D</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Available RAM</name>
                    <key>vm.memory.size[available]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free RAM</name>
                    <key>vm.memory.size[free]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total RAM</name>
                    <key>vm.memory.size[total]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Check usb disk</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT * FROM Win32_DiskDrive WHERE InterfaceType=&quot;USB&quot;]</key>
                    <delay>120s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Magaz_Server_Borovskaya</template>
            <name>Template_Magaz_Server_Borovskaya</name>
            <description>Сервера магазинов (Перекресток) Боровская</description>
            <templates>
                <template>
                    <name>Template_DiskDrive_SMARTMONTOOLS_LLD</name>
                </template>
                <template>
                    <name>Template_Firebird_Win</name>
                </template>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
                <template>
                    <name>Template_MetroShopSrv</name>
                </template>
                <template>
                    <name>Template_Windows_SHOP</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent_SHOP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Logging</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>OTRS Ticket counts</name>
                </application>
                <application>
                    <name>Sberbank</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Status cashless payment in shop</name>
                    <type>TRAP</type>
                    <key>cashless_info</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Содержит информацию о доступности серверов безналичного расчета сбербанка.&#13;
&#13;
Success - доступен&#13;
Failed - не доступен</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>VNC auth</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Information&quot;,&quot;tvnserver&quot;,257,,]</key>
                    <delay>30m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Windows auth</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Security,,,&quot;Microsoft-Windows-Security-Auditing&quot;,,,skip]</key>
                    <delay>120s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Status cashless payment by first IP</name>
                    <type>TRAP</type>
                    <key>first_sber_ip</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <description>Отображает доступность сервисов безналичной оплаты сбербанка через IP 194.54.14.89&#13;
&#13;
1 - Доступен&#13;
0 - Не доступен.</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Недоступен основной сервер безналичной оплаты сбербанка</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Срабатывает, если последнее полученное значение равно 0</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP packet loss ISP 1</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{$GATE_IP1},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов для провайдера 1.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>ICMP packet loss ISP 2</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{$GATE_IP2},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов для провайдера 2.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Связь Провайдер 1</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{$GATE_IP1},5,1000]</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{sum(#4)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{sum(#2)}&lt;&gt;0</recovery_expression>
                            <name>Провайдер 1 недоступен {$GATE_IP1}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен более 30 минут {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP1},5,1000].sum(30m)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <name>Провайдер 1 недоступен более 30 минут {$GATE_IP1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен  больше 2 часов {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP1},5,1000].sum(2h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <name>Провайдер 1 недоступен  больше 2 часов {$GATE_IP1}</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен  больше 5 часов {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP1},5,1000].sum(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <name>Провайдер 1 недоступен  больше 5 часов {$GATE_IP1}</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Связь Провайдер 2</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{$GATE_IP2},5,1000]</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{sum(#4)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{sum(#2)}&lt;&gt;0</recovery_expression>
                            <name>Провайдер 2 недоступен  {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен более 30 минут {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP2},5,1000].sum(30m)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <name>Провайдер 2 недоступен более 30 минут {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  больше 2 часов {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP2},5,1000].sum(2h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <name>Провайдер 2 недоступен  больше 2 часов {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  больше 5 часов {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP2},5,1000].sum(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <name>Провайдер 2 недоступен  больше 5 часов {$GATE_IP2}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{HOST.IP},2,1000]&quot;) - last(&quot;icmpping[{HOST.IP},2,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(6h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 5 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps.count(6h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps.count(1h,1)}&lt;4</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps.count(6h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps.count(1h,1)}&lt;4</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(1h,1)}&lt;4</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP Gate IP1</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps_ip1</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{$GATE_IP1},5,1000]&quot;) - last(&quot;icmpping[{$GATE_IP1},5,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(12h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;3</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 5 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 10 за 12 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip1.count(12h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip1.count(12h,1)}&lt;7</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;7</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 10 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 15 за 12 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip1.count(12h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip1.count(12h,1)}&lt;12</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;12</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 1 {$GATE_IP1} более 15 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Changes states ICMP Gate IP2</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps_ip2</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>prev(&quot;icmpping[{$GATE_IP2},5,1000]&quot;) - last(&quot;icmpping[{$GATE_IP2},5,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(12h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;3</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 5 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 10 за 12 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip2.count(12h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip2.count(12h,1)}&lt;7</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;7</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 10 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 15 за 12 часов</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip2.count(12h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmp_flaps_ip2.count(12h,1)}&lt;12</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(12h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(12h,1)}&lt;12</recovery_expression>
                            <name>Количество обрывов связи на Провайдер 2 {$GATE_IP2} более 15 за 12 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Information of KKT1</name>
                    <type>TRAP</type>
                    <key>kkt_info1</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <triggers>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=1 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=1 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=1 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: 3[0-7]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 2[0-9]\n)}=0 or&#13;
{regexp(Дней до конца работы ОФД: 1[7-9]\n)}=0 or&#13;
&#13;
{regexp(До окончания работы ФН осталось: [1-2][0-9]\n)}=0 or&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [4-9]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: 1[1-7]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [4-9]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>DISASTER</priority>
                        </trigger>
                        <trigger>
                            <expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=1 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=1 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(Дней до конца работы ОФД: [8-9]\n)}=0 or&#13;
{regexp(До окончания работы ФН осталось: [1-3]\n)}=0 or&#13;
&#13;
{regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{str(OK)}=1</recovery_expression>
                            <name>KKT problem on {HOST.HOST}</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>KKT problem on {HOST.HOST}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=1 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=1 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=1</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Дней до конца работы ОФД: [0-8]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(До окончания работы ФН осталось: [0-1]\n)}=0 or&#13;
&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(Последний документ отправлен: 9[1-9]\n)}=0 or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.regexp(&quot;Последний документ отправлен: [1-4]\d{1,2}\n&quot;)}=0&#13;
or&#13;
{Template_Magaz_Server_Borovskaya:kkt_info1.str(OK)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Do not have access to MikroTik - ISP 1</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[&quot;tcp&quot;,{$GATE_IP1},&quot;51958&quot;]</key>
                    <delay>0;300s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;300s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <description>Проверяет доступность нашего маршрутизатора через ISP 1.&#13;
Checks the available of our router via ISP 1</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Нет доступа к маршрутизатору через провайдера 1 ({$GATE_IP1})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 1 недоступен {$GATE_IP1}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP1},5,1000].sum(#4)}=0</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP1},5,1000].sum(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Do not have access to MikroTik - ISP 2</name>
                    <type>SIMPLE</type>
                    <key>net.tcp.service[&quot;tcp&quot;,{$GATE_IP2},&quot;51958&quot;]</key>
                    <delay>0;300s/1-5,06:00-24:00;3600s/1-5,00:00-03:00;300s/6-7,06:00-24:00;3600s/6-7,00:00-03:00</delay>
                    <history>7d</history>
                    <description>Проверяет доступность нашего маршрутизатора через ISP 2.&#13;
Checks the available of our router via ISP 2</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Нет доступа к маршрутизатору через провайдера 2 ({$GATE_IP2})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Провайдер 2 недоступен  {$GATE_IP2}</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP2},5,1000].sum(#4)}=0</expression>
                                    <recovery_expression>{Template_Magaz_Server_Borovskaya:icmpping[{$GATE_IP2},5,1000].sum(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Status cashless payment by second IP</name>
                    <type>TRAP</type>
                    <key>secondary_sber_ip</key>
                    <delay>0</delay>
                    <history>21d</history>
                    <description>Отображает доступность сервисов безналичной оплаты сбербанка через IP 194.54.14.162&#13;
&#13;
1 - Доступен&#13;
0 - Не доступен.</description>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Недоступен второй сервер безналичной оплаты сбербанка</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>Срабатывает, если последнее полученное значение равно 0</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>localtime</name>
                    <key>system.localtime[utc]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>14d</trends>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(300)}=0</expression>
                            <name>неверное время</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Launcher: Status cashless payment</name>
                    <key>system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Sberbank</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;^0$&quot;)}=0&#13;
and &#13;
{prev()}&lt;&gt;0</expression>
                            <name>Launcher: problem with sber_check</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>0 - ok, any string that diff from 0 is not okay</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Launcher: sber_check no data</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:system.run[&quot;cd C:\sber_check &amp;&amp; C:\sber_check\sber_check.exe&quot;].nodata(10m)}=1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(10m)}=1</expression>
                            <name>Launcher: sber_check no data</name>
                            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host uptime (in sec)</name>
                    <key>system.uptime</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Кол-во заявок ОТРС</name>
                    <type>TRAP</type>
                    <key>ticket_counts_otrs</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>OTRS Ticket counts</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Заявок в ОТРС - {ITEM.LASTVALUE1}</name>
                            <status>DISABLED</status>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Admin rights</name>
                    <key>URV[{HOST.HOST}]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Display the availability of admin rights.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>if (value == &quot;&quot;){return &quot;User hasn't admin right&quot;} else {return value}</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;User has admin rights&quot;,#1)}=1</expression>
                            <name>Admin rights: current user has admin rights ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(30m)}=1 or&#13;
{regexp(&quot;C:\\Program&quot;)}=1</expression>
                            <name>Admin rights: no data 30 min ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Server_Borovskaya:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Свободно места на диске D</name>
                    <key>vfs.fs.size[d:,free]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;1G</expression>
                            <name>Мало места на диске D</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Available RAM</name>
                    <key>vm.memory.size[available]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free RAM</name>
                    <key>vm.memory.size[free]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total RAM</name>
                    <key>vm.memory.size[total]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Check usb disk</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT * FROM Win32_DiskDrive WHERE InterfaceType=&quot;USB&quot;]</key>
                    <delay>120s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Logging</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Magaz_Videonet</template>
            <name>Template_Magaz_Videonet</name>
            <description>Видеонет магазинов</description>
            <templates>
                <template>
                    <name>Template_DiskDrive_SMARTMONTOOLS_LLD</name>
                </template>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
                <template>
                    <name>Template_Windows_SHOP</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent_SHOP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Logging</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>OTRS Ticket counts</name>
                </application>
                <application>
                    <name>Sberbank</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Changes states ICMP</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>abschange(&quot;icmpping[{HOST.IP},2,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(6h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;4 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 5 за 6 часов</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                                    <expression>{Template_Magaz_Videonet:icmp_flaps.count(6h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Magaz_Videonet:icmp_flaps.count(6h,1)}&lt;9 or&#13;
{Template_Magaz_Videonet:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;9 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                                    <expression>{Template_Magaz_Videonet:icmp_flaps.count(6h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Magaz_Videonet:icmp_flaps.count(6h,1)}&lt;13 or&#13;
{Template_Magaz_Videonet:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;13 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>localtime</name>
                    <key>system.localtime[utc]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>14d</trends>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(300)}=0</expression>
                            <name>неверное время</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Host uptime (in sec)</name>
                    <key>system.uptime</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Admin rights</name>
                    <key>URV[{HOST.HOST}]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Display the availability of admin rights.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>if (value == &quot;&quot;){return &quot;User hasn't admin right&quot;} else {return value}</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;User has admin rights&quot;,#1)}=1</expression>
                            <name>Admin rights: current user has admin rights ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Videonet:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Videonet:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(30m)}=1 or&#13;
{regexp(&quot;C:\\Program&quot;)}=1</expression>
                            <name>Admin rights: no data 30 min ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_Magaz_Videonet:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Magaz_Videonet:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Available RAM</name>
                    <key>vm.memory.size[available]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Free RAM</name>
                    <key>vm.memory.size[free]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total RAM</name>
                    <key>vm.memory.size[total]</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_MetroShopSrv</template>
            <name>Template_MetroShopSrv</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Подключение к БД FB_SYNC</name>
                    <type>EXTERNAL</type>
                    <key>db_active_fb_sync.sh[&quot;{HOST.IP}&quot;]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;failed&quot;)}=1 and {diff()}=0</expression>
                            <name>Нет подключения к БД FB_SYNC</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы: MetroShopSrv</name>
                    <key>service.info[MetroShopSrv]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#2)}=0</recovery_expression>
                            <name>Служба &quot;MetroShopSrv&quot; недоступна</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;MetroShopSrv&quot; недоступна более 30 минут</name>
                                    <expression>{Template_MetroShopSrv:service.info[MetroShopSrv].min(30m)}&gt;0</expression>
                                    <recovery_expression>{Template_MetroShopSrv:service.info[MetroShopSrv].max(#2)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#2)}=0</recovery_expression>
                            <name>Служба &quot;MetroShopSrv&quot; недоступна более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;MetroShopSrv&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_MetroShopSrv:service.info[MetroShopSrv].min(2h)}&gt;0</expression>
                                    <recovery_expression>{Template_MetroShopSrv:service.info[MetroShopSrv].max(#2)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#2)}=0</recovery_expression>
                            <name>Служба &quot;MetroShopSrv&quot; недоступна больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;MetroShopSrv&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_MetroShopSrv:service.info[MetroShopSrv].min(5h)}&gt;0</expression>
                                    <recovery_expression>{Template_MetroShopSrv:service.info[MetroShopSrv].max(#2)}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#2)}=0</recovery_expression>
                            <name>Служба &quot;MetroShopSrv&quot; недоступна больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Microsoft_SQLServer</template>
            <name>Template_Microsoft_SQLServer</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>SQL: Data File Size</name>
                    <key>perf_counter[&quot;\SQLServer:Databases(_Total)\Data File(s) Size (KB)&quot;]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>b</units>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>SQL: Log File Size</name>
                    <key>perf_counter[&quot;\SQLServer:Databases(_Total)\Log File(s) Size (KB)&quot;]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <units>b</units>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Статус службы: MSSQLSERVER</name>
                    <key>service_state[MSSQLSERVER]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>Zabbix. {HOSTNAME} Служба SQL Server остановлена.</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы: SQLServerAgent</name>
                    <key>service_state[SQLServerAgent]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>Zabbix. {HOSTNAME} Служба SQL Agent остановлена.</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Network_Devices</template>
            <name>Template_Network_Devices</name>
            <templates>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template_pfSense</template>
            <name>Template_pfSense</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Traffic</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>ifInOctets.1 LAN IN</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.10.1</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifInOctets.1</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <applications>
                        <application>
                            <name>Traffic</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ifInOctets.2 WAN IN</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.10.2</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifInOctets.2</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <status>DISABLED</status>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ifInOctets.3 OPT IN</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.10.3</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifInOctets.3</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <status>DISABLED</status>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ifOutOctets.1 LAN OUT</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.16.1</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifOutOctets.1</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <applications>
                        <application>
                            <name>Traffic</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ifOutOctets.2 WAN OUT</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.16.2</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifOutOctets.2</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <status>DISABLED</status>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ifOutOctets.3 OPT OUT</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.2.2.1.16.3</snmp_oid>
                    <key>interfaces.ifTable.ifEntry.ifOutOctets.3</key>
                    <delay>30s</delay>
                    <history>1d</history>
                    <trends>1d</trends>
                    <status>DISABLED</status>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_PriceChecker</template>
            <name>Template_PriceChecker</name>
            <templates>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>(Магазины) Прайсчекеры</name>
                </group>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Monitor (Data from device)</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Description</name>
                    <type>EXTERNAL</type>
                    <key>runner_pricecheck_script.sh[&quot;--ip&quot;,&quot;{HOST.IP}&quot;,&quot;--param&quot;,&quot;description&quot;]</key>
                    <delay>0;300s/1-5,08:00-23:00;500s/6-7,08:00-23:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Monitor (Data from device)</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$['description']</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Last activity (Timestamp)</name>
                    <type>EXTERNAL</type>
                    <key>runner_pricecheck_script.sh[&quot;--ip&quot;,&quot;{HOST.IP}&quot;,&quot;--param&quot;,&quot;timestamp&quot;]</key>
                    <delay>0;300s/1-5,08:00-23:00;500s/6-7,08:00-23:00</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>unixtime</units>
                    <description>Return time in timestamp.&#13;
&#13;
Возвращает время в таймштампе.</description>
                    <applications>
                        <application>
                            <name>Monitor (Data from device)</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$['timestamp']</params>
                        </step>
                    </preprocessing>
                </item>
            </items>
        </template>
        <template>
            <template>Template_pService</template>
            <name>Template_pService</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Службы</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Статус службы: СберБанк ($1)</name>
                    <key>service.info[pService]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>Служба &quot;pService&quot; недоступна</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;pService&quot; недоступна более 30 минут</name>
                                    <expression>{Template_pService:service.info[pService].min(30m)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(30m)}&gt;0</expression>
                            <name>Служба &quot;pService&quot; недоступна более 30 минут</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;pService&quot; недоступна больше 2 часов</name>
                                    <expression>{Template_pService:service.info[pService].min(2h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(2h)}&gt;0</expression>
                            <name>Служба &quot;pService&quot; недоступна больше 2 часов</name>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Служба &quot;pService&quot; недоступна больше 5 часов</name>
                                    <expression>{Template_pService:service.info[pService].min(5h)}&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(5h)}&gt;0</expression>
                            <name>Служба &quot;pService&quot; недоступна больше 5 часов</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Scale</template>
            <name>Template_Scale</name>
            <templates>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>(Магазины) Весы самообслуживания</name>
                </group>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Monitor (Data from device)</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Last activity (Timestamp)</name>
                    <type>EXTERNAL</type>
                    <key>scale_zbx.sh[&quot;--ip&quot;,&quot;{HOST.IP}&quot;,&quot;--query&quot;,&quot;SELECT max(add_time) FROM p101.tab_bar_report&quot;,&quot;--param&quot;,&quot;timestamp&quot;, &quot;--dbtype&quot;, {$DBTYPE}]</key>
                    <delay>0;300s/1-5,08:00-23:00;900s/6-7,08:00-23:00</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Return time in timestamp. If case of an error, a string will be returned with a description of the error.&#13;
&#13;
Возвращает время в таймштампе. В случае ошибки возвращает строку с описанием ошибки.</description>
                    <applications>
                        <application>
                            <name>Monitor (Data from device)</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$['timestamp']</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{nodata(1800s)}=1</expression>
                            <name>SCALE: No data (during 30 min)</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{regexp(@MySQL_error)}=1&#13;
or&#13;
{str(&quot;Unknown reason&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(MySQL_error)}=0&#13;
and&#13;
{str(&quot;Unknown reason&quot;)}=0</recovery_expression>
                            <name>{HOST.IP} - Connection error to MySQL</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <description>Обнаруживая строку об ошибке триггер срабатывает.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен более 30 минут</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(30m)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен больше 2 часов</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(2h)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен больше 5 часов</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(5h)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#1)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({regexp(@MySQL_error)}=0&#13;
and&#13;
{str(&quot;Unknown reason&quot;)}=0&#13;
)&#13;
and&#13;
{str(&quot;Empty answer&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{str(&quot;Empty answer&quot;)}=0</recovery_expression>
                            <name>{HOST.IP} - Получен пустой ответ от базы данных</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <description>This trigger displayed, if was returned an empty answer.&#13;
&#13;
Обнаруживая строку об ошибке триггер срабатывает.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен более 30 минут</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(30m)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен больше 2 часов</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(2h)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#2)}&lt;&gt;0</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен больше 5 часов</name>
                                    <expression>{Template_Scale:icmpping[{HOST.IP},2,1000].sum(5h)}=0</expression>
                                    <recovery_expression>{Template_Scale:icmpping[{HOST.IP},2,1000].min(#1)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>({now()}&#13;
-&#13;
{last()}) &gt; 1801</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({now()}&#13;
-&#13;
{last()}) &lt; 1801</recovery_expression>
                            <name>{HOST.IP} - Последняя активность более часа назад</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <description>This trigger displayed, if last activity was more than one hour ago.&#13;
&#13;
Если разница между текущим временем сервера и текущим последним значением элемента равна больше 1801, то триггер срабатывает.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Server_Linux1</template>
            <name>Template_Server_Linux1</name>
            <description>Only servers. Non virtual machine.</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>CPU_CORE</name>
                </application>
                <application>
                    <name>Filesystem</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>System information</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Maximum number of processes</name>
                    <key>kernel.maxproc</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>System information</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of processes</name>
                    <key>proc.num[]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>System information</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Load average 1 min</name>
                    <key>system.cpu.load[,avg1]</key>
                    <delay>10s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Load average 5 min</name>
                    <key>system.cpu.load[,avg5]</key>
                    <delay>150s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Load average 15 min</name>
                    <key>system.cpu.load[,avg15]</key>
                    <delay>300s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Number of cores</name>
                    <key>system.cpu.num[]</key>
                    <delay>3600s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU usage total (wait)</name>
                    <key>system.cpu.util[,iowait,avg1]</key>
                    <delay>10s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU usage total (system)</name>
                    <key>system.cpu.util[,system,avg1]</key>
                    <delay>10s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU usage total (user)</name>
                    <key>system.cpu.util[,user,avg1]</key>
                    <delay>10s</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Host name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>System information</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Hostname was changed on {HOSTNAME}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Motherboard</name>
                    <key>system.hw.chassis[full]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System information</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>CPU</name>
                    <key>system.hw.cpu[all,model]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Available RAM %</name>
                    <key>vm.memory.size[pavailable]</key>
                    <delay>2m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10</expression>
                            <name>{HOSTNAME} - Свободная память &lt; 10 %</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interfaces</name>
                    <key>net.if.discovery</key>
                    <delay>3600s</delay>
                    <status>DISABLED</status>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^eth[0-9]$</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^eth[0-9][0-9]$</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^eth[0-9][0-9][0-9]$</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^eno[0-9][0-9]$</value>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^eno[0-9]$</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>^enp.{5,10}$</value>
                                <formulaid>F</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>Total count collisions on {#IFNAME}</name>
                            <key>net.if.collisions[{#IFNAME}]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on {#IFNAME} Bps</name>
                            <key>net.if.in[{#IFNAME}, bytes]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <units>Bps</units>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count incoming errors on {#IFNAME}</name>
                            <key>net.if.in[{#IFNAME}, errors]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count incoming packets on {#IFNAME}</name>
                            <key>net.if.in[{#IFNAME}, packets]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on {#IFNAME} Bps</name>
                            <key>net.if.out[{#IFNAME}, bytes]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <units>Bps</units>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count outgoing errors on {#IFNAME}</name>
                            <key>net.if.out[{#IFNAME}, errors]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count outgoing packets on {#IFNAME}</name>
                            <key>net.if.out[{#IFNAME}, packets]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count bytes on {#IFNAME}</name>
                            <key>net.if.total[{#IFNAME}, bytes]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total count packets on {#IFNAME}</name>
                            <key>net.if.total[{#IFNAME}, packets]</key>
                            <delay>30s</delay>
                            <history>1d</history>
                            <trends>30d</trends>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>CPU discovery</name>
                    <key>system.cpu.discovery</key>
                    <delay>3600s</delay>
                    <status>DISABLED</status>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#CPU.STATUS}</macro>
                                <value>online</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>3600s</lifetime>
                    <description>This discovery rules is discovers CPU info and his cores</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in guest mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},guest,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in gnice mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},guest_nice,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in idle mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},idle,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in irq mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},interrupt,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in iowait mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},iowait,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in nice mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},nice,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in soft irq mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},softirq,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in steal mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},steal,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in system mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},system,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} time in user mode over avg 5 minutes</name>
                            <key>system.cpu.util[{#CPU.NUMBER},user,avg5]</key>
                            <delay>150s</delay>
                            <history>4w</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU {#CPU.NUMBER} information</name>
                            <key>system.hw.cpu[{#CPU.NUMBER},full]</key>
                            <delay>600s</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>CPU_CORE</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Usage core {#CPU.NUMBER} per type</name>
                            <width>600</width>
                            <height>340</height>
                            <yaxismax>0</yaxismax>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},guest_nice,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},guest,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},idle,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},iowait,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FC6EA3</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},interrupt,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},nice,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>6</sortorder>
                                    <color>AC8C14</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},softirq,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>7</sortorder>
                                    <color>611F27</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},steal,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>8</sortorder>
                                    <color>F230E0</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},system,avg5]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>9</sortorder>
                                    <color>5CCD18</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>system.cpu.util[{#CPU.NUMBER},user,avg5]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>File system discovery</name>
                    <key>vfs.fs.discovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <evaltype>FORMULA</evaltype>
                        <formula>A or (B and C)</formula>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>^ext</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>^tmpfs</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>/tmp</value>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>Number of free inode on {#FSNAME}</name>
                            <key>vfs.fs.inode[{#FSNAME},free]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of free inode on {#FSNAME} in %</name>
                            <key>vfs.fs.inode[{#FSNAME},pfree]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;10</expression>
                                    <name>Free inodes is less than 10% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;15</expression>
                                    <name>Free inodes is less than 15% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Free inodes is less than 10% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.inode[{#FSNAME},pfree].last()}&lt;10</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;25</expression>
                                    <name>Free inodes is less than 25% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Free inodes is less than 10% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.inode[{#FSNAME},pfree].last()}&lt;10</expression>
                                        </dependency>
                                        <dependency>
                                            <name>Free inodes is less than 15% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.inode[{#FSNAME},pfree].last()}&lt;15</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of used inode on {#FSNAME} in %</name>
                            <key>vfs.fs.inode[{#FSNAME},pused]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total inode on {#FSNAME}</name>
                            <key>vfs.fs.inode[{#FSNAME},total]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of used inode on {#FSNAME}</name>
                            <key>vfs.fs.inode[{#FSNAME},used]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space on {#FSNAME}</name>
                            <key>vfs.fs.size[{#FSNAME},free]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space on {#FSNAME} in %</name>
                            <key>vfs.fs.size[{#FSNAME},pfree]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;=10</expression>
                                    <name>Free disk space is less than 10% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;15</expression>
                                    <name>Free disk space is less than 15% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Free disk space is less than 10% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.size[{#FSNAME},pfree].last()}&lt;=10</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;25</expression>
                                    <name>Free disk space is less than 25% on volume {#FSNAME}</name>
                                    <opdata>{ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Free disk space is less than 10% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.size[{#FSNAME},pfree].last()}&lt;=10</expression>
                                        </dependency>
                                        <dependency>
                                            <name>Free disk space is less than 15% on volume {#FSNAME}</name>
                                            <expression>{Template_Server_Linux1:vfs.fs.size[{#FSNAME},pfree].last()}&lt;15</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Used space on {#FSNAME} in %</name>
                            <key>vfs.fs.size[{#FSNAME},pused]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total space on {#FSNAME}</name>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Used space on {#FSNAME}</name>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <delay>300s</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>DIsk inodes usage {#FSNAME} (last value)</name>
                            <width>600</width>
                            <height>340</height>
                            <yaxismax>0</yaxismax>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>F63100</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.inode[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>2774A4</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.inode[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>DIsk space usage {#FSNAME} (averange value)</name>
                            <width>600</width>
                            <height>340</height>
                            <yaxismax>0</yaxismax>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.size[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.size[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>DIsk space usage {#FSNAME} (last value)</name>
                            <width>600</width>
                            <height>340</height>
                            <yaxismax>0</yaxismax>
                            <show_work_period>NO</show_work_period>
                            <show_triggers>NO</show_triggers>
                            <type>PIE</type>
                            <show_3d>YES</show_3d>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.size[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <calc_fnc>LAST</calc_fnc>
                                    <item>
                                        <host>Template_Server_Linux1</host>
                                        <key>vfs.fs.size[{#FSNAME},used]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template_SNR_Network</template>
            <name>Template Module SNR Network</name>
            <description>Template for SNR Switches</description>
            <groups>
                <group>
                    <name>Templates/SNR Switches</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Error</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>Packets</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Error/Discard  - Statistics on the interface</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>error.if.discovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>@SNR_ethernet</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>This discovery rule detects the all interfaces at switch and collect statistics errors and discarded packets on the interface&#13;
&#13;
{$SNMP_COMMUNITY_SECURE}, {$SNMP_PRIVATE_PASSWORD} is a global macro.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Inbound packets discarded on $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscards.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Inbound errors on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrors.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total new Inbound errors on interface $1</name>
                            <type>CALCULATED</type>
                            <key>ifInErrorsnew.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <params>last(&quot;ifInErrors.[{#SNMPINDEX}]&quot;) - last(&quot;ifInErrors.[{#SNMPINDEX}]&quot;, #2)</params>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Outbound packets discarded on $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscards.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Outbound errors on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrors.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>For packet-oriented interfaces, the number of outbound packets that could not be transmitted because of errors. For character-oriented or fixed-length interfaces, the number of outbound transmission units that could not be transmitted because of errors.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total new outbound errors on interface $1</name>
                            <type>CALCULATED</type>
                            <key>ifOutErrorsnew.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <params>last(&quot;ifOutErrors.[{#SNMPINDEX}]&quot;) - last(&quot;ifOutErrors.[{#SNMPINDEX}]&quot;, #2)</params>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Error</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template_SNR_Network:ifInErrorsnew.[{#SNMPINDEX}].avg(5m)}&gt;{$IF_ERRORS_WARN:&quot;{#IFNAME}&quot;}&#13;
or &#13;
{Template_SNR_Network:ifOutErrorsnew.[{#SNMPINDEX}].avg(5m)}&gt;{$IF_ERRORS_WARN:&quot;{#IFNAME}&quot;}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{Template_SNR_Network:ifInErrorsnew.[{#SNMPINDEX}].avg(5m)}&lt;{$IF_ERRORS_WARN:&quot;{#IFNAME}&quot;}*0.8&#13;
or &#13;
{Template_SNR_Network:ifOutErrorsnew.[{#SNMPINDEX}].avg(5m)}&lt;{$IF_ERRORS_WARN:&quot;{#IFNAME}&quot;}*0.8</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): High error rate</name>
                            <priority>WARNING</priority>
                            <description>IFNAME - LLD в контексте</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Interface {#IFDESCR}: Error and Discared Traffic</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifInErrors.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>A54F10</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifInDiscards.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>FC6EA3</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifOutDiscards.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>6C59DC</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifOutErrors.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>General - Statistics on the interface</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>net.if.discovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>@SNR_ethernet</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>This discovery rule detects all interfaces at switch and collect the most general information about the interface &#13;
&#13;
{$SNMP_COMMUNITY_SECURE}, {$SNMP_PRIVATE_PASSWORD} is a global macro.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status of interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatus.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>The desired state of the interface.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Alias of interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAlias.{#SNMPINDEX}</snmp_oid>
                            <key>ifAlias.[{#SNMPINDEX}]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Description of interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>ifDescr.[{#SNMPINDEX}]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>A textual string containing information about the interface.  This string should include the name of the manufacturer, the product name and the version of the interface hardware/software.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total bytes in $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctets.[{#IFDESCR}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>Bps</units>
                            <description>Total bytes received on the interface&#13;
Количество байт получено данным интерфейсом.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Total bytes out $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctets.[{#IFDESCR}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>B</units>
                            <description>Total bytes transmitted on the interface.&#13;
Всего байт передано с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>ifInOctets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>bps</units>
                            <description>The number of octets in valid MAC frames received on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>MTU on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.2.2.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>ifMtu.[{#SNMPINDEX}]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status of interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatus.[{#IFDESCR}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>The current operational state of the interface.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <name>Operational status was changed on {HOST.NAME} interface {#IFDESCR}</name>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutOctets.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <units>bps</units>
                            <description>The number of octets transmitted in MAC frames on this interface, including the MAC header and FCS.&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed on interface $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>ifSpeed.[{#SNMPINDEX}]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface type $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>ifType.[{#SNMPINDEX}]</key>
                            <delay>600s</delay>
                            <history>14d</history>
                            <description>Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Type network interface</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#IFDESCR}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifInOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template_SNR_Network</host>
                                        <key>ifOutOctets.[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Broadcast/Multicast/Unicast packets  - Statistics on the interface</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>packet.if.discovery</key>
                    <delay>3600s</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>1</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>@SNR_ethernet</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>This discovery rule detects the all interfaces at switch and collect statistics broadcast, multicast, unicast traffic on the interface&#13;
&#13;
{$SNMP_COMMUNITY_SECURE}, {$SNMP_PRIVATE_PASSWORD} is a global macro.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Total broadcast packets in $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInBroadcastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total broadcast packets received on the interface&#13;
Количество широковещательных пакетов принято этим интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total multicast packets in $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInMulticastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total multicast packets received on the interface&#13;
Количество мультикаст пакетов принято этим интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total packets in $1</name>
                            <type>CALCULATED</type>
                            <key>ifHCinTotalPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <params>last(&quot;ifHCInUcastPkts.[{#SNMPINDEX}]&quot;)+&#13;
last(&quot;ifHCInMulticastPkts.[{#SNMPINDEX}]&quot;)+&#13;
last(&quot;ifHCInBroadcastPkts.[{#SNMPINDEX}]&quot;)</params>
                            <description>Total multicast, unicast and broadcast packets received by this interface.&#13;
Количество широковещательнных, однонаправленных и мультикаст пакетов полученно данным интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total unicast packets in $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInUcastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total unicast packets received on the interface&#13;
Количество однонаправленных пакетов принято этим интерфейсом&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total broadcast packets out $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutBroadcastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total broadcast packets transmitted from the interface.&#13;
Количество широковещательныхпакетов переданно с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total multicast packets out $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.12.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutMulticastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total multicast packets transmitted from the interface.&#13;
Количество мультикаст пакетов переданно с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total packets out $1</name>
                            <type>CALCULATED</type>
                            <key>ifHCoutTotalPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <params>last(&quot;ifHCOutUcastPkts.[{#SNMPINDEX}]&quot;)+&#13;
last(&quot;ifHCOutMulticastPkts.[{#SNMPINDEX}]&quot;)+&#13;
last(&quot;ifHCOutBroadcastPkts.[{#SNMPINDEX}]&quot;)</params>
                            <description>Total multicast, unicast and broadcast packets transmitted from the interface.&#13;
Количество широковещательнных, однонаправленных и мультикаст пакетов переданно с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total unicast packets out $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.2.1.31.1.1.1.11.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutUcastPkts.[{#SNMPINDEX}]</key>
                            <delay>30</delay>
                            <history>14d</history>
                            <description>Total unicast packets transmitted from the interface.&#13;
Количество одонаправленных пакетов переданно с данного интерфейса&#13;
&#13;
Interface comment/description: {#IFALIAS}</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Packets</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$IF_ERRORS_WARN}</macro>
                    <value>2</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template_SNR_System</template>
            <name>Template Module SNR System</name>
            <description>Template for SNR Switches</description>
            <groups>
                <group>
                    <name>Templates/SNR Switches</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Time</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.25.1.1.6.0</snmp_oid>
                    <key>ntpEntTimeResolution</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>NTP time</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU idle % (5 min)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.4.0</snmp_oid>
                    <key>switchCPUFiveMinuteIdle</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>%</units>
                    <description>CPU IDLE for the last 5 minutes as a percentage</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU idle % (5 secs)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.2.0</snmp_oid>
                    <key>switchCPUFiveSecondIdle</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>%</units>
                    <description>CPU IDLE for the last 5 seconds as a percentage</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU idle % (From running)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.5.0</snmp_oid>
                    <key>switchCPUIdle</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>%</units>
                    <description>CPU has state IDLE from running %</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU idle % (30 secs)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.3.0</snmp_oid>
                    <key>switchCPUThirtySecondIdle</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>%</units>
                    <description>CPU IDLE for the last 30 seconds as a percentage</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Model CPU</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.1.0</snmp_oid>
                    <key>switchCPUType</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>The CPU type of switch</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>CPU usage %</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.10.0</snmp_oid>
                    <key>switchCpuUsage</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>%</units>
                    <description>The CPU usage of switch.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Busy memory size</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.7.0</snmp_oid>
                    <key>switchMemoryBusy</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>B</units>
                    <description>Busy memory size in KB</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Total memory size</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.11.6.0</snmp_oid>
                    <key>switchMemorySize</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>B</units>
                    <description>Total memory size in KB</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>MAC CPU</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.5</snmp_oid>
                    <key>sysCPUMac</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>The MAC Address of the switch's CPU</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Description</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.1.0</snmp_oid>
                    <key>sysDescr</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>HW Version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.2.0</snmp_oid>
                    <key>sysHardwareVersion</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>The version information of switch hardware</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Software version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.40418.7.100.1.3.0</snmp_oid>
                    <key>sysSoftwareVersion</key>
                    <delay>600s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>The version information of switch software</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>sysUpTime</key>
                    <delay>30</delay>
                    <history>14d</history>
                    <units>s</units>
                    <description>Time since last boot</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                </item>
            </items>
        </template>
        <template>
            <template>Template_SOD</template>
            <name>Template_SOD</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Службы</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Статус службы CheckMetroServices</name>
                    <key>service_state[CheckMetroServices]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Проверка состояния служб по логам этих служб&#13;
http://192.168.99.5/mediawiki/index.php/ЭДО</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Проверка Запущеных Служб - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы EDIMetro</name>
                    <key>service_state[EDIMetro]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба обрабатывает документооборот с поставщиками и покупателями с использользованием ЭЦП через систему Контур.Диадок</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД ЭДО - Все пропало {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Invoice2SMSvc</name>
                    <key>service_state[Invoice2SMSvc]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба по обработке документов приходящих через почту</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Invoice2SMSvc - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы KPKAndroidIn</name>
                    <key>service_state[KPKAndroidIn]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба  обрабатывет файлы приходящие от мобильных агентов.</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД KPKAndroidIn - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы KPKAndroid</name>
                    <key>service_state[KPKAndroid]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба подготавливает данные для выгрузки на устройства мобильных агентов</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД KPKAndroid - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы KPKServerIn</name>
                    <key>service_state[KPKServerIn]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба создаёт документы на основании заказов с КПК</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД KPKServerIn - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы MageServerSvc</name>
                    <key>service_state[MageServerSvc]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба по обмену документами для мобильных агентов на устройствах с WindowsPC</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД MageServer - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Megapolis</name>
                    <key>service_state[Megapolis]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Мегаполис - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы MetrMobTradeServices</name>
                    <key>service_state[MetrMobTradeServices]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Приём и передача данных с/на КПК для создания заказов агентами по торговым точкам</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД MetrMobTradeServices (Мобильная Торговля) - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Msg2Jabber</name>
                    <key>service_state[Msg2Jabber]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба по рассылке настраиваемых сообщений на джаббер по событиям в выписке и БД</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Джаббер Уведомлялка - Сломалось {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы MTAutoStart</name>
                    <key>service_state[MTAutoStart]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба мониторит запущена ли служба prMobileTrade для мобильных агентов с КПК. Если служба не запущена в течении 3 минут, происходит попытка запуска службы prMobileTrade.</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД MTAutoStart (Мобильная Торговля - Автостарт) - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы NestleFrom</name>
                    <key>service_state[NestleFrom]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба обмена данными по контракту Нестле&#13;
http://192.168.99.5/mediawiki/index.php/ЭДО</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Нэстле - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы OchakovoService</name>
                    <key>service_state[OchakovoService]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД OchakovoService - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы OtrsService</name>
                    <key>service_state[OtrsService]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба мониторит перемещения юзеров с программой на КПК по данным геолокации.</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД ОТРС Администратор - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Progress</name>
                    <key>service_state[Progress]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба по загрузке заказов контракта Прогресс.</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Прогресс - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Rep2SM</name>
                    <key>service_state[Rep2SM]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Автоматическая выгрузка и рассылка данных по контрактам&#13;
http://192.168.99.5/mediawiki/index.php/ЭДО</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Rep2SM - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы SolvoExchangeSvc</name>
                    <key>service_state[SolvoExchangeSvc]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба по обмену данными между выпиской и СОЛВО (СУСК)&#13;
Информация о товарах и товарных группах&#13;
Информация о контрагентах&#13;
Приемка товара&#13;
Отгрузка товара</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД СолвоОбмен - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Synergy</name>
                    <key>service_state[Synergy]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба обрабатывает заказы контракта &quot;Синергия&quot;</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Синергия - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы UniConf</name>
                    <key>service_state[UniConf]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба обрабатывает заказы от контракта &quot;Объединённые кондитеры&quot; и отправляет справочную информацию по контракту на сервер ОК</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД ЮниКонф (Объединенные Кондитеры) - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус службы Unilever</name>
                    <key>service_state[Unilever]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Служба обрабатывет заказы контракта &quot;Юнилевер&quot;</description>
                    <applications>
                        <application>
                            <name>Службы</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;&gt;0</expression>
                            <name>СОД Юнилевер - Не запущен {HOSTNAME}</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Unifi_AP</template>
            <name>Template_Unifi_AP</name>
            <description>Точки доступа расположенные на складе (VLAN 703)</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>ICMP</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>ICMP packet loss</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{HOST.IP},3]</key>
                    <delay>0;wd1-5h0-23m/1;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Возвращает средний за три попытки процент потери пакетов.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP resopnse time</name>
                    <type>SIMPLE</type>
                    <key>icmppingsec[{HOST.IP},3]</key>
                    <delay>0;wd1-5h0-23m/3;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Возвращает среднее за 3 попытки время отклика в миллисекундах</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0.1</expression>
                            <name>Время ответа от узла больше 100 мс</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Время ответа от узла больше 100 мс</name>
                                    <expression>{Template_Unifi_AP:icmppingsec[{HOST.IP},3].last()}&gt;0.1&#13;
and&#13;
{Template_Unifi_AP:icmppingsec[{HOST.IP},3].sum(301s)}&gt;0.1</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last(#2)}=0&#13;
and&#13;
{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;0.1&#13;
and&#13;
{sum(301s)}&gt;0.1</expression>
                            <name>Время ответа от узла больше 100 мс</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last(#2)}=0&#13;
and&#13;
{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Статус хоста</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.IP},2,1000]</key>
                    <delay>120s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <description>Возвращает 0 или 1 в зависимости от доступности хоста.</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(#2)}=0&#13;
and&#13;
{last()}=0</expression>
                            <name>Недоступен</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен более 30 минут</name>
                                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].sum(30m)}=0</expression>
                                    <recovery_expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(30m)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен больше 2 часов</name>
                                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].sum(2h)}=0</expression>
                                    <recovery_expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(2h)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен больше 5 часов</name>
                                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].sum(5h)}=0</expression>
                                    <recovery_expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].min(#3)}&lt;&gt;0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(5h)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#3)}&lt;&gt;0</recovery_expression>
                            <name>Недоступен больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP average response time</name>
                    <type>CALCULATED</type>
                    <key>ping_avg</key>
                    <delay>0;wd1-5h0-23m/3;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <params>avg(&quot;icmppingsec[{HOST.IP},3]&quot;, 1800s)</params>
                    <description>Возвращает среднее значение времени ответа в течении последних 30 минут.&#13;
&#13;
ICMP avarage response time during last 30 mim</description>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>ICMP average packet loss</name>
                    <type>CALCULATED</type>
                    <key>ping_loss_avg</key>
                    <delay>0;wd1-5h0-23m/2;wd6-7h0-23m/10</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>avg(&quot;icmppingloss[{HOST.IP},3]&quot;, 1800s)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Videonet</template>
            <name>Template_Videonet</name>
            <description>Сервера Видеонаблюдения</description>
            <templates>
                <template>
                    <name>Template_Host_Status</name>
                </template>
                <template>
                    <name>Template_ICMP_Shop</name>
                </template>
                <template>
                    <name>Template_Windows_SHOP</name>
                </template>
                <template>
                    <name>Template_ZabbixAgent_SHOP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Changes states ICMP</name>
                    <type>CALCULATED</type>
                    <key>icmp_flaps</key>
                    <delay>240s</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>abschange(&quot;icmpping[{HOST.IP},2,1000]&quot;)</params>
                    <applications>
                        <application>
                            <name>ICMP</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{count(6h,1)}&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;4 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 5 за 6 часов</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                                    <expression>{Template_Videonet:icmp_flaps.count(6h,1)}&gt;10</expression>
                                    <recovery_expression>{Template_Videonet:icmp_flaps.count(6h,1)}&lt;9 or&#13;
{Template_Videonet:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;10</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;9 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 10 за 6 часов</name>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                                    <expression>{Template_Videonet:icmp_flaps.count(6h,1)}&gt;15</expression>
                                    <recovery_expression>{Template_Videonet:icmp_flaps.count(6h,1)}&lt;13 or&#13;
{Template_Videonet:icmp_flaps.count(3h,1)}&lt;1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{count(6h,1)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{count(6h,1)}&lt;13 or&#13;
{count(3h,1)}&lt;1</recovery_expression>
                            <name>Количество обрывов связи на {HOST.IP} более 15 за 6 часов</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Состояние процесса VideoNet.exe</name>
                    <key>proc.num[VideoNet.exe]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Видеонет не запущен</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Видеонет не запущен более 30 минут</name>
                                    <expression>{Template_Videonet:proc.num[VideoNet.exe].max(30m)}=0</expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_Videonet:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(30m)}=0</expression>
                            <name>Видеонет не запущен более 30 минут</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Видеонет не запущен больше 2 часов</name>
                                    <expression>{Template_Videonet:proc.num[VideoNet.exe].max(2h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(2h)}=0</expression>
                            <name>Видеонет не запущен больше 2 часов</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Видеонет не запущен больше 5 часов</name>
                                    <expression>{Template_Videonet:proc.num[VideoNet.exe].max(5h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(5h)}=0</expression>
                            <name>Видеонет не запущен больше 5 часов</name>
                            <priority>HIGH</priority>
                            <dependencies>
                                <dependency>
                                    <name>Видеонет не запущен больше 24 часов</name>
                                    <expression>{Template_Videonet:proc.num[VideoNet.exe].max(24h)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{max(24h)}=0</expression>
                            <name>Видеонет не запущен больше 24 часов</name>
                            <priority>DISASTER</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Web</template>
            <name>Template_Web</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>advanta скорость открытия avg</name>
                    <type>CALCULATED</type>
                    <key>advanta_perf_avg</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <params>avg(&quot;web.page.perf[http://192.168.99.105/advanta/pages/Registration.aspx,]&quot;, 2100s)</params>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>mediawiki скорость открытия avg</name>
                    <type>CALCULATED</type>
                    <key>mediawiki_perf_avg</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <params>avg(&quot;web.page.perf[192.168.99.5,/mediawiki/index.php,]&quot;, 2100s)</params>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>otrs скорость открытия avg</name>
                    <type>CALCULATED</type>
                    <key>otrs_perf_avg</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <params>avg(&quot;web.page.perf[192.168.99.3,/otrs/index.pl?Action=AgentDashboard,]&quot;, 2100s)</params>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>otrs скорость открытия</name>
                    <key>web.page.perf[192.168.99.3,/otrs/index.pl?Action=AgentDashboard,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>webmail скорость открытия</name>
                    <key>web.page.perf[192.168.99.3,/webmail/,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>mediawiki скорость открытия</name>
                    <key>web.page.perf[192.168.99.5,/mediawiki/index.php,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>zabbix скорость открытия</name>
                    <key>web.page.perf[192.168.99.5,/zabbix/,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>advanta скорость открытия</name>
                    <key>web.page.perf[http://192.168.99.105/advanta/pages/Registration.aspx,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>webmail скорость открытия avg</name>
                    <type>CALCULATED</type>
                    <key>webmail_perf_avg</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <params>avg(&quot;web.page.perf[192.168.99.3,/webmail/,]&quot;, 2100s)</params>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>zabbix скорость открытия avg</name>
                    <type>CALCULATED</type>
                    <key>zabbix_perf_avg</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <value_type>FLOAT</value_type>
                    <params>avg(&quot;web.page.perf[192.168.99.5,/zabbix/,]&quot;, 2100s)</params>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Windows_General</template>
            <name>Template_Windows_General</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Configuration</name>
                </application>
                <application>
                    <name>General</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Check of acvtivation</name>
                    <type>TRAP</type>
                    <key>act_windows</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Check usb disk</name>
                    <key>system.run[&quot;reg query HKLM\SYSTEM\Currentcontrolset\services\USBSTOR /v \&quot;Start\&quot;&quot;]</key>
                    <delay>120s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;Start    REG_DWORD    0x3&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{str(&quot;0x4&quot;)}=1</recovery_expression>
                            <name>USB flash store detected</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Motherboard</name>
                    <key>system.run[&quot;wmic BaseBoard get manufacturer,product /format:value&quot;,]</key>
                    <delay>8h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Возвращает серию и модель материнской платы</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>var manufacturer = value.match(/Manufacturer=.{1,}(\n|\r)/g) !== null ? value.match(/Manufacturer=.{1,}(\n|\r)/g)[0]: &quot;&quot;
var product = value.match(/Product=.{1,}$/g) !== null ? value.match(/Product=.{1,}$/g)[0] : &quot;&quot;

result = manufacturer.slice(13, manufacturer.length).trim() + &quot;, &quot; + product.slice(product.search(&quot;=&quot;)+1, product.length).trim()
return result</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <name>Motherboard: last value isn't equal previous ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Motherboard: no data 12 hours ({HOST.IP})</name>
                                    <expression>{Template_Windows_General:system.run[&quot;wmic BaseBoard get manufacturer,product /format:value&quot;,].nodata(720m)}=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(720m)}=1</expression>
                            <name>Motherboard: no data 12 hours ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU (old)</name>
                    <key>system.run[wmic cpu get name /format:value]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>Возвращается модель процессора</description>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>TRIM</type>
                            <params>\n</params>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <params>Name=
</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
            </items>
        </template>
        <template>
            <template>Template_Windows_Memory</template>
            <name>Template_Windows_Memory</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Configuration</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Свободного места на C:</name>
                    <key>vfs.fs.size[c:,free]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;2G</expression>
                            <name>Кончается место на C:</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Всего места на C:</name>
                    <key>vfs.fs.size[c:,total]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Memory</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_PhysicalMemory]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Rank ({#SN})</name>
                            <key>wmi.get[root\cimv2,select attributes from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
SMBIOS - Type 17 - Attributes. Represents the RANK.&#13;
&#13;
This value comes from the Attributes member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Bank ({#SN})</name>
                            <key>wmi.get[root\cimv2,select BankLabel from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Physically labeled bank where the memory is located.&#13;
&#13;
Examples: &quot;Bank 0&quot;, &quot;Bank A&quot;&#13;
&#13;
This value comes from the Bank Locator member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Capacity ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Capacity from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Total capacity of the physical memory—in bytes.&#13;
&#13;
This value comes from the Memory Device structure in the SMBIOS version information. For SMBIOS versions 2.1 thru 2.6 the value comes from the Size member. For SMBIOS version 2.7+ the value comes from the Extended Size member.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Configured clock speed ({#SN})</name>
                            <key>wmi.get[root\cimv2,select ConfiguredClockSpeed from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The configured clock speed of the memory device, in megahertz (MHz), or 0, if the speed is unknown.&#13;
&#13;
This value comes from the Configured Memory Clock Speed member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Configured voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select ConfiguredVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Configured voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Configured voltage member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Module location ({#SN})</name>
                            <key>wmi.get[root\cimv2,select DeviceLocator from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
This value comes from the Device Locator member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Form factor ({#SN})</name>
                            <key>wmi.get[root\cimv2,select FormFactor from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Implementation form factor for the chip.&#13;
&#13;
This value comes from the Form Factor member of the Memory Device structure in the SMBIOS information.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 0){
   return &quot;Unknown&quot;
} else if (value == 1) {
   return &quot;Other&quot;
} else if (value == 7) {
   return &quot;SIMM&quot;
} else if (value == 8) {
   return &quot;DIMM&quot;
} else if (value == 12) {
   return &quot;SODIMM&quot;
} else if (value == 23) {
   return &quot;LGA&quot;
} else if (value == 24) {
   return &quot;FB-DIMM&quot;
} else {return &quot;Other type&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Manufacturer ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Manufacturer from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Name of the organization responsible for producing the physical element.&#13;
&#13;
This value comes from the Manufacturer member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Max voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select MaxVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The maximum operating voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Maximum voltage member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Min voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select MinVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The minimum operating voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Minimum voltage member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Part number ({#SN})</name>
                            <key>wmi.get[root\cimv2,select PartNumber from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Part number assigned by the organization responsible for producing or manufacturing the physical element.&#13;
&#13;
This value comes from the Part Number member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Serial number ({#SN})</name>
                            <key>wmi.get[root\cimv2,select serialnumber from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Manufacturer-allocated number to identify the physical element.&#13;
&#13;
This value comes from the Serial Number member of the Memory Device structure in the SMBIOS information.</description>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{change()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Memory: module serial number has been changed ({HOST.IP})</name>
                                    <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Memory type ({#SN})</name>
                            <key>wmi.get[root\cimv2,select SMBIOSMemoryType from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Type of physical memory. This is a CIM value that is mapped to the SMBIOS value. The SMBIOSMemoryType property contains the raw SMBIOS memory type.&#13;
&#13;
This value comes from the Memory Type member of the Memory Device structure in the SMBIOS information.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 0){
   return &quot;Unknown&quot;
} else if (value == 1) {
   return &quot;Other&quot;
} else if (value == 2) {
   return &quot;DRAM&quot;
} else if (value == 3) {
   return &quot;Synchronous DRAM&quot;
} else if (value == 4) {
   return &quot;Cache DRAM&quot;
} else if (value == 9) {
   return &quot;RAM&quot;
} else if (value == 10) {
   return &quot;ROM&quot;
} else if (value == 11) {
   return &quot;Flash&quot; 
} else if (value == 20) {
   return &quot;DDR&quot;
} else if (value == 21) {
   return &quot;DDR2&quot;
} else if (value == 22) {
   return &quot;DDR2 FB-DIMM&quot;
} else if (value == 24) {
   return &quot;DDR3&quot;
} else if (value == 25) {
   return &quot;FBD2&quot;
} else if (value == 26) {
   return &quot;DDR4&quot;
} else {return &quot;Other type&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Max clock speed ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Speed from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Speed of the physical memory in nanoseconds.&#13;
&#13;
This value comes from the Speed member of the Memory Device structure in the SMBIOS information.</description>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#SN}</lld_macro>
                            <path>$.SerialNumber</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TAG}</lld_macro>
                            <path>$.Tag</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template_Windows_Processor</template>
            <name>Template_Windows_Processor</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <name>CPU</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_Processor]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Architecture ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Architecture from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Processor architecture used by the platform.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 9) {
 return &quot;x64&quot;
} else if (value == 0) {
 return &quot;x86&quot;
} else if (value == 5) {
 return &quot;ARM&quot;
} else { return &quot;Other&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Caption ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Caption from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{change()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>CPU: caption has been changed ({HOST.IP})</name>
                                    <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Current clock ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select CurrentClockSpeed from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <value_type>FLOAT</value_type>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Current speed of the processor, in MHz. This value comes from the Current Speed member of the Processor Information structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Current voltage ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select CurrentVoltage from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <value_type>FLOAT</value_type>
                            <units>V</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Voltage of the processor. If the eighth bit is set, bits 0-6 contain the voltage multiplied by 10. If the eighth bit is not set, then the bit setting in VoltageCaps represents the voltage value.&#13;
CurrentVoltage is only set when SMBIOS designates a voltage value.</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.1</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>L2 cache size ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select L2CacheSize from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>L3 cache size ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select L3CacheSize from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Max clock ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select MaxClockSpeed from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <value_type>FLOAT</value_type>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Maximum speed of the processor, in MHz. This value comes from the Max Speed member of the Processor Information structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Name ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Name from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Label by which the object is known. When this property is a subclass, it can be overridden to be a key property.&#13;
This value comes from the Processor Version member of the Processor Information structure in the SMBIOS information.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of cores ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select NumberOfCores from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Number of cores for the current instance of the processor. A core is a physical processor on the integrated circuit. For example, in a dual-core processor this property has a value of 2.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of logical cores ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select NumberOfLogicalProcessors from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Number of logical processors for the current instance of the processor. For processors capable of hyperthreading, this value includes only the processors which have hyperthreading enabled.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Revision ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Revision from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
System revision level that depends on the architecture. The system revision level contains the same values as the Version property, but in a numerical format.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Virtualization fw ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select VirtualizationFirmwareEnabled from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
If True, the Firmware has enabled virtualization extensions. Windows Server 2008 R2, Windows 7, Windows Server 2008 and Windows Vista: This property is not supported before Windows 8 and Windows Server 2012.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == &quot;False&quot;) { return 0} else { return 1}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#DEVID}</lld_macro>
                            <path>$.DeviceID</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template_Windows_SHOP</template>
            <name>Template_Windows_SHOP</name>
            <templates>
                <template>
                    <name>Template_Windows_General</name>
                </template>
                <template>
                    <name>Template_Windows_Memory</name>
                </template>
                <template>
                    <name>Template_Windows_Processor</name>
                </template>
                <template>
                    <name>Template_Windows_SysInfo</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
        </template>
        <template>
            <template>Template_Windows_SHOP_orig</template>
            <name>Template_Windows_SHOP_orig</name>
            <description>общие параметры для компов с ОС Windows</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Configuration</name>
                </application>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Check of acvtivation</name>
                    <type>TRAP</type>
                    <key>act_windows</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Check usb disk</name>
                    <key>system.run[&quot;reg query HKLM\SYSTEM\Currentcontrolset\services\USBSTOR /v \&quot;Start\&quot;&quot;]</key>
                    <delay>120s</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(&quot;Start    REG_DWORD    0x3&quot;)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{str(&quot;0x4&quot;)}=1</recovery_expression>
                            <name>USB flash store detected</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Motherboard</name>
                    <key>system.run[&quot;wmic BaseBoard get manufacturer,product /format:value&quot;,]</key>
                    <delay>8h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Возвращает серию и модель материнской платы</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>var manufacturer = value.match(/Manufacturer=.{1,}(\n|\r)/g) !== null ? value.match(/Manufacturer=.{1,}(\n|\r)/g)[0]: &quot;&quot;
var product = value.match(/Product=.{1,}$/g) !== null ? value.match(/Product=.{1,}$/g)[0] : &quot;&quot;

result = manufacturer.slice(13, manufacturer.length).trim() + &quot;, &quot; + product.slice(product.search(&quot;=&quot;)+1, product.length).trim()
return result</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <name>Motherboard: last value isn't equal previous ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Motherboard: no data 12 hours ({HOST.IP})</name>
                                    <expression>{Template_Windows_SHOP_orig:system.run[&quot;wmic BaseBoard get manufacturer,product /format:value&quot;,].nodata(720m)}=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(720m)}=1</expression>
                            <name>Motherboard: no data 12 hours ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>CPU (old)</name>
                    <key>system.run[wmic cpu get name /format:value]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>Возвращается модель процессора</description>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>TRIM</type>
                            <params>\n</params>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <params>Name=
</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Admin rights</name>
                    <key>URV[{HOST.HOST}]</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Display the availability of admin rights.</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                        <application>
                            <name>OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>if (value == &quot;&quot;){return &quot;User hasn't admin right&quot;} else {return value}</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(&quot;User has admin rights&quot;,#1)}=1</expression>
                            <name>Admin rights: current user has admin rights ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Admin rights: no data 30 min ({HOST.IP})</name>
                                    <expression>{Template_Windows_SHOP_orig:URV[{HOST.HOST}].nodata(30m)}=1</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{nodata(30m)}=1</expression>
                            <name>Admin rights: no data 30 min ({HOST.IP})</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <description>IP - {HOST.IP}</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Свободного места на C:</name>
                    <key>vfs.fs.size[c:,free]</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&lt;2G</expression>
                            <name>Кончается место на C:</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Всего места на C:</name>
                    <key>vfs.fs.size[c:,total]</key>
                    <delay>3h</delay>
                    <history>7d</history>
                    <trends>30d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Configuration</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Operating system</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_OperatingSystem]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Build number</name>
                            <key>wmi.get[root\cimv2,select buildnumber from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Build number of an operating system. It can be used for more precise version information than product release version numbers.&#13;
&#13;
Example: &quot;1381&quot;</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Caption</name>
                            <key>wmi.get[root\cimv2,select caption from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Code page ID (IBM)</name>
                            <key>wmi.get[root\cimv2,select codeset from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/intl/code-page-identifiers&#13;
&#13;
Code page value an operating system uses. A code page contains a character table that an operating system uses to translate strings for different languages. The American National Standards Institute (ANSI) lists values that represent defined code pages. If an operating system does not use an ANSI code page, this member is set to 0 (zero). The CodeSet string can use a maximum of six characters to define the code page value.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 437) {
    return &quot;OEM United States&quot;
}
else if (value == 866) {
    return &quot;OEM Russian&quot;
}
else if (value == 1250) {
    return &quot;ANSI Central European&quot;
}
else if (value == 1251) {
    return &quot;ANSI Cyrillic&quot;
}
else if (value == 1252) {
    return &quot;ANSI Latin 1&quot;
}
else if (value == 20866) {
    return &quot;Russian (KOI8-R)&quot;
}
else if (value == 21866) {
    return &quot;Ukrainian (KOI8-U)&quot;
}
else if (value == 28591) {
    return &quot;ISO 8859-1 Latin 1&quot;
}
else if (value == 28595) {
    return &quot;ISO 8859-5 Cyrillic&quot;
}
else {return &quot;Rare code page&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Country code ID (IBM)</name>
                            <key>wmi.get[root\cimv2,select countrycode from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Code for the country/region that an operating system uses. Values are based on international phone dialing prefixes—also referred to as IBM country/region codes. This property can use a maximum of six characters to define the country/region code value.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Computer system name</name>
                            <key>wmi.get[root\cimv2,select CSName from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Timezone GMT</name>
                            <key>wmi.get[root\cimv2,select currenttimezone from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in minutes, an operating system is offset from Greenwich mean time (GMT). The number is positive, negative, or zero.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var p2 = /\d\d\d$/g;

var timezoneraw = value.match(p2) !== null ? value.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(0, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(0, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

return timezone
</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free physical memory</name>
                            <key>wmi.get[root\cimv2,select freephysicalmemory from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of physical memory currently unused and available</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space in pagefile</name>
                            <key>wmi.get[root\cimv2,select FreeSpaceInPagingFiles from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, that can be mapped into the operating system paging files without causing any other pages to be swapped out.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free virtual memory</name>
                            <key>wmi.get[root\cimv2,select FreeVirtualMemory from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory currently unused and available.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Install date</name>
                            <key>wmi.get[root\cimv2,select InstallDate from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory currently unused and available.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Last bootup time</name>
                            <key>wmi.get[root\cimv2,select LastBootUpTime from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
LastBootupTime property to determine how long the server has been active.&#13;
The sample also uses the timeout option to ensure that the WMI call does not hang.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Local datetime</name>
                            <key>wmi.get[root\cimv2,select LocalDateTime from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Operating system version of the local date and time-of-day.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Manufacturer</name>
                            <key>wmi.get[root\cimv2,select Manufacturer from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Name of the operating system manufacturer. For Windows-based systems, this value is &quot;Microsoft Corporation&quot;.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Architecture</name>
                            <key>wmi.get[root\cimv2,select OSArchitecture from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Architecture of the operating system, as opposed to the processor. This property can be localized.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Serial number</name>
                            <key>wmi.get[root\cimv2,select SerialNumber from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Operating system product serial identification number.&#13;
&#13;
Example: &quot;10497-OEM-0031416-71674&quot;</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>System drive</name>
                            <key>wmi.get[root\cimv2,select SystemDrive from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Letter of the disk drive on which the operating system resides. Example: &quot;C:&quot;</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total virtual memory</name>
                            <key>wmi.get[root\cimv2,select TotalVirtualMemorySize from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Total visible memory</name>
                            <key>wmi.get[root\cimv2,select TotalVisibleMemorySize from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Total amount, in kilobytes, of physical memory available to the operating system.</description>
                            <applications>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Version</name>
                            <key>wmi.get[root\cimv2,select Version from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Version number of the operating system.&#13;
&#13;
Example: &quot;4.0&quot;</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>OS</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#CSNAME}</lld_macro>
                            <path>$.CSName</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <name>Memory</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_PhysicalMemory]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Rank ({#SN})</name>
                            <key>wmi.get[root\cimv2,select attributes from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
SMBIOS - Type 17 - Attributes. Represents the RANK.&#13;
&#13;
This value comes from the Attributes member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Bank ({#SN})</name>
                            <key>wmi.get[root\cimv2,select BankLabel from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Physically labeled bank where the memory is located.&#13;
&#13;
Examples: &quot;Bank 0&quot;, &quot;Bank A&quot;&#13;
&#13;
This value comes from the Bank Locator member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Capacity ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Capacity from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Total capacity of the physical memory—in bytes.&#13;
&#13;
This value comes from the Memory Device structure in the SMBIOS version information. For SMBIOS versions 2.1 thru 2.6 the value comes from the Size member. For SMBIOS version 2.7+ the value comes from the Extended Size member.</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Configured clock speed ({#SN})</name>
                            <key>wmi.get[root\cimv2,select ConfiguredClockSpeed from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The configured clock speed of the memory device, in megahertz (MHz), or 0, if the speed is unknown.&#13;
&#13;
This value comes from the Configured Memory Clock Speed member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Configured voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select ConfiguredVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Configured voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Configured voltage member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Module location ({#SN})</name>
                            <key>wmi.get[root\cimv2,select DeviceLocator from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
This value comes from the Device Locator member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Form factor ({#SN})</name>
                            <key>wmi.get[root\cimv2,select FormFactor from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Implementation form factor for the chip.&#13;
&#13;
This value comes from the Form Factor member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 0){
   return &quot;Unknown&quot;
} else if (value == 1) {
   return &quot;Other&quot;
} else if (value == 7) {
   return &quot;SIMM&quot;
} else if (value == 8) {
   return &quot;DIMM&quot;
} else if (value == 12) {
   return &quot;SODIMM&quot;
} else if (value == 23) {
   return &quot;LGA&quot;
} else if (value == 24) {
   return &quot;FB-DIMM&quot;
} else {return &quot;Other type&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Manufacturer ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Manufacturer from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Name of the organization responsible for producing the physical element.&#13;
&#13;
This value comes from the Manufacturer member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>General</name>
                                </application>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Max voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select MaxVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The maximum operating voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Maximum voltage member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Min voltage ({#SN})</name>
                            <key>wmi.get[root\cimv2,select MinVoltage from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>!mV</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
The minimum operating voltage for this device, in millivolts, or 0, if the voltage is unknown.&#13;
&#13;
This value comes from the Minimum voltage member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Part number ({#SN})</name>
                            <key>wmi.get[root\cimv2,select PartNumber from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Part number assigned by the organization responsible for producing or manufacturing the physical element.&#13;
&#13;
This value comes from the Part Number member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Serial number ({#SN})</name>
                            <key>wmi.get[root\cimv2,select serialnumber from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Manufacturer-allocated number to identify the physical element.&#13;
&#13;
This value comes from the Serial Number member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{change()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Memory: module serial number has been changed ({HOST.IP})</name>
                                    <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Memory type ({#SN})</name>
                            <key>wmi.get[root\cimv2,select SMBIOSMemoryType from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Type of physical memory. This is a CIM value that is mapped to the SMBIOS value. The SMBIOSMemoryType property contains the raw SMBIOS memory type.&#13;
&#13;
This value comes from the Memory Type member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 0){
   return &quot;Unknown&quot;
} else if (value == 1) {
   return &quot;Other&quot;
} else if (value == 2) {
   return &quot;DRAM&quot;
} else if (value == 3) {
   return &quot;Synchronous DRAM&quot;
} else if (value == 4) {
   return &quot;Cache DRAM&quot;
} else if (value == 9) {
   return &quot;RAM&quot;
} else if (value == 10) {
   return &quot;ROM&quot;
} else if (value == 11) {
   return &quot;Flash&quot; 
} else if (value == 20) {
   return &quot;DDR&quot;
} else if (value == 21) {
   return &quot;DDR2&quot;
} else if (value == 22) {
   return &quot;DDR2 FB-DIMM&quot;
} else if (value == 24) {
   return &quot;DDR3&quot;
} else if (value == 25) {
   return &quot;FBD2&quot;
} else if (value == 26) {
   return &quot;DDR4&quot;
} else {return &quot;Other type&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Max clock speed ({#SN})</name>
                            <key>wmi.get[root\cimv2,select Speed from Win32_PhysicalMemory where serialnumber='{#SN}' and tag='{#TAG}' ]</key>
                            <delay>12h</delay>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-physicalmemory&#13;
&#13;
Speed of the physical memory in nanoseconds.&#13;
&#13;
This value comes from the Speed member of the Memory Device structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#SN}</lld_macro>
                            <path>$.SerialNumber</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TAG}</lld_macro>
                            <path>$.Tag</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <name>CPU</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_Processor]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Architecture ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Architecture from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Processor architecture used by the platform.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 9) {
 return &quot;x64&quot;
} else if (value == 0) {
 return &quot;x86&quot;
} else if (value == 5) {
 return &quot;ARM&quot;
} else { return &quot;Other&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Caption ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Caption from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{change()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>CPU: caption has been changed ({HOST.IP})</name>
                                    <opdata>Current value: {ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Current clock ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select CurrentClockSpeed from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <value_type>FLOAT</value_type>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Current speed of the processor, in MHz. This value comes from the Current Speed member of the Processor Information structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Current voltage ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select CurrentVoltage from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <value_type>FLOAT</value_type>
                            <units>V</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Voltage of the processor. If the eighth bit is set, bits 0-6 contain the voltage multiplied by 10. If the eighth bit is not set, then the bit setting in VoltageCaps represents the voltage value.&#13;
CurrentVoltage is only set when SMBIOS designates a voltage value.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.1</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>L2 cache size ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select L2CacheSize from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>L3 cache size ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select L3CacheSize from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Max clock ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select MaxClockSpeed from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <value_type>FLOAT</value_type>
                            <units>!MHz</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Maximum speed of the processor, in MHz. This value comes from the Max Speed member of the Processor Information structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Name ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Name from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Label by which the object is known. When this property is a subclass, it can be overridden to be a key property.&#13;
This value comes from the Processor Version member of the Processor Information structure in the SMBIOS information.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of cores ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select NumberOfCores from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Number of cores for the current instance of the processor. A core is a physical processor on the integrated circuit. For example, in a dual-core processor this property has a value of 2.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Number of logical cores ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select NumberOfLogicalProcessors from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
Number of logical processors for the current instance of the processor. For processors capable of hyperthreading, this value includes only the processors which have hyperthreading enabled.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Revision ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select Revision from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
System revision level that depends on the architecture. The system revision level contains the same values as the Version property, but in a numerical format.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Virtualization fw ({#DEVID})</name>
                            <key>wmi.get[root\cimv2,select VirtualizationFirmwareEnabled from Win32_Processor where DeviceID like '{#DEVID}']</key>
                            <delay>12h</delay>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processor&#13;
&#13;
If True, the Firmware has enabled virtualization extensions. Windows Server 2008 R2, Windows 7, Windows Server 2008 and Windows Vista: This property is not supported before Windows 8 and Windows Server 2012.</description>
                            <applications>
                                <application>
                                    <name>CPU</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == &quot;False&quot;) { return 0} else { return 1}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#DEVID}</lld_macro>
                            <path>$.DeviceID</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template_Windows_SysInfo</template>
            <name>Template_Windows_SysInfo</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <name>Operating system</name>
                    <key>wmi.getall[root\cimv2,select * from Win32_OperatingSystem]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Build number</name>
                            <key>wmi.get[root\cimv2,select buildnumber from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Build number of an operating system. It can be used for more precise version information than product release version numbers.&#13;
&#13;
Example: &quot;1381&quot;</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Caption</name>
                            <key>wmi.get[root\cimv2,select caption from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Code page ID (IBM)</name>
                            <key>wmi.get[root\cimv2,select codeset from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/intl/code-page-identifiers&#13;
&#13;
Code page value an operating system uses. A code page contains a character table that an operating system uses to translate strings for different languages. The American National Standards Institute (ANSI) lists values that represent defined code pages. If an operating system does not use an ANSI code page, this member is set to 0 (zero). The CodeSet string can use a maximum of six characters to define the code page value.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>if (value == 437) {
    return &quot;OEM United States&quot;
}
else if (value == 866) {
    return &quot;OEM Russian&quot;
}
else if (value == 1250) {
    return &quot;ANSI Central European&quot;
}
else if (value == 1251) {
    return &quot;ANSI Cyrillic&quot;
}
else if (value == 1252) {
    return &quot;ANSI Latin 1&quot;
}
else if (value == 20866) {
    return &quot;Russian (KOI8-R)&quot;
}
else if (value == 21866) {
    return &quot;Ukrainian (KOI8-U)&quot;
}
else if (value == 28591) {
    return &quot;ISO 8859-1 Latin 1&quot;
}
else if (value == 28595) {
    return &quot;ISO 8859-5 Cyrillic&quot;
}
else {return &quot;Rare code page&quot;}</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Country code ID (IBM)</name>
                            <key>wmi.get[root\cimv2,select countrycode from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Code for the country/region that an operating system uses. Values are based on international phone dialing prefixes—also referred to as IBM country/region codes. This property can use a maximum of six characters to define the country/region code value.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Computer system name</name>
                            <key>wmi.get[root\cimv2,select CSName from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Timezone GMT</name>
                            <key>wmi.get[root\cimv2,select currenttimezone from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in minutes, an operating system is offset from Greenwich mean time (GMT). The number is positive, negative, or zero.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var p2 = /\d\d\d$/g;

var timezoneraw = value.match(p2) !== null ? value.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(0, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(0, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

return timezone
</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free physical memory</name>
                            <key>wmi.get[root\cimv2,select freephysicalmemory from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of physical memory currently unused and available</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space in pagefile</name>
                            <key>wmi.get[root\cimv2,select FreeSpaceInPagingFiles from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, that can be mapped into the operating system paging files without causing any other pages to be swapped out.</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Free virtual memory</name>
                            <key>wmi.get[root\cimv2,select FreeVirtualMemory from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory currently unused and available.</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Install date</name>
                            <key>wmi.get[root\cimv2,select InstallDate from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory currently unused and available.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Last bootup time</name>
                            <key>wmi.get[root\cimv2,select LastBootUpTime from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
LastBootupTime property to determine how long the server has been active.&#13;
The sample also uses the timeout option to ensure that the WMI call does not hang.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Local datetime</name>
                            <key>wmi.get[root\cimv2,select LocalDateTime from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Operating system version of the local date and time-of-day.</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <params>var stroka2 = value;

var p1 = /\.\d{1,}(\+|\-)/g;
var p2 = /(\+|\-)\d\d\d$/g;

var year = stroka2.slice(0,4);
var month = stroka2.slice(4,6);
var day = stroka2.slice(6,8);

var hour = stroka2.slice(8,10);
var minute = stroka2.slice(10,12);
var second = stroka2.slice(12,14);

var msecond = stroka2.match(p1) !== null ? stroka2.match(p1)[0] : &quot;&quot; ;

if (msecond.length == 0){return &quot;Error in 'msecond' variable&quot;}

var timezoneraw = stroka2.match(p2) !== null ? stroka2.match(p2)[0] : &quot;&quot; ;

if (timezoneraw.length == 0){return &quot;Error in 'timezoneraw' variable&quot;}

var timezoneInt = Math.trunc(timezoneraw.slice(1, timezoneraw.length) / 60);

var timezoneRem = timezoneraw.slice(1, timezoneraw.length) % 60;

if (timezoneInt &lt; 10) {
  if (timezoneRem == 0) {
    var timezone = '0'+ (timezoneInt) +'00'
  } else {
    var timezone = '0' + (timezoneInt) + (timezoneRem)
  }
} else if (timezone &gt;= 10) {
  if (timezoneRem == 0) {
    var timezone = (timezoneInt) +'00';
  } else {
    var timezone = (timezoneInt) + (timezoneRem);
  }
}

var installData = &quot;&quot; + (year) + &quot;-&quot; + (month) + &quot;-&quot; + (day) + &quot; &quot; + (hour) + &quot;:&quot; + (minute) + &quot;:&quot; + (second) + (msecond.slice(0, msecond.length-1)) + (timezoneraw[0]) + (timezone);

if (installData) {return installData}

</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Manufacturer</name>
                            <key>wmi.get[root\cimv2,select Manufacturer from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Name of the operating system manufacturer. For Windows-based systems, this value is &quot;Microsoft Corporation&quot;.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Architecture</name>
                            <key>wmi.get[root\cimv2,select OSArchitecture from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Architecture of the operating system, as opposed to the processor. This property can be localized.</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Serial number</name>
                            <key>wmi.get[root\cimv2,select SerialNumber from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Operating system product serial identification number.&#13;
&#13;
Example: &quot;10497-OEM-0031416-71674&quot;</description>
                        </item_prototype>
                        <item_prototype>
                            <name>System drive</name>
                            <key>wmi.get[root\cimv2,select SystemDrive from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Letter of the disk drive on which the operating system resides. Example: &quot;C:&quot;</description>
                        </item_prototype>
                        <item_prototype>
                            <name>Total virtual memory</name>
                            <key>wmi.get[root\cimv2,select TotalVirtualMemorySize from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Number, in kilobytes, of virtual memory.</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Total visible memory</name>
                            <key>wmi.get[root\cimv2,select TotalVisibleMemorySize from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <history>14d</history>
                            <units>b</units>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Total amount, in kilobytes, of physical memory available to the operating system.</description>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Version</name>
                            <key>wmi.get[root\cimv2,select Version from Win32_OperatingSystem where CSname like '{#CSNAME}']</key>
                            <delay>12h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>More info -&gt; https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-operatingsystem&#13;
&#13;
Version number of the operating system.&#13;
&#13;
Example: &quot;4.0&quot;</description>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#CSNAME}</lld_macro>
                            <path>$.CSName</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>Template_ZabbixAgent</template>
            <name>Template_ZabbixAgent</name>
            <description>Template contains elements to observer Zabbix agent status</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Zabbix Agent</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Zabbix Agent (Version)</name>
                    <key>agent.version</key>
                    <delay>3h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Zabbix Agent</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{regexp(&quot;^[3-5]\.[0-9]\.\d{1,2}$&quot;,#1)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(&quot;^[3-5]\.[0-9]\.\d{1,2}$&quot;,#1)}=1</recovery_expression>
                            <name>Zabbix Agent - старая версия  {ITEM.LASTVALUE1}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}&lt;&gt;1</expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен более 30 минут</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(1800s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 2 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(7200s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 5 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(18000s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Zabbix Agent (Availability)</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,agent,available]</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <description>Was before - agent.ping</description>
                    <applications>
                        <application>
                            <name>Zabbix Agent</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;1</expression>
                            <name>Zabbix Agent недоступен</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен более 30 минут</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(1800s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 2 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(7200s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 5 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(18000s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(1800s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Changed 21.02.20</description>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 2 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(7200s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 5 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(18000s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(7200s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <description>Changed 21.02.20</description>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 5 часов</name>
                                    <expression>{Template_ZabbixAgent:zabbix[host,agent,available].sum(18000s)}=0&#13;
and {Template_ZabbixAgent:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(18000s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <description>Changed 21.02.20</description>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
        <template>
            <template>Template_ZabbixAgent_SHOP</template>
            <name>Template_ZabbixAgent_SHOP</name>
            <description>Template contains elements to observer Zabbix agent status</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Zabbix Agent</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Zabbix Agent (Version)</name>
                    <key>agent.version</key>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>3h</description>
                    <applications>
                        <application>
                            <name>Zabbix Agent</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{regexp(&quot;^[3-5]\.[0-9]\.\d{1,2}$&quot;,#1)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{regexp(&quot;^[3-5]\.[0-9]\.\d{1,2}$&quot;,#1)}=1</recovery_expression>
                            <name>Zabbix Agent - старая версия  {ITEM.LASTVALUE1}</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Zabbix Agent</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>logrt[&quot;C:\Program Files\Zabbix agent\zabbix_agentd.log&quot;,,&quot;utf8&quot;,120,skip,,3,rotate]</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Zabbix Agent</name>
                        </application>
                    </applications>
                    <logtimefmt>pppppp:yyyymmdd:hhmmss.mmm</logtimefmt>
                </item>
                <item>
                    <name>Zabbix Agent (Availability)</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,agent,available]</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>90d</trends>
                    <description>Was before - agent.ping</description>
                    <applications>
                        <application>
                            <name>Zabbix Agent</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;1</expression>
                            <name>Zabbix Agent недоступен</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен более 30 минут</name>
                                    <expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].sum(1800s)}=0&#13;
and {Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(1800s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен более 30 минут</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Changed 21.02.20</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 2 часов</name>
                                    <expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].sum(7200s)}=0&#13;
and {Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(7200s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен больше 2 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>HIGH</priority>
                            <description>Changed 21.02.20</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Zabbix Agent недоступен больше 5 часов</name>
                                    <expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].sum(18000s)}=0&#13;
and {Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=0</expression>
                                    <recovery_expression>{Template_ZabbixAgent_SHOP:zabbix[host,agent,available].last()}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{sum(18000s)}=0&#13;
and {last()}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=1</recovery_expression>
                            <name>Zabbix Agent недоступен больше 5 часов</name>
                            <opdata>{ITEM.LASTVALUE}</opdata>
                            <priority>DISASTER</priority>
                            <description>Changed 21.02.20</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Недоступен</name>
                                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Template pfSense Active:pfsense.expected_carp_status.last()}&lt;&gt;0 and {Template pfSense Active:pfsense.value[carp_status].last()}&lt;&gt;{$EXPECTED_CARP_STATUS}</expression>
            <name>CARP Status not Expected on {HOST.NAME}</name>
            <priority>HIGH</priority>
            <description>pfSense CARP is not in the state Expected. This means that a failover could be in process.</description>
        </trigger>
        <trigger>
            <expression>{Template Module Linux generic by Zabbix agent:proc.num.last()}/{Template Module Linux generic by Zabbix agent:kernel.maxproc.last()}*100&gt;80</expression>
            <name>Getting closer to process limit (over 80% used)</name>
            <opdata>{ITEM.LASTVALUE1} active, {ITEM.LASTVALUE2} limit.</opdata>
            <priority>WARNING</priority>
        </trigger>
        <trigger>
            <expression>{Template Linux Container:ct.swap.size[free].min(5m)}&lt;{$SWAP.PFREE.MIN.WARN} and {Template Linux Container:ct.swap.size[total].last()}&gt;0</expression>
            <name>High swap space usage ( less than {$SWAP.PFREE.MIN.WARN}% free)</name>
            <opdata>Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}</opdata>
            <priority>WARNING</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{Template Module Linux memory by Zabbix agent:system.swap.size[,pfree].min(5m)}&lt;{$SWAP.PFREE.MIN.WARN} and {Template Module Linux memory by Zabbix agent:system.swap.size[,total].last()}&gt;0</expression>
            <name>High swap space usage (less than {$SWAP.PFREE.MIN.WARN}% free)</name>
            <opdata>Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}</opdata>
            <priority>WARNING</priority>
            <description>This trigger is ignored, if there is no swap configured</description>
            <dependencies>
                <dependency>
                    <name>High memory utilization (&gt;{$MEMORY.UTIL.MAX}% for 5m)</name>
                    <expression>{Template Module Linux memory by Zabbix agent:vm.memory.utilization.min(5m)}&gt;{$MEMORY.UTIL.MAX}</expression>
                </dependency>
                <dependency>
                    <name>Lack of available memory (&lt; {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})</name>
                    <expression>{Template Module Linux memory by Zabbix agent:vm.memory.size[available].min(5m)}&lt;{$MEMORY.AVAILABLE.MIN} and {Template Module Linux memory by Zabbix agent:vm.memory.size[total].last()}&gt;0</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template Linux Container:ct.memory.size[available].min(5m)}&lt;{$MEMORY.AVAILABLE.MIN} and {Template Linux Container:ct.memory.size[total].last()}&gt;0</expression>
            <name>Lack of available memory ( &lt; {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})</name>
            <opdata>Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}</opdata>
            <priority>AVERAGE</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{Template Module Linux memory by Zabbix agent:vm.memory.size[available].min(5m)}&lt;{$MEMORY.AVAILABLE.MIN} and {Template Module Linux memory by Zabbix agent:vm.memory.size[total].last()}&gt;0</expression>
            <name>Lack of available memory (&lt; {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})</name>
            <opdata>Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}</opdata>
            <priority>AVERAGE</priority>
        </trigger>
        <trigger>
            <expression>{Template Linux Container:ct.cpu.load[percpu,avg1].min(5m)}/{Template Linux Container:ct.cpu.num.last()}&gt;{$LOAD_AVG_PER_CPU.MAX.WARN}&#13;
and {Template Linux Container:ct.cpu.load[percpu,avg5].last()}&gt;0&#13;
and {Template Linux Container:ct.cpu.load[percpu,avg15].last()}&gt;0</expression>
            <name>Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)</name>
            <opdata>Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}</opdata>
            <priority>AVERAGE</priority>
            <description>Per CPU load average is too high. Your system may be slow to respond.</description>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg1].min(5m)}/{Template Module Linux CPU by Zabbix agent:system.cpu.num.last()}&gt;{$LOAD_AVG_PER_CPU.MAX.WARN}&#13;
and {Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg5].last()}&gt;0&#13;
and {Template Module Linux CPU by Zabbix agent:system.cpu.load[all,avg15].last()}&gt;0</expression>
            <name>Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)</name>
            <opdata>Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}</opdata>
            <priority>AVERAGE</priority>
            <description>Per CPU load average is too high. Your system may be slow to respond.</description>
        </trigger>
        <trigger>
            <expression>({Template pfSense Active:pfsense.value[system,version].last()}&lt;&gt;{Template pfSense Active:pfsense.value[system,installed_version].last()})=1</expression>
            <name>New Version Available on {HOST.NAME}</name>
            <priority>INFO</priority>
            <description>Noify of new version of pfsense available</description>
        </trigger>
        <trigger>
            <expression>{Template Module ICMP Ping:icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}].avg(900s)} &gt;= {$ICMP_LOSS_WARN}&#13;
and&#13;
{Template Module ICMP Ping:ping_loss_avg.last()}&gt;0&#13;
and&#13;
{Template Module ICMP Ping:icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}].last()}&gt;0&#13;
and&#13;
{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].sum(900s)}&gt;0.51</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template Module ICMP Ping:icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}].last(#2)}=0&#13;
and&#13;
 {Template Module ICMP Ping:icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}].last()}=0</recovery_expression>
            <name>Packet loss {$ICMP_LOSS_WARN}%+</name>
            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>Unavailable ({$ICMP.UNAVAILABLE}+)</name>
                    <expression>{Template Module ICMP Ping:icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}].max({$ICMP.UNAVAILABLE})}=0</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template SNMP Mikrotik HAP:mikrotik.uptime.prev()}&gt;{Template SNMP Mikrotik HAP:mikrotik.uptime.last()}</expression>
            <name>RouterOS: Device has been rebooted</name>
            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{Template SNMP Mikrotik HEX:mikrotik.uptime.prev()}&gt;{Template SNMP Mikrotik HEX:mikrotik.uptime.last()}</expression>
            <name>RouterOS: Device has been rebooted</name>
            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{Template SNMP Mikrotik HAP:runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;].iregexp(error)}=1&#13;
and &#13;
{Template SNMP Mikrotik HAP:mikrotik.uptime.last()}&gt;3600</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template SNMP Mikrotik HAP:runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;].iregexp(error)}=0</recovery_expression>
            <name>RouterOS: Update decetor error</name>
            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>RouterOS: Device has been rebooted</name>
                    <expression>{Template SNMP Mikrotik HAP:mikrotik.uptime.prev()}&gt;{Template SNMP Mikrotik HAP:mikrotik.uptime.last()}</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template SNMP Mikrotik HEX:runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;].iregexp(error)}=1&#13;
and &#13;
{Template SNMP Mikrotik HEX:mikrotik.uptime.last()}&gt;3600</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template SNMP Mikrotik HEX:runner_mikrotik_script.sh[&quot;--param&quot;,&quot;0&quot;,&quot;--ip&quot;,&quot;{HOST.IP}&quot;, &quot;--version&quot;, &quot;2&quot;, &quot;--scriptname&quot;, &quot;checkfwlatest&quot;].iregexp(error)}=0</recovery_expression>
            <name>RouterOS: Update decetor error</name>
            <opdata>Current value: {ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>RouterOS: Device has been rebooted</name>
                    <expression>{Template SNMP Mikrotik HEX:mikrotik.uptime.prev()}&gt;{Template SNMP Mikrotik HEX:mikrotik.uptime.last()}</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>({Template_Magaz_Prisma:service.info[MSSQLSERVER].last()}&lt;&gt;0 &#13;
and &#13;
{Template_Magaz_Prisma:service.info[MSSQLSERVER].last()}&lt;&gt;255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MySQL].last()}=255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[postgresql-9.4].last()}=255)&#13;
&#13;
or &#13;
&#13;
({Template_Magaz_Prisma:service.info[MySQL].last()}&lt;&gt;0 &#13;
and &#13;
{Template_Magaz_Prisma:service.info[MySQL].last()}&lt;&gt;255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MSSQLSERVER].last()}=255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[postgresql-9.4].last()}=255)&#13;
&#13;
or&#13;
&#13;
({Template_Magaz_Prisma:service.info[postgresql-9.4].last()}&lt;&gt;0 &#13;
and &#13;
{Template_Magaz_Prisma:service.info[postgresql-9.4].last()}&lt;&gt;255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MSSQLSERVER].last()}=255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MySQL].last()}=255)&#13;
&#13;
or &#13;
&#13;
({Template_Magaz_Prisma:service.info[postgresql-x64-9.4].last()}&lt;&gt;0 &#13;
and&#13;
{Template_Magaz_Prisma:service.info[postgresql-x64-9.4].last()}&lt;&gt;255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MSSQLSERVER].last()}=255&#13;
and&#13;
{Template_Magaz_Prisma:service.info[MySQL].last()}=255)</expression>
            <name>Недоступна БД</name>
            <priority>WARNING</priority>
        </trigger>
        <trigger>
            <expression>{Template_ICMP_Shop:icmppingloss[{HOST.IP},3].sum(1800s)}&gt;25&#13;
and&#13;
{Template_ICMP_Shop:ping_loss_avg.last()}&gt;0&#13;
and&#13;
{Template_ICMP_Shop:icmppingloss[{HOST.IP},3].last()}&gt;0&#13;
and&#13;
{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].sum(1800s)}=1</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template_ICMP_Shop:icmppingloss[{HOST.IP},3].last(#2)}=0&#13;
and&#13;
 {Template_ICMP_Shop:icmppingloss[{HOST.IP},3].last()}=0</recovery_expression>
            <name>Потеря пакетов больше 25%</name>
            <opdata>{ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>Недоступен</name>
                    <expression>{Template_ICMP_Shop:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template_Unifi_AP:icmppingloss[{HOST.IP},3].sum(1800s)}&gt;25&#13;
and&#13;
{Template_Unifi_AP:ping_loss_avg.last()}&gt;0&#13;
and&#13;
{Template_Unifi_AP:icmppingloss[{HOST.IP},3].last()}&gt;0&#13;
and&#13;
{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].sum(1800s)}=1</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template_Unifi_AP:icmppingloss[{HOST.IP},3].last(#2)}=0&#13;
and&#13;
 {Template_Unifi_AP:icmppingloss[{HOST.IP},3].last()}=0</recovery_expression>
            <name>Потеря пакетов больше 25%</name>
            <opdata>{ITEM.LASTVALUE}</opdata>
            <priority>INFO</priority>
            <manual_close>YES</manual_close>
            <dependencies>
                <dependency>
                    <name>Недоступен</name>
                    <expression>{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last(#2)}=0&#13;
and&#13;
{Template_Unifi_AP:icmpping[{HOST.IP},2,1000].last()}=0</expression>
                </dependency>
            </dependencies>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>Active Connections</name>
            <show_triggers>NO</show_triggers>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>Template pfSense Active</host>
                <key>pfsense.states.max</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FF2C27</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.states.current</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Active Connections (pie)</name>
            <width>600</width>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>5B5B5B</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.states.max</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FF2C27</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.states.current</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU jumps</name>
            <graph_items>
                <graph_item>
                    <color>009900</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.switches</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>000099</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.intr</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU jumps</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.switches</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.intr</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU jumps</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>009900</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.switches</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>000099</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.intr</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU load</name>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>FFA619</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.load[percpu,avg1]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>E86E30</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.load[percpu,avg5]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FF2F26</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.load[percpu,avg15]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU load</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.cpu.load[percpu,avg1]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FF8000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.cpu.load[percpu,avg5]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FF0000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.cpu.load[percpu,avg15]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>4000FF</color>
                    <yaxisside>RIGHT</yaxisside>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.cpu.num</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU usage</name>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,system]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,user]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,nice]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,iowait]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,steal]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>6C59DC</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,interrupt]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <color>AC8C14</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,softirq]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>7</sortorder>
                    <color>611F27</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,guest]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>8</sortorder>
                    <color>F230E0</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util[,guest_nice]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Cisco OLD-CISCO-CPU-MIB SNMP</host>
                        <key>system.cpu.util[avgBusy5]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.util</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU utilization</name>
            <show_triggers>NO</show_triggers>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>FF5555</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,steal]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>55FF55</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,softirq]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>009999</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,interrupt]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>990099</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,nice]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>999900</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,iowait]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>990000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,system]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>000099</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,user]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>7</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>009900</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>system.cpu.util[,idle]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU utilization (Line)</name>
            <show_triggers>NO</show_triggers>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FFE819</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.util[,interrupt]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>E85D17</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.util[,nice]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>DF26FF</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.util[,system]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1775E8</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.util[,user]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>03D933</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.cpu.util[,idle]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Disk usage</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>EE00EE</color>
                    <item>
                        <host>Template SNMP Mikrotik Global</host>
                        <key>mikrotik.total.disk.space</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>00CC00</color>
                    <item>
                        <host>Template SNMP Mikrotik Global</host>
                        <key>mikrotik.used.disk.space</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Disk usage</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>EE00EE</color>
                    <item>
                        <host>Template SNMP Mikrotik RB Office</host>
                        <key>mikrotik.total.disk.space</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>00CC00</color>
                    <item>
                        <host>Template SNMP Mikrotik RB Office</host>
                        <key>mikrotik.used.disk.space</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Host status</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template_Gate</host>
                        <key>icmpping[{HOST.IP},3,2000]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>LA over one min</name>
            <height>250</height>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>CC00CC</color>
                    <item>
                        <host>Template_Server_Linux1</host>
                        <key>system.cpu.load[,avg1]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory Available details (pie)</name>
            <width>600</width>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>003300</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[available]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>005500</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[free]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>007700</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[cached]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>009900</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[inactive]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>Template Linux Container</host>
                <key>ct.memory.size[total]</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>BB0000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.memory.size[total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00C800</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.memory.size[available]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00C800</color>
                    <item>
                        <host>Template SNMP Mikrotik RB Office</host>
                        <key>mikrotik.total.memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>FFCC00</color>
                    <item>
                        <host>Template SNMP Mikrotik RB Office</host>
                        <key>mikrotik.used.memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux memory by Zabbix agent</host>
                        <key>vm.memory.size[total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux memory by Zabbix agent</host>
                        <key>vm.memory.size[available]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <show_triggers>NO</show_triggers>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>Template pfSense Active</host>
                <key>vm.memory.size[total]</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <color>00EE00</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[wired]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>00CC00</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[active]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>007700</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[inactive]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>005500</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[cached]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>003300</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[free]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00C800</color>
                    <item>
                        <host>Template SNMP Mikrotik Global</host>
                        <key>mikrotik.total.memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>FFCC00</color>
                    <item>
                        <host>Template SNMP Mikrotik Global</host>
                        <key>mikrotik.used.memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory Usage simple (pie)</name>
            <width>600</width>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>003300</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>vm.memory.size[available]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>00DD00</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>kt.mem.used</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage v2</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>199C0D</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.memory.size[used]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.memory.size[total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.memory.size[cached]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux memory by Zabbix agent</host>
                        <key>vm.memory.utilization</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Network Memory Buffer</name>
            <show_triggers>NO</show_triggers>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>Template pfSense Active</host>
                <key>pfsense.mbuf.max</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <color>B26E16</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.mbuf.current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FFCE8E</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.mbuf.cache</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Network Memory Buffer (pie)</name>
            <width>600</width>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>5B5B5B</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.mbuf.max</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FFCE8E</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.mbuf.cache</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>B26E16</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>pfsense.mbuf.current</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Node status</name>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>icmpping[{HOST.IP},{$ICMP.PACKET.COUNT},{$ICMP.PACKET.SIZE}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Packet loss % [all]</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>ping_loss_avg</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Packet loss % [avg]</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>ping_loss_avg</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>icmppingloss[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Processes</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux generic by Zabbix agent</host>
                        <key>proc.num</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux generic by Zabbix agent</host>
                        <key>proc.num[,,run]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Module Linux generic by Zabbix agent</host>
                        <key>kernel.maxproc</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Response time (ms) [all]</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>ping_avg</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Response time (ms) [avg]</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>ping_avg</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Module ICMP Ping</host>
                        <key>icmppingsec[{HOST.IP},{$ICMP.PACKET.COUNT2}]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Swap usage</name>
            <width>600</width>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <show_3d>YES</show_3d>
            <graph_items>
                <graph_item>
                    <color>5B5B5B</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.swap.size[,total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FFFF33</color>
                    <item>
                        <host>Template pfSense Active</host>
                        <key>system.swap.size[,used]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Swap usage</name>
            <height>340</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>AA0000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.swap.size[used]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>00AA00</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.swap.size[total]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Swap usage</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux memory by Zabbix agent</host>
                        <key>system.swap.size[,free]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux memory by Zabbix agent</host>
                        <key>system.swap.size[,total]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Swap usage v2</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>FF8000</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.swap.size[used]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Template Linux Container</host>
                        <key>ct.swap.size[total]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>System health: temperature</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00C800</color>
                    <item>
                        <host>Template SNMP Mikrotik RB Office</host>
                        <key>mikrotik.temperature</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>System health: temperature</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00C800</color>
                    <item>
                        <host>Template SNMP Mikrotik HEX</host>
                        <key>mikrotik.temperature</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>System load</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.load[all,avg1]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.load[all,avg5]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.load[all,avg15]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>A54F10</color>
                    <yaxisside>RIGHT</yaxisside>
                    <item>
                        <host>Template Module Linux CPU by Zabbix agent</host>
                        <key>system.cpu.num</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Доступность сервисов безналичной оплаты в магазине</name>
            <yaxismin>-2</yaxismin>
            <yaxismax>2</yaxismax>
            <percent_left>5</percent_left>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>AED581</color>
                    <item>
                        <host>Template_Magaz_Server</host>
                        <key>first_sber_ip</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>03A9F4</color>
                    <item>
                        <host>Template_Magaz_Server</host>
                        <key>secondary_sber_ip</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Доступность сервисов безналичной оплаты в магазине</name>
            <yaxismin>-2</yaxismin>
            <yaxismax>2</yaxismax>
            <percent_left>5</percent_left>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>AED581</color>
                    <item>
                        <host>Template_Magaz_Server_Borovskaya</host>
                        <key>first_sber_ip</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>03A9F4</color>
                    <item>
                        <host>Template_Magaz_Server_Borovskaya</host>
                        <key>secondary_sber_ip</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>CISCO-ENVMON-MIB::CiscoEnvMonState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>normal</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>warning</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>critical</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>shutdown</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>notPresent</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>notFunctioning</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>EtherLike-MIB::dot3StatsDuplexStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>halfDuplex</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>fullDuplex</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Generic YesNo</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>No</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Yes</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>IF-MIB::ifOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>dormant</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>notPresent</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>lowerLayerDown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>IF-MIB::ifType</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>other</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>regular1822</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>hdh1822</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>ddnX25</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>rfc877x25</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>ethernetCsmacd</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>iso88023Csmacd</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>iso88024TokenBus</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>iso88025TokenRing</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>iso88026Man</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>starLan</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>proteon10Mbit</newvalue>
                </mapping>
                <mapping>
                    <value>13</value>
                    <newvalue>proteon80Mbit</newvalue>
                </mapping>
                <mapping>
                    <value>14</value>
                    <newvalue>hyperchannel</newvalue>
                </mapping>
                <mapping>
                    <value>15</value>
                    <newvalue>fddi</newvalue>
                </mapping>
                <mapping>
                    <value>16</value>
                    <newvalue>lapb</newvalue>
                </mapping>
                <mapping>
                    <value>17</value>
                    <newvalue>sdlc</newvalue>
                </mapping>
                <mapping>
                    <value>18</value>
                    <newvalue>ds1</newvalue>
                </mapping>
                <mapping>
                    <value>19</value>
                    <newvalue>e1</newvalue>
                </mapping>
                <mapping>
                    <value>20</value>
                    <newvalue>basicISDN</newvalue>
                </mapping>
                <mapping>
                    <value>21</value>
                    <newvalue>primaryISDN</newvalue>
                </mapping>
                <mapping>
                    <value>22</value>
                    <newvalue>propPointToPointSerial</newvalue>
                </mapping>
                <mapping>
                    <value>23</value>
                    <newvalue>ppp</newvalue>
                </mapping>
                <mapping>
                    <value>24</value>
                    <newvalue>softwareLoopback</newvalue>
                </mapping>
                <mapping>
                    <value>25</value>
                    <newvalue>eon</newvalue>
                </mapping>
                <mapping>
                    <value>26</value>
                    <newvalue>ethernet3Mbit</newvalue>
                </mapping>
                <mapping>
                    <value>27</value>
                    <newvalue>nsip</newvalue>
                </mapping>
                <mapping>
                    <value>28</value>
                    <newvalue>slip</newvalue>
                </mapping>
                <mapping>
                    <value>29</value>
                    <newvalue>ultra</newvalue>
                </mapping>
                <mapping>
                    <value>30</value>
                    <newvalue>ds3</newvalue>
                </mapping>
                <mapping>
                    <value>31</value>
                    <newvalue>sip</newvalue>
                </mapping>
                <mapping>
                    <value>32</value>
                    <newvalue>frameRelay</newvalue>
                </mapping>
                <mapping>
                    <value>33</value>
                    <newvalue>rs232</newvalue>
                </mapping>
                <mapping>
                    <value>34</value>
                    <newvalue>para</newvalue>
                </mapping>
                <mapping>
                    <value>35</value>
                    <newvalue>arcnet</newvalue>
                </mapping>
                <mapping>
                    <value>36</value>
                    <newvalue>arcnetPlus</newvalue>
                </mapping>
                <mapping>
                    <value>37</value>
                    <newvalue>atm</newvalue>
                </mapping>
                <mapping>
                    <value>38</value>
                    <newvalue>miox25</newvalue>
                </mapping>
                <mapping>
                    <value>39</value>
                    <newvalue>sonet</newvalue>
                </mapping>
                <mapping>
                    <value>40</value>
                    <newvalue>x25ple</newvalue>
                </mapping>
                <mapping>
                    <value>41</value>
                    <newvalue>iso88022llc</newvalue>
                </mapping>
                <mapping>
                    <value>42</value>
                    <newvalue>localTalk</newvalue>
                </mapping>
                <mapping>
                    <value>43</value>
                    <newvalue>smdsDxi</newvalue>
                </mapping>
                <mapping>
                    <value>44</value>
                    <newvalue>frameRelayService</newvalue>
                </mapping>
                <mapping>
                    <value>45</value>
                    <newvalue>v35</newvalue>
                </mapping>
                <mapping>
                    <value>46</value>
                    <newvalue>hssi</newvalue>
                </mapping>
                <mapping>
                    <value>47</value>
                    <newvalue>hippi</newvalue>
                </mapping>
                <mapping>
                    <value>48</value>
                    <newvalue>modem</newvalue>
                </mapping>
                <mapping>
                    <value>49</value>
                    <newvalue>aal5</newvalue>
                </mapping>
                <mapping>
                    <value>50</value>
                    <newvalue>sonetPath</newvalue>
                </mapping>
                <mapping>
                    <value>51</value>
                    <newvalue>sonetVT</newvalue>
                </mapping>
                <mapping>
                    <value>52</value>
                    <newvalue>smdsIcip</newvalue>
                </mapping>
                <mapping>
                    <value>53</value>
                    <newvalue>propVirtual</newvalue>
                </mapping>
                <mapping>
                    <value>54</value>
                    <newvalue>propMultiplexor</newvalue>
                </mapping>
                <mapping>
                    <value>55</value>
                    <newvalue>ieee80212</newvalue>
                </mapping>
                <mapping>
                    <value>56</value>
                    <newvalue>fibreChannel</newvalue>
                </mapping>
                <mapping>
                    <value>57</value>
                    <newvalue>hippiInterface</newvalue>
                </mapping>
                <mapping>
                    <value>58</value>
                    <newvalue>frameRelayInterconnect</newvalue>
                </mapping>
                <mapping>
                    <value>59</value>
                    <newvalue>aflane8023</newvalue>
                </mapping>
                <mapping>
                    <value>60</value>
                    <newvalue>aflane8025</newvalue>
                </mapping>
                <mapping>
                    <value>61</value>
                    <newvalue>cctEmul</newvalue>
                </mapping>
                <mapping>
                    <value>62</value>
                    <newvalue>fastEther</newvalue>
                </mapping>
                <mapping>
                    <value>63</value>
                    <newvalue>isdn</newvalue>
                </mapping>
                <mapping>
                    <value>64</value>
                    <newvalue>v11</newvalue>
                </mapping>
                <mapping>
                    <value>65</value>
                    <newvalue>v36</newvalue>
                </mapping>
                <mapping>
                    <value>66</value>
                    <newvalue>g703at64k</newvalue>
                </mapping>
                <mapping>
                    <value>67</value>
                    <newvalue>g703at2mb</newvalue>
                </mapping>
                <mapping>
                    <value>68</value>
                    <newvalue>qllc</newvalue>
                </mapping>
                <mapping>
                    <value>69</value>
                    <newvalue>fastEtherFX</newvalue>
                </mapping>
                <mapping>
                    <value>70</value>
                    <newvalue>channel</newvalue>
                </mapping>
                <mapping>
                    <value>71</value>
                    <newvalue>ieee80211</newvalue>
                </mapping>
                <mapping>
                    <value>72</value>
                    <newvalue>ibm370parChan</newvalue>
                </mapping>
                <mapping>
                    <value>73</value>
                    <newvalue>escon</newvalue>
                </mapping>
                <mapping>
                    <value>74</value>
                    <newvalue>dlsw</newvalue>
                </mapping>
                <mapping>
                    <value>75</value>
                    <newvalue>isdns</newvalue>
                </mapping>
                <mapping>
                    <value>76</value>
                    <newvalue>isdnu</newvalue>
                </mapping>
                <mapping>
                    <value>77</value>
                    <newvalue>lapd</newvalue>
                </mapping>
                <mapping>
                    <value>78</value>
                    <newvalue>ipSwitch</newvalue>
                </mapping>
                <mapping>
                    <value>79</value>
                    <newvalue>rsrb</newvalue>
                </mapping>
                <mapping>
                    <value>80</value>
                    <newvalue>atmLogical</newvalue>
                </mapping>
                <mapping>
                    <value>81</value>
                    <newvalue>ds0</newvalue>
                </mapping>
                <mapping>
                    <value>82</value>
                    <newvalue>ds0Bundle</newvalue>
                </mapping>
                <mapping>
                    <value>83</value>
                    <newvalue>bsc</newvalue>
                </mapping>
                <mapping>
                    <value>84</value>
                    <newvalue>async</newvalue>
                </mapping>
                <mapping>
                    <value>85</value>
                    <newvalue>cnr</newvalue>
                </mapping>
                <mapping>
                    <value>86</value>
                    <newvalue>iso88025Dtr</newvalue>
                </mapping>
                <mapping>
                    <value>87</value>
                    <newvalue>eplrs</newvalue>
                </mapping>
                <mapping>
                    <value>88</value>
                    <newvalue>arap</newvalue>
                </mapping>
                <mapping>
                    <value>89</value>
                    <newvalue>propCnls</newvalue>
                </mapping>
                <mapping>
                    <value>90</value>
                    <newvalue>hostPad</newvalue>
                </mapping>
                <mapping>
                    <value>91</value>
                    <newvalue>termPad</newvalue>
                </mapping>
                <mapping>
                    <value>92</value>
                    <newvalue>frameRelayMPI</newvalue>
                </mapping>
                <mapping>
                    <value>93</value>
                    <newvalue>x213</newvalue>
                </mapping>
                <mapping>
                    <value>94</value>
                    <newvalue>adsl</newvalue>
                </mapping>
                <mapping>
                    <value>95</value>
                    <newvalue>radsl</newvalue>
                </mapping>
                <mapping>
                    <value>96</value>
                    <newvalue>sdsl</newvalue>
                </mapping>
                <mapping>
                    <value>97</value>
                    <newvalue>vdsl</newvalue>
                </mapping>
                <mapping>
                    <value>98</value>
                    <newvalue>iso88025CRFPInt</newvalue>
                </mapping>
                <mapping>
                    <value>99</value>
                    <newvalue>myrinet</newvalue>
                </mapping>
                <mapping>
                    <value>100</value>
                    <newvalue>voiceEM</newvalue>
                </mapping>
                <mapping>
                    <value>101</value>
                    <newvalue>voiceFXO</newvalue>
                </mapping>
                <mapping>
                    <value>102</value>
                    <newvalue>voiceFXS</newvalue>
                </mapping>
                <mapping>
                    <value>103</value>
                    <newvalue>voiceEncap</newvalue>
                </mapping>
                <mapping>
                    <value>104</value>
                    <newvalue>voiceOverIp</newvalue>
                </mapping>
                <mapping>
                    <value>105</value>
                    <newvalue>atmDxi</newvalue>
                </mapping>
                <mapping>
                    <value>106</value>
                    <newvalue>atmFuni</newvalue>
                </mapping>
                <mapping>
                    <value>107</value>
                    <newvalue>atmIma</newvalue>
                </mapping>
                <mapping>
                    <value>108</value>
                    <newvalue>pppMultilinkBundle</newvalue>
                </mapping>
                <mapping>
                    <value>109</value>
                    <newvalue>ipOverCdlc</newvalue>
                </mapping>
                <mapping>
                    <value>110</value>
                    <newvalue>ipOverClaw</newvalue>
                </mapping>
                <mapping>
                    <value>111</value>
                    <newvalue>stackToStack</newvalue>
                </mapping>
                <mapping>
                    <value>112</value>
                    <newvalue>virtualIpAddress</newvalue>
                </mapping>
                <mapping>
                    <value>113</value>
                    <newvalue>mpc</newvalue>
                </mapping>
                <mapping>
                    <value>114</value>
                    <newvalue>ipOverAtm</newvalue>
                </mapping>
                <mapping>
                    <value>115</value>
                    <newvalue>iso88025Fiber</newvalue>
                </mapping>
                <mapping>
                    <value>116</value>
                    <newvalue>tdlc</newvalue>
                </mapping>
                <mapping>
                    <value>117</value>
                    <newvalue>gigabitEthernet</newvalue>
                </mapping>
                <mapping>
                    <value>118</value>
                    <newvalue>hdlc</newvalue>
                </mapping>
                <mapping>
                    <value>119</value>
                    <newvalue>lapf</newvalue>
                </mapping>
                <mapping>
                    <value>120</value>
                    <newvalue>v37</newvalue>
                </mapping>
                <mapping>
                    <value>121</value>
                    <newvalue>x25mlp</newvalue>
                </mapping>
                <mapping>
                    <value>122</value>
                    <newvalue>x25huntGroup</newvalue>
                </mapping>
                <mapping>
                    <value>123</value>
                    <newvalue>trasnpHdlc</newvalue>
                </mapping>
                <mapping>
                    <value>124</value>
                    <newvalue>interleave</newvalue>
                </mapping>
                <mapping>
                    <value>125</value>
                    <newvalue>fast</newvalue>
                </mapping>
                <mapping>
                    <value>126</value>
                    <newvalue>ip</newvalue>
                </mapping>
                <mapping>
                    <value>127</value>
                    <newvalue>docsCableMaclayer</newvalue>
                </mapping>
                <mapping>
                    <value>128</value>
                    <newvalue>docsCableDownstream</newvalue>
                </mapping>
                <mapping>
                    <value>129</value>
                    <newvalue>docsCableUpstream</newvalue>
                </mapping>
                <mapping>
                    <value>130</value>
                    <newvalue>a12MppSwitch</newvalue>
                </mapping>
                <mapping>
                    <value>131</value>
                    <newvalue>tunnel</newvalue>
                </mapping>
                <mapping>
                    <value>132</value>
                    <newvalue>coffee</newvalue>
                </mapping>
                <mapping>
                    <value>133</value>
                    <newvalue>ces</newvalue>
                </mapping>
                <mapping>
                    <value>134</value>
                    <newvalue>atmSubInterface</newvalue>
                </mapping>
                <mapping>
                    <value>135</value>
                    <newvalue>l2vlan</newvalue>
                </mapping>
                <mapping>
                    <value>136</value>
                    <newvalue>l3ipvlan</newvalue>
                </mapping>
                <mapping>
                    <value>137</value>
                    <newvalue>l3ipxvlan</newvalue>
                </mapping>
                <mapping>
                    <value>138</value>
                    <newvalue>digitalPowerline</newvalue>
                </mapping>
                <mapping>
                    <value>139</value>
                    <newvalue>mediaMailOverIp</newvalue>
                </mapping>
                <mapping>
                    <value>140</value>
                    <newvalue>dtm</newvalue>
                </mapping>
                <mapping>
                    <value>141</value>
                    <newvalue>dcn</newvalue>
                </mapping>
                <mapping>
                    <value>142</value>
                    <newvalue>ipForward</newvalue>
                </mapping>
                <mapping>
                    <value>143</value>
                    <newvalue>msdsl</newvalue>
                </mapping>
                <mapping>
                    <value>144</value>
                    <newvalue>ieee1394</newvalue>
                </mapping>
                <mapping>
                    <value>145</value>
                    <newvalue>if-gsn</newvalue>
                </mapping>
                <mapping>
                    <value>146</value>
                    <newvalue>dvbRccMacLayer</newvalue>
                </mapping>
                <mapping>
                    <value>147</value>
                    <newvalue>dvbRccDownstream</newvalue>
                </mapping>
                <mapping>
                    <value>148</value>
                    <newvalue>dvbRccUpstream</newvalue>
                </mapping>
                <mapping>
                    <value>149</value>
                    <newvalue>atmVirtual</newvalue>
                </mapping>
                <mapping>
                    <value>150</value>
                    <newvalue>mplsTunnel</newvalue>
                </mapping>
                <mapping>
                    <value>151</value>
                    <newvalue>srp</newvalue>
                </mapping>
                <mapping>
                    <value>152</value>
                    <newvalue>voiceOverAtm</newvalue>
                </mapping>
                <mapping>
                    <value>153</value>
                    <newvalue>voiceOverFrameRelay</newvalue>
                </mapping>
                <mapping>
                    <value>154</value>
                    <newvalue>idsl</newvalue>
                </mapping>
                <mapping>
                    <value>155</value>
                    <newvalue>compositeLink</newvalue>
                </mapping>
                <mapping>
                    <value>156</value>
                    <newvalue>ss7SigLink</newvalue>
                </mapping>
                <mapping>
                    <value>157</value>
                    <newvalue>propWirelessP2P</newvalue>
                </mapping>
                <mapping>
                    <value>158</value>
                    <newvalue>frForward</newvalue>
                </mapping>
                <mapping>
                    <value>159</value>
                    <newvalue>rfc1483</newvalue>
                </mapping>
                <mapping>
                    <value>160</value>
                    <newvalue>usb</newvalue>
                </mapping>
                <mapping>
                    <value>161</value>
                    <newvalue>ieee8023adLag</newvalue>
                </mapping>
                <mapping>
                    <value>162</value>
                    <newvalue>bgppolicyaccounting</newvalue>
                </mapping>
                <mapping>
                    <value>163</value>
                    <newvalue>frf16MfrBundle</newvalue>
                </mapping>
                <mapping>
                    <value>164</value>
                    <newvalue>h323Gatekeeper</newvalue>
                </mapping>
                <mapping>
                    <value>165</value>
                    <newvalue>h323Proxy</newvalue>
                </mapping>
                <mapping>
                    <value>166</value>
                    <newvalue>mpls</newvalue>
                </mapping>
                <mapping>
                    <value>167</value>
                    <newvalue>mfSigLink</newvalue>
                </mapping>
                <mapping>
                    <value>168</value>
                    <newvalue>hdsl2</newvalue>
                </mapping>
                <mapping>
                    <value>169</value>
                    <newvalue>shdsl</newvalue>
                </mapping>
                <mapping>
                    <value>170</value>
                    <newvalue>ds1FDL</newvalue>
                </mapping>
                <mapping>
                    <value>171</value>
                    <newvalue>pos</newvalue>
                </mapping>
                <mapping>
                    <value>172</value>
                    <newvalue>dvbAsiIn</newvalue>
                </mapping>
                <mapping>
                    <value>173</value>
                    <newvalue>dvbAsiOut</newvalue>
                </mapping>
                <mapping>
                    <value>174</value>
                    <newvalue>plc</newvalue>
                </mapping>
                <mapping>
                    <value>175</value>
                    <newvalue>nfas</newvalue>
                </mapping>
                <mapping>
                    <value>176</value>
                    <newvalue>tr008</newvalue>
                </mapping>
                <mapping>
                    <value>177</value>
                    <newvalue>gr303RDT</newvalue>
                </mapping>
                <mapping>
                    <value>178</value>
                    <newvalue>gr303IDT</newvalue>
                </mapping>
                <mapping>
                    <value>179</value>
                    <newvalue>isup</newvalue>
                </mapping>
                <mapping>
                    <value>180</value>
                    <newvalue>propDocsWirelessMaclayer</newvalue>
                </mapping>
                <mapping>
                    <value>181</value>
                    <newvalue>propDocsWirelessDownstream</newvalue>
                </mapping>
                <mapping>
                    <value>182</value>
                    <newvalue>propDocsWirelessUpstream</newvalue>
                </mapping>
                <mapping>
                    <value>183</value>
                    <newvalue>hiperlan2</newvalue>
                </mapping>
                <mapping>
                    <value>184</value>
                    <newvalue>propBWAp2Mp</newvalue>
                </mapping>
                <mapping>
                    <value>185</value>
                    <newvalue>sonetOverheadChannel</newvalue>
                </mapping>
                <mapping>
                    <value>186</value>
                    <newvalue>digitalWrapperOverheadChannel</newvalue>
                </mapping>
                <mapping>
                    <value>187</value>
                    <newvalue>aal2</newvalue>
                </mapping>
                <mapping>
                    <value>188</value>
                    <newvalue>radioMAC</newvalue>
                </mapping>
                <mapping>
                    <value>189</value>
                    <newvalue>atmRadio</newvalue>
                </mapping>
                <mapping>
                    <value>190</value>
                    <newvalue>imt</newvalue>
                </mapping>
                <mapping>
                    <value>191</value>
                    <newvalue>mvl</newvalue>
                </mapping>
                <mapping>
                    <value>192</value>
                    <newvalue>reachDSL</newvalue>
                </mapping>
                <mapping>
                    <value>193</value>
                    <newvalue>frDlciEndPt</newvalue>
                </mapping>
                <mapping>
                    <value>194</value>
                    <newvalue>atmVciEndPt</newvalue>
                </mapping>
                <mapping>
                    <value>195</value>
                    <newvalue>opticalChannel</newvalue>
                </mapping>
                <mapping>
                    <value>196</value>
                    <newvalue>opticalTransport</newvalue>
                </mapping>
                <mapping>
                    <value>197</value>
                    <newvalue>propAtm</newvalue>
                </mapping>
                <mapping>
                    <value>198</value>
                    <newvalue>voiceOverCable</newvalue>
                </mapping>
                <mapping>
                    <value>199</value>
                    <newvalue>infiniband</newvalue>
                </mapping>
                <mapping>
                    <value>200</value>
                    <newvalue>teLink</newvalue>
                </mapping>
                <mapping>
                    <value>201</value>
                    <newvalue>q2931</newvalue>
                </mapping>
                <mapping>
                    <value>202</value>
                    <newvalue>virtualTg</newvalue>
                </mapping>
                <mapping>
                    <value>203</value>
                    <newvalue>sipTg</newvalue>
                </mapping>
                <mapping>
                    <value>204</value>
                    <newvalue>sipSig</newvalue>
                </mapping>
                <mapping>
                    <value>205</value>
                    <newvalue>docsCableUpstreamChannel</newvalue>
                </mapping>
                <mapping>
                    <value>206</value>
                    <newvalue>econet</newvalue>
                </mapping>
                <mapping>
                    <value>207</value>
                    <newvalue>pon155</newvalue>
                </mapping>
                <mapping>
                    <value>208</value>
                    <newvalue>pon622</newvalue>
                </mapping>
                <mapping>
                    <value>209</value>
                    <newvalue>bridge</newvalue>
                </mapping>
                <mapping>
                    <value>210</value>
                    <newvalue>linegroup</newvalue>
                </mapping>
                <mapping>
                    <value>211</value>
                    <newvalue>voiceEMFGD</newvalue>
                </mapping>
                <mapping>
                    <value>212</value>
                    <newvalue>voiceFGDEANA</newvalue>
                </mapping>
                <mapping>
                    <value>213</value>
                    <newvalue>voiceDID</newvalue>
                </mapping>
                <mapping>
                    <value>214</value>
                    <newvalue>mpegTransport</newvalue>
                </mapping>
                <mapping>
                    <value>215</value>
                    <newvalue>sixToFour</newvalue>
                </mapping>
                <mapping>
                    <value>216</value>
                    <newvalue>gtp</newvalue>
                </mapping>
                <mapping>
                    <value>217</value>
                    <newvalue>pdnEtherLoop1</newvalue>
                </mapping>
                <mapping>
                    <value>218</value>
                    <newvalue>pdnEtherLoop2</newvalue>
                </mapping>
                <mapping>
                    <value>219</value>
                    <newvalue>opticalChannelGroup</newvalue>
                </mapping>
                <mapping>
                    <value>220</value>
                    <newvalue>homepna</newvalue>
                </mapping>
                <mapping>
                    <value>221</value>
                    <newvalue>gfp</newvalue>
                </mapping>
                <mapping>
                    <value>222</value>
                    <newvalue>ciscoISLvlan</newvalue>
                </mapping>
                <mapping>
                    <value>223</value>
                    <newvalue>actelisMetaLOOP</newvalue>
                </mapping>
                <mapping>
                    <value>224</value>
                    <newvalue>fcipLink</newvalue>
                </mapping>
                <mapping>
                    <value>225</value>
                    <newvalue>rpr</newvalue>
                </mapping>
                <mapping>
                    <value>226</value>
                    <newvalue>qam</newvalue>
                </mapping>
                <mapping>
                    <value>227</value>
                    <newvalue>lmp</newvalue>
                </mapping>
                <mapping>
                    <value>228</value>
                    <newvalue>cblVectaStar</newvalue>
                </mapping>
                <mapping>
                    <value>229</value>
                    <newvalue>docsCableMCmtsDownstream</newvalue>
                </mapping>
                <mapping>
                    <value>230</value>
                    <newvalue>adsl2</newvalue>
                </mapping>
                <mapping>
                    <value>231</value>
                    <newvalue>macSecControlledIF</newvalue>
                </mapping>
                <mapping>
                    <value>232</value>
                    <newvalue>macSecUncontrolledIF</newvalue>
                </mapping>
                <mapping>
                    <value>233</value>
                    <newvalue>aviciOpticalEther</newvalue>
                </mapping>
                <mapping>
                    <value>234</value>
                    <newvalue>atmbond</newvalue>
                </mapping>
                <mapping>
                    <value>235</value>
                    <newvalue>voiceFGDOS</newvalue>
                </mapping>
                <mapping>
                    <value>236</value>
                    <newvalue>mocaVersion1</newvalue>
                </mapping>
                <mapping>
                    <value>237</value>
                    <newvalue>ieee80216WMAN</newvalue>
                </mapping>
                <mapping>
                    <value>238</value>
                    <newvalue>adsl2plus</newvalue>
                </mapping>
                <mapping>
                    <value>239</value>
                    <newvalue>dvbRcsMacLayer</newvalue>
                </mapping>
                <mapping>
                    <value>240</value>
                    <newvalue>dvbTdm</newvalue>
                </mapping>
                <mapping>
                    <value>241</value>
                    <newvalue>dvbRcsTdma</newvalue>
                </mapping>
                <mapping>
                    <value>242</value>
                    <newvalue>x86Laps</newvalue>
                </mapping>
                <mapping>
                    <value>243</value>
                    <newvalue>wwanPP</newvalue>
                </mapping>
                <mapping>
                    <value>244</value>
                    <newvalue>wwanPP2</newvalue>
                </mapping>
                <mapping>
                    <value>245</value>
                    <newvalue>voiceEBS</newvalue>
                </mapping>
                <mapping>
                    <value>246</value>
                    <newvalue>ifPwType</newvalue>
                </mapping>
                <mapping>
                    <value>247</value>
                    <newvalue>ilan</newvalue>
                </mapping>
                <mapping>
                    <value>248</value>
                    <newvalue>pip</newvalue>
                </mapping>
                <mapping>
                    <value>249</value>
                    <newvalue>aluELP</newvalue>
                </mapping>
                <mapping>
                    <value>250</value>
                    <newvalue>gpon</newvalue>
                </mapping>
                <mapping>
                    <value>251</value>
                    <newvalue>vdsl2</newvalue>
                </mapping>
                <mapping>
                    <value>252</value>
                    <newvalue>capwapDot11Profile</newvalue>
                </mapping>
                <mapping>
                    <value>253</value>
                    <newvalue>capwapDot11Bss</newvalue>
                </mapping>
                <mapping>
                    <value>254</value>
                    <newvalue>capwapWtpVirtualRadio</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>bits</newvalue>
                </mapping>
                <mapping>
                    <value>256</value>
                    <newvalue>docsCableUpstreamRfPort</newvalue>
                </mapping>
                <mapping>
                    <value>257</value>
                    <newvalue>cableDownstreamRfPort</newvalue>
                </mapping>
                <mapping>
                    <value>258</value>
                    <newvalue>vmwareVirtualNic</newvalue>
                </mapping>
                <mapping>
                    <value>259</value>
                    <newvalue>ieee802154</newvalue>
                </mapping>
                <mapping>
                    <value>260</value>
                    <newvalue>otnOdu</newvalue>
                </mapping>
                <mapping>
                    <value>261</value>
                    <newvalue>otnOtu</newvalue>
                </mapping>
                <mapping>
                    <value>262</value>
                    <newvalue>ifVfiType</newvalue>
                </mapping>
                <mapping>
                    <value>263</value>
                    <newvalue>g9981</newvalue>
                </mapping>
                <mapping>
                    <value>264</value>
                    <newvalue>g9982</newvalue>
                </mapping>
                <mapping>
                    <value>265</value>
                    <newvalue>g9983</newvalue>
                </mapping>
                <mapping>
                    <value>266</value>
                    <newvalue>aluEpon</newvalue>
                </mapping>
                <mapping>
                    <value>267</value>
                    <newvalue>aluEponOnu</newvalue>
                </mapping>
                <mapping>
                    <value>268</value>
                    <newvalue>aluEponPhysicalUni</newvalue>
                </mapping>
                <mapping>
                    <value>269</value>
                    <newvalue>aluEponLogicalLink</newvalue>
                </mapping>
                <mapping>
                    <value>270</value>
                    <newvalue>aluGponOnu</newvalue>
                </mapping>
                <mapping>
                    <value>271</value>
                    <newvalue>aluGponPhysicalUni</newvalue>
                </mapping>
                <mapping>
                    <value>272</value>
                    <newvalue>vmwareNicTeam</newvalue>
                </mapping>
                <mapping>
                    <value>277</value>
                    <newvalue>docsOfdmDownstream</newvalue>
                </mapping>
                <mapping>
                    <value>278</value>
                    <newvalue>docsOfdmaUpstream</newvalue>
                </mapping>
                <mapping>
                    <value>279</value>
                    <newvalue>gfast</newvalue>
                </mapping>
                <mapping>
                    <value>280</value>
                    <newvalue>sdci</newvalue>
                </mapping>
                <mapping>
                    <value>281</value>
                    <newvalue>xboxWireless</newvalue>
                </mapping>
                <mapping>
                    <value>282</value>
                    <newvalue>fastdsl</newvalue>
                </mapping>
                <mapping>
                    <value>283</value>
                    <newvalue>docsCableScte55d1FwdOob</newvalue>
                </mapping>
                <mapping>
                    <value>284</value>
                    <newvalue>docsCableScte55d1RetOob</newvalue>
                </mapping>
                <mapping>
                    <value>285</value>
                    <newvalue>docsCableScte55d2DsOob</newvalue>
                </mapping>
                <mapping>
                    <value>286</value>
                    <newvalue>docsCableScte55d2UsOob</newvalue>
                </mapping>
                <mapping>
                    <value>287</value>
                    <newvalue>docsCableNdf</newvalue>
                </mapping>
                <mapping>
                    <value>288</value>
                    <newvalue>docsCableNdr</newvalue>
                </mapping>
                <mapping>
                    <value>289</value>
                    <newvalue>ptm</newvalue>
                </mapping>
                <mapping>
                    <value>290</value>
                    <newvalue>ghn</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Linux::Interface protocol types</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>from KA9Q: NET/ROM pseudo</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Ethernet</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Experimental Ethernet</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>AX.25 Level 2</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>PROnet token ring</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Chaosnet</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>IEEE 802.2 Ethernet/TR/TB</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>ARCnet</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>APPLEtalk</newvalue>
                </mapping>
                <mapping>
                    <value>15</value>
                    <newvalue>Frame Relay DLCI</newvalue>
                </mapping>
                <mapping>
                    <value>19</value>
                    <newvalue>ATM</newvalue>
                </mapping>
                <mapping>
                    <value>23</value>
                    <newvalue>Metricom STRIP (new IANA id)</newvalue>
                </mapping>
                <mapping>
                    <value>24</value>
                    <newvalue>IEEE 1394 IPv4 - RFC 2734</newvalue>
                </mapping>
                <mapping>
                    <value>27</value>
                    <newvalue>EUI-64</newvalue>
                </mapping>
                <mapping>
                    <value>32</value>
                    <newvalue>InfiniBand</newvalue>
                </mapping>
                <mapping>
                    <value>256</value>
                    <newvalue>ARPHRD_SLIP</newvalue>
                </mapping>
                <mapping>
                    <value>257</value>
                    <newvalue>ARPHRD_CSLIP</newvalue>
                </mapping>
                <mapping>
                    <value>258</value>
                    <newvalue>ARPHRD_SLIP6</newvalue>
                </mapping>
                <mapping>
                    <value>259</value>
                    <newvalue>ARPHRD_CSLIP6</newvalue>
                </mapping>
                <mapping>
                    <value>260</value>
                    <newvalue>Notional KISS type</newvalue>
                </mapping>
                <mapping>
                    <value>264</value>
                    <newvalue>ARPHRD_ADAPT</newvalue>
                </mapping>
                <mapping>
                    <value>270</value>
                    <newvalue>ARPHRD_ROSE</newvalue>
                </mapping>
                <mapping>
                    <value>271</value>
                    <newvalue>CCITT X.25</newvalue>
                </mapping>
                <mapping>
                    <value>272</value>
                    <newvalue>Boards with X.25 in firmware</newvalue>
                </mapping>
                <mapping>
                    <value>280</value>
                    <newvalue>Controller Area Network</newvalue>
                </mapping>
                <mapping>
                    <value>512</value>
                    <newvalue>ARPHRD_PPP</newvalue>
                </mapping>
                <mapping>
                    <value>513</value>
                    <newvalue>Cisco HDLC</newvalue>
                </mapping>
                <mapping>
                    <value>516</value>
                    <newvalue>LAPB</newvalue>
                </mapping>
                <mapping>
                    <value>517</value>
                    <newvalue>Digital's DDCMP protocol</newvalue>
                </mapping>
                <mapping>
                    <value>518</value>
                    <newvalue>Raw HDLC</newvalue>
                </mapping>
                <mapping>
                    <value>519</value>
                    <newvalue>Raw IP</newvalue>
                </mapping>
                <mapping>
                    <value>768</value>
                    <newvalue>IPIP tunnel</newvalue>
                </mapping>
                <mapping>
                    <value>769</value>
                    <newvalue>IP6IP6 tunnel</newvalue>
                </mapping>
                <mapping>
                    <value>770</value>
                    <newvalue>Frame Relay Access Device</newvalue>
                </mapping>
                <mapping>
                    <value>771</value>
                    <newvalue>SKIP vif</newvalue>
                </mapping>
                <mapping>
                    <value>772</value>
                    <newvalue>Loopback device</newvalue>
                </mapping>
                <mapping>
                    <value>773</value>
                    <newvalue>Localtalk device</newvalue>
                </mapping>
                <mapping>
                    <value>774</value>
                    <newvalue>Fiber Distributed Data Interface</newvalue>
                </mapping>
                <mapping>
                    <value>775</value>
                    <newvalue>AP1000 BIF</newvalue>
                </mapping>
                <mapping>
                    <value>776</value>
                    <newvalue>sit0 device - IPv6-in-IPv4</newvalue>
                </mapping>
                <mapping>
                    <value>777</value>
                    <newvalue>IP over DDP tunneller</newvalue>
                </mapping>
                <mapping>
                    <value>778</value>
                    <newvalue>GRE over IP</newvalue>
                </mapping>
                <mapping>
                    <value>779</value>
                    <newvalue>PIMSM register interface</newvalue>
                </mapping>
                <mapping>
                    <value>780</value>
                    <newvalue>High Performance Parallel Interface</newvalue>
                </mapping>
                <mapping>
                    <value>781</value>
                    <newvalue>Nexus 64Mbps Ash</newvalue>
                </mapping>
                <mapping>
                    <value>782</value>
                    <newvalue>Acorn Econet</newvalue>
                </mapping>
                <mapping>
                    <value>783</value>
                    <newvalue>Linux-IrDA</newvalue>
                </mapping>
                <mapping>
                    <value>784</value>
                    <newvalue>Point to point fibrechannel</newvalue>
                </mapping>
                <mapping>
                    <value>785</value>
                    <newvalue>Fibrechannel arbitrated loop</newvalue>
                </mapping>
                <mapping>
                    <value>786</value>
                    <newvalue>Fibrechannel public loop</newvalue>
                </mapping>
                <mapping>
                    <value>787</value>
                    <newvalue>Fibrechannel fabric</newvalue>
                </mapping>
                <mapping>
                    <value>800</value>
                    <newvalue>Magic type ident for TR</newvalue>
                </mapping>
                <mapping>
                    <value>801</value>
                    <newvalue>IEEE 802.11</newvalue>
                </mapping>
                <mapping>
                    <value>802</value>
                    <newvalue>IEEE 802.11 + Prism2 header</newvalue>
                </mapping>
                <mapping>
                    <value>803</value>
                    <newvalue>IEEE 802.11 + radiotap header</newvalue>
                </mapping>
                <mapping>
                    <value>804</value>
                    <newvalue>ARPHRD_IEEE802154</newvalue>
                </mapping>
                <mapping>
                    <value>805</value>
                    <newvalue>IEEE 802.15.4 network monitor</newvalue>
                </mapping>
                <mapping>
                    <value>820</value>
                    <newvalue>PhoNet media type</newvalue>
                </mapping>
                <mapping>
                    <value>821</value>
                    <newvalue>PhoNet pipe header</newvalue>
                </mapping>
                <mapping>
                    <value>822</value>
                    <newvalue>CAIF media type</newvalue>
                </mapping>
                <mapping>
                    <value>823</value>
                    <newvalue>GRE over IPv6</newvalue>
                </mapping>
                <mapping>
                    <value>824</value>
                    <newvalue>Netlink header</newvalue>
                </mapping>
                <mapping>
                    <value>825</value>
                    <newvalue>IPv6 over LoWPAN</newvalue>
                </mapping>
                <mapping>
                    <value>826</value>
                    <newvalue>Vsock monitor header</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Network port admin status</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Enabled</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense CARP Status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Master</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Backup</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Inconsistent</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Problem</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense Gateway Status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Up</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Packet Loss</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>High Delay</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>High Packet Loss</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Forced Down</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Down</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec Enabled</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Yes</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>No</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec IKE Type</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Auto</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>IKE v1</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>IKE v2</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec Phase 1 Status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Established</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Connecting</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>Down on CARP Secondary</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec Phase 2 Protocol</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>ESP</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>AH</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec Protocol</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Dual Stack (IPv4 &amp; IPv6)</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>IPv4</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>IPv6</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense IPsec Tunnel Mode</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Main</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Aggressive</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense OpenVPN Interface Status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>None</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Reconnecting</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Waiting</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Up/Listening</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>pfSense OpenVPN Mode</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Peer to Peer (SSL/TLS)</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>P2P Shared Key</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Remote Access (SSL/TLS)</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Remote Access (User Auth)</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Remote Access 8SSL/TLS + User Auth)</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SNMP interface status (ifAdminStatus)</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>testing</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SNMP interface status (ifOperStatus)</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>testing</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>dormant</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>notPresent</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>lowerLayerDown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Type network interface</name>
            <mappings>
                <mapping>
                    <value>6</value>
                    <newvalue>Ethernet</newvalue>
                </mapping>
                <mapping>
                    <value>23</value>
                    <newvalue>PPP</newvalue>
                </mapping>
                <mapping>
                    <value>135</value>
                    <newvalue>L2vlan</newvalue>
                </mapping>
                <mapping>
                    <value>136</value>
                    <newvalue>L3ipvlan</newvalue>
                </mapping>
                <mapping>
                    <value>137</value>
                    <newvalue>L3ipxvlan</newvalue>
                </mapping>
                <mapping>
                    <value>209</value>
                    <newvalue>Bridge</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Windows service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Running</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Paused</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Pause pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Continue pending</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Stop pending</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Stopped</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>No such service</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>zabbix.host.available</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>not available</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>available</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Zabbix agent ping status</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
